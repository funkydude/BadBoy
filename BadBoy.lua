
-- GLOBALS: BADBOY_BLACKLIST, BADBOY_OPTIONS, BadBoyLog, ChatFrame1, GetTime, print, CalendarGetDate
-- GLOBALS: GameTooltip, C_Timer, IsEncounterInProgress, GameTooltip_Hide
local _, S = ...
S.gnt(274,"175,173,191,181,186,187,122,118,184,177,179,181,192,122,118,191,173,178,177,122,118,175,173,191,181,186,187^170,195,192,167,174,191,169,174,173,184,173,186,175,177,188,173,197,188,173,184,174,197,179,187,184,176^170,195,192,167,174,191,192,169,185,197,195,187,195,179,187,184,176,122,118,175,191,179,187,191,183,181,186^170,192,190,173,176,181,186,179,195,187,195,179,187,184,176,178,187,190,187,139,191,139,190,191,179,187,184,176^170,195,192,167,174,191,169,179,173,185,177,192,181,185,177^170,195,192,167,191,192,169,195,187,195,173,175,175,187,193,186,192^170,174,193,197,181,186,179,175,191,179,187,183,186,181,167,178,194,169,177^170,195,192,167,174,191,169,113,176,119,176,173,197,122,118,179,173,185,177,175,173,190,176^195,192,167,174,191,169,122,118,190,193,186,177,191,175,173,188,177,185,187,186,177,197,122,118,113,176,119,183^192,190,173,176,181,186,179,185,197,195,187,190,184,176,187,178,195,173,190,175,190,173,178,192,179,187,184,176,178,187,190,122,118,190,193,186,177,191,175,173,188,177,179,187,184,176^175,173,191,181,186,187,122,118,113,176,119,196,126,122,118,113,176,119,196,127^170,195,192,167,191,174,192,169,195,187,195,179,187,184,176,178,187,190,175,191,179,187,191,183,181,186^190,187,193,184,177,192,192,177,122,118,190,187,184,184,122,118,126,196,122,118,127,196^170,195,192,191,113,176,119,183,178,187,190,113,176,119,177,193^170,195,192,167,191,192,169,173,175,175,187,193,186,192,195,181,192,180^170,179,187,192,173,186,197,190,191,124,139,127,123,190,191,124,139,131,179,187,184,176,184,173,197,181,186,179,173,190,187,193,186,176,122,118,179,187,187,176,187,178,178,177,190^170,195,192,191,113,176,119,176,173,197,191,139,179,173,185,177,175,173,190,176^195,192,167,174,191,169,190,193,186,177,191,175,173,188,177,179,187,184,176^170,195,192,167,174,191,169,190,191,173,175,175,187,193,186,192^195,192,167,174,191,169,195,187,195,179,187,184,176,122,118,190,191,179,187,184,176^174,193,197,181,186,179,139,190,193,186,177,191,175,173,188,177,167,173,179,169^184,193,175,183,122,118,190,187,184,184,122,118,176,187,193,174,184,177,122,118,179,187,184,176^190,187,184,184,122,118,179,173,185,177,122,118,179,187,184,176,122,118,195,181,186,122,118,184,187,195,177,190^190,193,186,177,191,175,173,188,177,179,187,184,176,178,187,190,195,187,195,179,187,184,176^175,173,191,181,186,187,122,118,113,176,119,122,118,176,187,193,174,184,177,122,118,113,176,119,122,118,192,190,181,188,188,139,184,177^170,195,192,167,174,191,192,169,175,191,179,187,175,180,177,173,188^170,195,192,167,174,191,169,173,139,186,139,173,195,177,191,187,185,177,190,191,173,175,175,187,193,186,192^170,174,193,197,181,186,179,175,180,177,173,188,175,191,179,187,191,183,181,186^170,195,192,167,174,191,169,179,173,185,177,175,187,176,177^170,195,192,167,174,191,192,169,179,187,184,176,178,187,190,175,191,179,187^170,195,192,167,174,191,192,169,175,191,179,187,181,192,177,185^170,179,187,192,191,187,185,177,190,191,124,131,123,139,190,139,191,139,127,139,179,187,184,176,184,173,197,181,186,179,173,190,187,193,186,176,122,118,185,177^170,195,192,192,195,187,195,179,187,184,176,178,187,190,187,191,190,191^170,195,192,167,174,191,192,169,175,191,179,187,173,175,175^170,195,192,174,179,187,184,176,122,118,185,187,193,186,192^195,173,186,192,192,187,174,193,197,167,123,168,169,191,177,184,184,175,191,179,187,181,192,177,185^195,192,167,174,191,169,190,193,186,177,191,175,173,188,177,173,175,175,187,193,186,192^170,191,177,184,184,181,186,179,175,191,179,187,181,192,177,185^170,195,192,192,195,187,195,179,178,187,190,187,191,190,191,179^170,195,192,174,187,191,190,191,179,188^170,195,192,167,174,191,192,169,175,191,179,187,175,176,183,177,177,139,197^170,195,192,167,174,191,169,179,173,185,177,175,173,190,176^170,195,192,167,174,191,192,169,173,186,197,175,191,179,187,191,183,181,186^170,195,192,167,174,191,192,169,175,191,179,187,175,173,191,177^170,195,192,167,174,191,192,169,175,191,179,187,183,186,181,167,178,194,169,177^170,195,192,174,179,187,184,176,122,118,179,173,185,177,192,181,185,177^175,173,191,181,186,187,122,118,190,187,184,184,122,118,176,187,193,174,184,177^190,187,184,184,122,118,113,176,119,122,118,190,187,184,184,122,118,113,176,119,122,118,174,177,192^170,195,192,174,113,176,119,185,124,131,179,188^170,195,192,167,174,191,169,188,190,177,188,173,181,176,175,173,190,176^170,195,192,167,174,191,192,169,175,191,191,183,181,186,191^170,195,192,191,113,176,119,176,173,197,191,139,179,173,185,177,192,181,185,177^175,173,191,181,186,187,122,118,174,177,192,122,118,113,176,119^170,174,193,197,181,186,179,187,191,190,191,179,187,184,176,195,181,192,180,195,187,195,179,187,184,176^170,174,193,197,181,186,179,190,191,127,191,192,193,178,178^195,192,167,174,191,192,169,190,191,127,139,179,187,184,176,122,118,195,187,195,179,187,184,176^170,195,192,167,174,191,192,169,175,180,177,173,188,175,191,179,187,191,183,181,186^175,173,191,181,186,187,122,118,195,180,181,191,188,177,190,122,118,181,186,178,187^190,187,184,184,179,173,185,174,184,177,122,118,113,176,119,122,118,184,187,191,177,113,176,119,122,118,195,181,186,122,118,113,176,119^176,167,187,193,169,167,193,174,169,174,184,177,122,118,113,176,119,122,118,192,190,181,188,188,139,184,177^170,195,192,167,174,191,169,188,190,177,188,173,181,176,179,173,185,177,175,173,190,176^174,177,192,122,118,190,187,184,184,122,118,196,126,122,118,196,127,122,118,185,181,186,122,118,185,173,196^170,195,192,167,174,191,192,169,184,177,179,181,187,186,175,139,176,139,183,177,197^179,187,184,176,122,118,192,190,181,188,188,139,184,177,122,118,175,173,191,181,186,187^170,195,192,167,174,191,192,169,175,191,179,187,191,192,177,173,185,179,181,178,192^170,174,193,197,181,186,179,175,191,179,187,183,177,197^175,191,179,187,191,183,181,186,191,122,118,179,187,184,176,122,118,191,180,187,188,122,118,185,187,193,186,192,191^170,174,193,197,181,186,179,175,191,113,122,139,179,167,124,187,169,191,183,181,186^175,173,191,181,186,187,122,118,176,181,175,177,122,118,113,176,119,122,118,192,190,181,188,184,177^170,195,192,167,174,191,192,169,183,177,197,191,181,186,175,191,179,187^170,195,192,167,174,191,169,113,176,119,185,187,186,192,180,122,118,179,173,185,177,192,181,185,177^170,195,192,192,195,187,195,179,178,187,190,190,191,124,131,179^170,195,192,174,190,191,179,188,112^170,195,192,167,174,191,169,167,127,130,169,124,176,173,197,191,139,188,190,177,188,173,181,176,179,173,185,177,192,181,185,177^170,195,192,191,175,180,177,173,188,179,187,184,176^170,191,177,184,184,181,186,179,175,191,179,187,175,173,191,177^195,173,186,192,192,187,191,177,184,184,167,123,168,169,174,193,197,175,191,179,187,181,192,177,185^195,187,195,179,187,184,176,178,187,190,175,191,179,187,183,177,197^170,191,177,184,184,181,186,179,191,187,185,177,175,191,179,187,175,173,191,177^175,173,191,181,186,187,122,118,123,195,122,118,113,176,119,122,118,190,187,184,184^170,192,190,173,176,181,186,179,175,191,179,187,122,118,179,187,184,176^179,173,185,174,184,177,122,118,190,187,184,184,122,118,196,126,122,118,190,187,184,184,122,118,196,129^195,192,167,174,191,169,190,193,186,177,191,175,173,188,177,188,193,190,177^175,173,191,181,186,187,122,118,190,187,184,184,122,118,113,176,119,122,118,190,187,184,184,122,118,113,176,119^170,195,192,167,174,191,192,169,191,187,185,177,175,191,179,187,191,183,181,186^195,192,191,195,187,195,173,175,175,187,193,186,192,122,118,177,188,181,175^184,193,175,183,122,118,190,187,184,184,122,118,113,176,119,183,122,118,185,181,186,193,192,177,191,122,118,188,191,192^170,191,177,184,184,181,186,179,179,187,184,176,191,139,178,187,190,175,191,179,187^170,195,192,167,174,191,169,179,187,191,183,181,186,191^177,196,175,180,173,186,179,181,186,179,190,191,179,187,184,176^170,179,187,192,173,186,197,190,193,186,177,191,175,173,188,177,179,187,184,176,123,195,185,177^170,195,192,167,174,191,192,169,190,191,124,131,179,187,184,176^170,195,192,167,174,191,192,169,175,191,113,122,139,179,187,191,183,181,186^176,187,193,174,184,177,122,118,192,190,181,188,188,139,184,177,122,118,175,173,191,181,186,187^113,176,119,122,118,176,167,187,193,169,167,193,174,169,174,184,177,122,118,113,176,119,122,118,192,190,181,188^195,192,167,174,191,169,195,187,195,179,187,184,176,122,118,190,191,175,187,181,186,192,139,191^170,195,192,167,174,191,192,169,185,197,179,187,184,176,178,187,190,175,191,179,187,191,183,181,186^170,191,177,184,184,181,186,179,175,191,179,187,191,183,181,186^176,181,175,177,122,118,196,126,122,118,196,127,122,118,174,177,192,191^170,195,192,167,174,191,192,169,175,191,179,187,175,173,185,187^190,187,184,184,122,118,195,181,186,122,118,176,187,193,174,184,177,122,118,185,181,186,122,118,185,173,196^170,195,192,191,175,180,177,173,188,173,186,176,178,173,191,192,179,187,184,176^170,195,192,192,195,187,195,179,187,184,176,178,187,190,187,184,176,191,175,180,187,187,184,190,191,179,187,184,176^170,195,192,167,174,191,192,169,175,191,179,187,183,177,197^170,195,192,167,174,191,169,113,176,119,190,191,173,175,175,187,193,186,192^179,187,184,176,178,187,190,190,193,186,177,191,175,173,188,177,179,187,184,176","306,217,210,306,232,239,123,119,130,127,132,128,128,133,134,128,129^305,268,238,185,188,195,178,175,174,175,198,127,128,129^305,261,264,309,209,222,306,234,221,310,247,222,123,119,306,218,206,306,254,207,305,266,219,305,268,234,123,119,127,126,125,125,189,195,189,308,250,214,308,263,244^177,182,192,176,188,191,177,194,189,128,134,125,128^186,198,193,181,182,176,180,194,182,185,177,182,192,192,178,185,182,182,187,180,123,119,191,194,187,192,174,187,177,186,198,193,181,182,176,177,194,187,180,178,188,187,184,178,198,192,123,119,174,181,178,174,177,188,179,193,181,178,176,194,191,195,178,193,188,177,174,198,123,119,187,188,191,178,190,194,182,191,178,186,178,187,193,192^190,132,127,129,127,127,128,129,129,133^191,188,285,264,285,257,174,168,114,123,121,170,189,286,209,123,119,195,182,192,174^195,182,192,182,193,123,119,196,188,196,175,188,189,114,123,176,188,186^305,261,247,305,263,263,306,224,206,307,261,240,306,250,221,123,119,189,191,188,179,188,194,187,177,192,178,174^196,193,192,123,119,191,194,187,192,123,119,174,191,193,182,179,174,176,193,189,188,196,178,191,123,119,185,178,195,178,185,182,187,180,123,119,186,188,191,178,123,119,182,187,179,188^285,260,188,285,264,188,193,188,123,119,186,186,188,174,181,168,114,123,121,170,191,194^190,130,129,134,134,131,130,133,128,133^190,190,123,119,129,131,134,133,131,130,129,133,130^190,190,123,119,126,130,126,128,134,129,126,133,126,129^306,267,251,305,268,238,180,181,178,192,193,185,194,188,175,188^196,193,192,175,174,193,193,185,178,188,179,177,174,199,174,191,174,185,188,191,123,119,177,182,179,179,178,191,178,187,193,193,182,186,182,187,180,123,119,180,178,193,198,188,194,191,129,114,177,114,177,182,185,195,185,180,178,174,191,182,187,179,174,192,193,193,182,186,178^285,268,189,188,285,257,174,285,257,285,261,186,191,189,188,285,254,285,266,285,261,286,211,198,123,119,285,268,188,285,257,174,189,188,184,123,119,285,255,285,268,186^307,233,249,307,233,218,123,119,306,220,255,309,252,228,126,126,125,123,119,309,212,247,306,260,254,305,261,215,306,220,260,124,307,228,237,307,215,265,310,212,222,124,305,261,218,306,265,263,306,213,259,307,259,213,309,257,262,307,234,242,308,231,209,307,233,216,306,220,216,186,186,186,186^196,193,192,186,178,176,181,174,180,188,181,194,185,186,184,127,123,119,306,234,221,310,247,222,305,262,234,305,262,234,123,119,310,212,222,308,239,244,306,218,206,305,261,212,305,261,208,306,218,206,123,119,126,114,177,125,123,119,126,127,125,123,119,128,114,177,125^171,306,267,251,308,249,222,121,310,207,251,305,264,259,181,308,219,216,306,263,244,126,306,214,218,126,181,126,126,307,226,240,180,310,205,236,307,234,242,186,186,307,234,242,113^192,178,185,185,182,187,180,123,119,193,182,186,178,191,123,119,192,178,185,179,189,185,174,198,123,119,179,174,192,193,123,119,193,188,189,180,178,174,191,123,119,182,187,179,188^186,198,193,181,182,176,123,119,184,178,198,123,119,194,189,180,191,174,177,178,123,119,186,174,192,193,178,191,123,119,174,176,181,182,178,195,123,119,192,184,182,187,123,119,196,178,178,184,185,198^175,188,188,192,193,182,187,180,168,114,123,121,170,189,191,188,123,119,185,188,188,193^190,190,123,119,128,126,134,129,130,127,126,133,129,133^190,190,123,119,128,130,133,127,127,125,125,131,131^175,178,192,193,178,187,123,119,192,184,198,189,178,123,119,192,174,191,186,174,178,185,123,119,176,188,174,176,181,182,187,180^192,184,198,189,178,123,119,186,174,199,178,196,188,196^193,182,193,174,187,182,194,186,175,174,198,123,119,188,175,193,178,187,178,199^306,267,251,305,268,238,123,119,126,133,131,134,127,127,125,133,132,129,130^182,187,179,188,123,119,178,189,182,176,176,174,191,191,198,168,114,123,121,170,176,188,186^189,178,196,189,178,196,192,181,188,189,114,123,189,191,188,123,119,186,198,193,181,182,176^192,178,185,185,182,187,180,123,119,175,188,188,192,193,123,119,180,194,174,140,191,174,187,193,178,178,123,119,180,182,195,178,174,196,174,198,123,119,182,187,179,178,191,187,174,185,123,119,192,189,188,193^192,181,182,187,178,175,188,188,192,193,133,128,128,125^196,178,175,189,174,180,178,123,119,178,189,182,176,176,174,191,191,198^192,184,198,189,178,123,119,176,181,182,178,179,175,188,188,192,193^308,212,208,308,208,244,308,219,216,306,263,244,123,119,306,210,245,310,205,231,305,264,260,307,237,265,305,266,219,306,264,214,123,119,307,249,239,309,268,219,307,227,253,308,219,246,306,251,259,306,232,235,306,266,223,123,119,175,188,192,192^176,188,187,193,174,176,193,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,188,125,170,186^306,232,239,123,119,126,127,134,127,132,125,131,126,128,129^305,268,238,175,174,175,178,198,126,126,127,128^177,182,192,176,188,191,177,184,188,184,188,199,188,191,183,184,178,132,130,125,132^195,182,192,182,193,179,174,192,193,191,194,187,168,114,123,121,170,182,187,179,188^305,268,238,123,119,126,132,132,133,133,134,130,130,128,129,126^195,197,183,182,187,180,197,194,174,187,128,128,129,129,130,127,126^192,184,198,189,178,123,119,189,195,178,192,181,188,189^306,267,251,305,268,238,123,119,180,188,185,177,179,188,191,192^195,182,192,182,193,123,119,178,189,114,123,140,182,176,176,174,191,191,198,114,123,176,188,186^190,190,123,119,133,129,132,129,131,130,127,133,131^179,194,185,185,176,185,178,174,191,123,119,175,168,188,125,170,168,188,125,170,192,193,123,119,180,178,193,175,182,192,180,178,174,191,123,119,181,178,185,185,179,182,191,178,182,187,179,178,191,187,174,185,123,119,186,188,191,178,182,187,179,188^196,193,192,195,182,176,182,188,194,192,123,119,188,193,181,178,191,189,195,189,186,188,194,187,193,192,123,119,176,188,186,189,185,178,193,182,188,187,123,119,181,194,187,177,191,178,177,123,119,179,182,192,181,198^195,182,192,182,193,123,119,174,187,193,174,191,178,192,175,188,188,192,193,114,123,176,188,186^171,186,174,191,182,187,174,305,261,224,305,261,231,308,231,209,307,215,241,308,221,211,305,261,224,306,251,259^177,182,192,176,188,191,177,123,119,192,194,187,187,198,129,126,130,126^171,196,193,192,189,188,196,178,191,185,178,140,195,178,140,185,182,187,180,123,119,174,191,193,182,179,174,176,193^285,266,285,261,285,260,184,285,261,178,286,211,178,285,266,286,216,123,119,180,178,193,185,188,188,193,168,114,123,121,170,191,194^196,193,192,123,119,196,182,193,181,186,185,123,119,181,182,180,181,190,194,174,185,182,193,198,123,119,175,182,180,177,182,192,176,188,194,187,193^305,268,238,186,182,174,126,126,126,127,130^177,182,192,176,188,191,177,193,175,126,168,126,125,170,125,125^305,268,238,188,184,129,180,188,185,177^171,186,174,191,182,187,174,310,229,268,307,232,265,309,216,220,308,231,209,310,239,209,309,244,206^174,191,193,182,179,174,176,193,189,188,196,178,191,123,119,178,199,129,198,188,194,114,123,178,194^195,182,192,182,193,123,119,176,174,191,191,198,175,188,188,186,168,114,123,121,170,176,188,186^305,268,238,180,188,185,177,196,188,196^196,193,192,186,177,194,187,180,178,188,187,176,181,178,192,193,191,194,187,192,123,119,181,178,185,189,198,188,194,193,188,179,174,191,186,174,187,198,174,186,188,194,187,193,188,179,186,198,193,181,182,176,123,119,177,191,188,189,174,180,178,174,191,189,182,178,176,178,123,119,192,178,193,174,187,177,191,178,174,177,198,193,188,180,188^177,178,174,185,192,123,119,178,189,182,176,176,174,191,191,198,114,123,187,178,193^179,194,185,185,191,194,187,123,119,180,194,174,191,174,187,193,178,178,183,194,192,193,179,188,191,114,177,114,177,120,178,194,191,123,119,193,188,187,182,180,181,193^195,182,192,182,193,180,189,185,174,198,114,123,189,191,188^195,197,177,174,182,196,188,196,133,133,133^306,267,251,305,268,238,123,119,127,133,129,130,134,131,128,125,128^190,121,140,190,126,125,128,133,130,134^171,178,174,192,198,174,187,177,192,186,188,188,193,181,181,178,191,188,182,176,175,174,193,193,185,178,188,179,177,174,199,174,191,174,185,188,191,191,194,187,192,178,195,178,191,198,177,174,198,113^184,185,199,123,119,307,214,240,126,129,133,129,129,132,126,127,127,129^171,176,188,180,306,210,249,305,265,231,309,221,245,306,239,224^192,181,174,177,188,196,175,188,188,192,193,114,123,176,188,186,123,119,180,194,182,185,177^196,193,192,186,198,193,181,182,176,126,114,177,192,193,174,191,193,182,187,180,187,188,196,123,119,192,186,188,188,193,181,191,194,187,192,123,119,178,197,189,178,191,182,178,187,176,178,123,119,178,185,182,193,178,189,185,174,198,178,191,192,123,119,175,178,192,193,189,191,182,176,178,192,123,119,174,185,192,188,192,178,185,185,182,187,180,123,119,180,188,185,177,188,187,185,198^196,193,192,186,198,193,181,182,176,176,181,178,192,193,179,174,191,186,123,119,188,194,191,174,192,192,182,192,193,174,187,176,178,123,119,174,187,198,174,186,188,194,187,193,123,119,191,178,174,177,198,193,188,180,188^189,188,196,178,191,185,178,140,195,178,140,185,182,187,180,123,119,191,174,191,178,186,188,194,187,193,192,123,119,176,174,191,191,198^196,193,192,123,119,189,182,176,184,123,119,196,178,178,184,185,198,176,181,178,192,193,192,179,188,191,176,181,178,174,189,189,191,182,176,178,123,119,192,193,174,176,184,174,191,186,188,191,123,119,176,181,178,174,189,178,191,189,191,182,176,178^175,194,198,192,174,179,178,194,185,177,182,191,123,119,174,187,198,176,181,174,191,174,176,193,178,191,182,192,196,178,185,176,188,186,178,123,119,180,178,193,176,181,178,174,189,123,119,176,194,191,195,178^195,305,268,238,123,119,126,130,125,130,128,133,126,134,125,132^177,182,192,176,188,191,177,177,188,191,193,196,182,197,127,127,130,129^308,219,253,306,233,245,307,233,214,306,232,239,310,238,259,308,263,244,306,214,252,307,233,249,309,216,254,310,232,209,123,119,306,210,245,310,205,231,307,226,240,306,218,227,307,264,238,308,263,244,306,218,256,306,220,252,306,220,252,309,263,263,306,253,261,123,119,306,220,243,307,233,214,306,220,255,309,252,228,126,126,125,307,249,239,309,268,219,306,223,245,309,252,239^310,212,222,123,119,126,130,133,125,127,130,130,132,126,127,131^306,227,215,126,306,220,260,310,234,239,306,214,218,181,308,219,216,306,263,244,126,126,126,306,210,245,310,205,231,307,264,238,185,185,188,306,218,256,306,220,252,306,242,228,309,240,210,124,310,242,253,306,224,206,124,306,233,240,308,214,246,307,217,222,307,207,245,306,227,233,307,249,239,308,231,209,307,216,268,306,212,263,305,261,205,305,264,259,305,264,229,305,261,205,305,264,259^182,187,179,188,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,140,176,168,125,188,170,186^192,178,178,186,188,191,178,123,119,196,188,196,181,194,187,193,114,123,140,176,188,186^196,193,192,187,188,191,186,174,185,174,187,177,181,178,191,188,182,176,175,174,193,193,185,178,188,179,177,174,199,174,191,174,185,188,191,186,198,193,181,182,176,191,194,187,192,124,196,179,188,191,182,187,179,188^175,174,193,193,185,178,193,174,180,123,119,180,181,188,192,193,177,188,180,127,126,128,129,129,125^192,184,198,189,178,123,119,181,178,185,186,182,191,132,130,132,133^285,260,188,285,264,188,193,188,123,119,179,194,187,186,186,188,114,123,191,194^306,267,251,305,268,238,123,119,126,130,133,130,132,131,127,130,125,125,131^192,182,193,178,123,119,186,186,168,188,125,170,185,195,185,114,123,176,168,188,125,170,186^171,186,174,191,182,187,174,306,221,209,308,244,218,308,231,251,309,207,241^192,184,198,189,178,123,119,174,189,189,188,185,174,197,128,125,133,130^190,308,267,241,123,119,126,127,127,133,132,126,131,132,126^189,195,189,123,119,182,188,196,123,119,188,184,129,180,188,185,177^196,193,192,123,119,186,198,193,181,182,176,184,178,198,123,119,176,174,191,191,198,191,194,187,123,119,176,188,186,178,180,178,193,198,188,194,191,174,185,185,123,119,176,181,178,174,189,189,191,182,176,178^171,309,205,206,308,214,217,308,267,219,307,233,218,176,188,180^186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,188,125,170,186,123,119,176,188,187,193,174,176,193^195,182,192,182,193,123,119,196,188,196,181,194,187,193,114,123,176,188,186^192,178,191,195,182,176,178,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,188,125,170,186^190,190,123,119,127,133,130,126,132,128,126,133,133,132^176,181,178,176,184,123,119,196,188,196,181,194,187,193,114,123,187,178,193^175,188,188,192,193,123,119,178,197,193,191,178,186,178,185,198,123,119,179,174,192,193,123,119,126,125,125,126,126,125^306,220,260,310,234,239,306,214,218,309,216,254,310,232,209,308,212,208,306,263,244,168,185,126,170,168,185,126,170,168,185,126,170,123,119,307,264,238,168,185,126,170,168,185,126,170,168,188,125,170,308,263,244,306,218,256,306,220,252,123,119,186,168,185,126,170,168,185,126,170,168,185,126,170^176,188,187,193,174,176,193,123,119,178,189,182,176,176,174,191,191,198,168,114,123,121,170,176,188,186^306,267,251,305,268,238,123,119,126,133,125,130,134,128,134,132,130,131,125^196,193,192,186,177,194,187,180,178,188,187,192,127,126,130,123,119,180,194,174,191,174,187,193,178,178,177,185,188,188,193,123,119,182,192,185,174,187,177,178,197,189,178,177,182,193,182,188,187,192^193,178,185,178,180,191,174,186,123,119,174,186,182,191,174,187,180,174,186,182,187,180^305,268,238,128,134,134,126,127,133,130,129,133^196,191,182,193,178,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,188,125,170,186^180,188,185,177,129,188,184,168,114,123,121,170,176,188,186,123,119,192,188,193,176,184^179,174,176,178,175,188,188,184,114,123,176,188,186,124,192,189,191,199,178,177,174,183,184,188,187,193,188,189,185^175,188,188,192,193,193,188,177,174,198,123,119,192,181,174,177,188,196,175,188,188,192,193,114,123,176,188,186^306,267,251,305,268,238,123,119,128,130,130,128,128,133,134,132,126^171,176,188,180,308,267,219,307,233,218,306,260,242,305,266,233,306,251,241^171,306,210,245,307,227,253,309,268,232,306,263,243,124,309,216,254,310,232,209,308,219,216,306,263,244,306,210,245,310,205,231,309,268,232,308,264,209,306,253,254,306,265,205,307,214,224,307,234,242,306,221,209,308,244,218,309,205,206,307,234,268,307,233,249,307,233,218,306,220,255,309,252,228,126,126,125,308,219,253,306,233,245,306,265,205,307,214,224,121,306,210,245,308,256,264,307,228,237,308,248,235,305,263,214,307,249,239,309,268,219,306,221,209,305,266,218,309,205,206,307,234,268,307,227,253,306,262,257,306,268,248,305,262,221,113^195,182,192,182,193,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,125,188,170,186^193,182,193,174,187,182,194,186,175,174,198,123,119,185,182,195,191,174,182,192,188,187^175,178,192,194,176,181,178,187,123,119,196,188,196,195,178,187,177,188,191,114,123,176,188,186^182,180,179,174,187,192,123,119,192,193,188,176,184,123,119,177,178,185,182,195,178,191^192,178,185,185,182,187,180,123,119,196,174,191,176,191,174,179,193,123,119,179,194,185,185,180,178,174,191,175,188,188,192,193,123,119,198,188,194,196,182,185,185,180,178,193,123,119,191,178,185,182,176,192,123,119,192,189,188,193,192^192,178,185,185,182,187,180,123,119,176,185,178,174,191,123,119,177,182,192,176,188,194,187,193,123,119,182,187,179,178,191,187,174,185,123,119,180,194,174,140,191,174,187,193,178,178^184,188,175,188,185,177,123,119,192,189,191,199,178,177,174,183,184,188,187,193,188,168,114,123,121,170,189,185^306,241,244,308,254,256,127,126,125,307,228,237,310,230,221,306,213,260,123,119,128,132,130,129,125,125,307,250,243,306,230,245,310,242,253,306,224,206,307,213,223,307,217,212^195,182,192,182,193,183,175,192,193,114,123,189,191,188^114,177,114,177,114,177,184,180,188,185,177,123,119,192,193,174,191,193,187,188,196,123,119,176,194,191,195,178,123,119,185,188,188,193,174,191,178,192,181,174,191,178,177,123,119,179,194,185,185,180,194,182,185,177,123,119,177,182,192,176,188,191,177^176,185,174,192,192,123,119,179,175,186,193,178,174,186,114,123,176,188,186^180,194,182,185,177,123,119,192,181,174,177,188,196,175,188,188,192,193,114,123,176,188,186^195,182,192,182,193,189,178,196,189,178,196,192,181,188,189^196,193,192,186,198,193,181,182,176,191,194,187,192,126,125,126,130,123,119,198,188,194,196,182,185,185,180,178,193,182,185,195,185,123,119,180,178,174,191,193,182,193,174,187,191,178,192,182,123,119,193,188,187,192,188,179,174,199,178,191,182,193,178,192,193,174,191,193,187,188,196^196,193,192,186,198,193,181,182,176,175,174,193,193,185,178,179,188,191,177,174,199,174,191,174,185,188,191,133,124,134,174,185,185,185,188,188,193,193,188,187,182,180,181,193,123,119,192,189,188,193,192,179,188,191,187,188,196,123,119,196,179,188,191,182,187,179,188^177,195,182,187,180,168,114,123,121,170,191,194,123,119,198,176,285,264,198,191,285,261^186,174,180,178,193,188,196,178,191,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,188,125,170,186^196,193,192,195,182,176,182,188,194,192,123,119,188,193,181,178,191,189,195,189,186,188,194,187,193,192,123,119,176,174,191,191,182,178,177,123,119,192,184,182,185,185,123,119,192,178,185,179,189,185,174,198^306,220,255,309,252,228,186,309,267,267,309,221,245,308,266,228,123,119,126,126,125,126,127,125,308,263,244,123,119,129,125,125,309,240,210,308,250,214,123,119,189,195,189,127,129,125,125^306,267,251,305,268,238,178,198,178,192,185,188,193^192,184,198,189,178,123,119,175,178,185,184,188,191,184,141,180,186,174,182,185,114,123,176,188,186^171,189,180,189,306,260,242,305,266,233,306,251,241,305,266,219,305,268,234^128,129,188,128,130,188,128,131,188,128,132,188,309,240,210,308,250,214,307,220,221,306,218,212,123,119,307,261,210,305,261,227,308,226,217,305,264,264,306,215,238,306,217,210,306,222,245,306,217,210,307,233,213,123,119,127,126,125,125,189,195,189,308,244,252,306,213,211^305,268,238,133,134,129,130,133,125,127,128,126^306,267,251,305,268,238,123,119,192,178,192,178,180,188,185,177^285,268,189,188,285,257,174,285,259,174,123,119,176,188,182,187,192,192,193,188,191,178,168,114,123,121,170,191,194^171,196,193,192,186,198,193,181,182,176,123,119,196,178,178,184,185,198,185,188,188,193,123,119,181,178,185,189,198,188,194,193,188,176,185,178,174,191,123,119,185,178,193,194,192,181,174,187,177,185,178,193,181,178,175,188,191,182,187,180,189,174,191,193,192^306,225,251,306,267,251,123,119,133,134,129,130,133,125,127,128,126^305,268,238,123,119,132,132,133,130,133,132,128,126,131^182,187,179,188,123,119,175,168,188,125,170,168,188,125,170,186,175,168,188,125,170,168,188,125,170,192,193,121,176,168,188,125,170,186^196,188,196,186,174,191,193,168,114,123,121,170,191,194,123,119,285,260,188,285,264,188,193,188^196,193,192,195,182,176,182,188,194,192,123,119,176,174,191,191,198,198,188,194,191,178,180,174,191,177,123,119,192,178,185,179,189,185,174,198,123,119,191,178,185,174,193,178,177,192,193,194,179,179^305,261,247,305,263,263,307,216,267,306,220,227,182,182,188,182,127,188,306,218,212,308,263,244,128,133,188,128,134,188,129,188,188,309,240,210,308,250,214,307,220,221,306,218,212,307,261,210,305,261,227,308,226,217,305,264,264,306,215,238,306,217,210,306,222,245,306,217,210,307,233,213,180,126,127,125,125,305,261,212,308,219,253,309,257,244^305,261,264,309,209,222,306,234,221,310,247,222,123,119,310,208,266,305,268,234,306,263,226,123,119,308,250,214,308,263,244,123,119,309,240,210,308,250,214,123,119,305,261,227,305,264,264,123,119,189,195,189^196,193,192,123,119,192,184,198,189,178,123,119,175,188,188,192,193,182,187,180,181,178,185,189^188,179,179,178,191,192,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,188,125,170,186^306,220,260,310,234,239,306,214,218,304,205,206,309,216,254,310,232,209,306,210,245,310,205,231,306,251,214,307,214,229,310,255,206,307,227,252,121,308,212,208,308,208,244,308,219,216,306,263,244,180,306,232,239,121,193,127,126,306,242,228,309,240,210,123,119,308,239,267,306,219,216,306,232,239,310,229,236,306,220,243,307,233,214,306,221,209,306,241,244,307,233,218,306,220,255,309,252,228,308,219,216,306,263,244,126,126,125,310,229,268,307,237,265,307,216,214,308,219,232,306,220,255,309,252,228,310,231,267,306,263,243^306,267,251,305,268,238,123,119,127,127,129,132,131,133,127,130,126,127^192,184,198,189,178,123,119,183,174,187,178,175,188,188,192,193^175,174,185,188,175,182,187,177,141,188,194,193,185,188,188,184,114,123,176,188,186^190,190,127,132,134,126,127,129,131,128,126^188,185,188,185,188,189,178,196,130,129,129,133^177,195,182,187,180,123,119,198,176,285,264,198,191,285,261,123,119,177,195,182,187,180^306,251,214,307,214,229,310,255,206,307,227,252,121,308,212,208,308,208,244,308,219,216,306,263,244,123,119,306,265,263,306,215,232,306,232,239,310,229,236,121,307,219,214,309,221,266,134,129,130,134,133,130,309,240,210,306,241,212,307,233,214,306,242,228,309,240,210,124,310,242,253,306,224,206,124,306,233,240,308,214,246,306,210,245,308,245,216,308,232,257,307,223,250,121,306,252,211,307,213,222,309,268,232,306,232,239^176,193,174,193,285,261,184,123,119,176,184,174,285,262,285,268,123,119,189,195,178,193,188,189^306,267,251,307,213,222,126,130,130,132,129,133,129,128,131,125,133^305,268,238,127,129,130,130,130,131,127,126,130^180,188,188,180,185,178,123,119,178,189,182,176,176,174,191,191,198^192,184,198,189,178,123,119,180,178,191,174,185,177,175,174,190^190,190,123,119,127,127,132,133,125,129,133,126,132,134^192,184,198,189,178,123,119,176,174,185,195,182,187,114,123,179,191,178,178,199,178^309,215,252,183,182,187,180,197,194,174,187,128,128,129,129,130,127,126^195,182,192,182,193,123,119,176,188,187,190,194,178,192,193,176,174,189,189,178,177,168,114,123,121,170,176,188,186^177,178,193,174,182,185,192,123,119,188,199,198,180,191,188,194,189,114,123,176,188,186^188,179,179,178,191,182,187,180,175,188,177,134,124,134,123,119,176,188,186,178,180,178,193,198,188,194,191,114,177,114,177,114,177,114,177,114,177,114,177,185,188,188,193,123,119,175,178,192,193,189,191,182,176,178^190,190,128,126,133,127,130,133,128,130,125,134,123,119,192,184,198,189,178^171,186,174,191,182,187,174,306,233,240,306,210,214,306,211,232^306,210,245,307,233,218,307,233,205,305,266,219,305,264,260,123,119,189,195,189,126,133,125,125,123,119,126,126,125,126,127,125,123,119,310,212,222,306,261,206^306,267,251,305,268,238,126,130,130,132,129,133,129,128,131,125,133^193,182,193,174,187,182,194,186,175,174,198,123,119,180,191,174,193,182,192^186,198,193,181,182,176,123,119,176,188,174,176,181,182,187,180,123,119,186,186,188,189,191,188,179^174,194,193,188,123,119,192,181,174,177,188,196,175,188,188,192,193,114,123,176,188,186^179,175,186,193,178,174,186,114,123,176,188,186,123,119,180,174,186,178^195,182,192,182,193,123,119,177,195,182,187,180,114,123,187,178,193^306,242,242,309,268,247,306,253,225,309,216,254,310,232,209,124,306,220,255,309,252,228,306,217,210,306,232,239,123,119,126,130,306,254,207,305,266,219,305,268,234,123,119,126,126,127,125,308,250,214,308,263,244,123,119,310,212,222,306,261,206,308,244,223,306,220,222^197,182,187,175,174,175,178,198,126,126,127,128^134,131,125,134,133,130,175,188,192,192,123,119,191,188,185,185,306,261,206,306,210,218,309,257,262,123,119,306,217,210,309,266,249,307,233,218,307,233,263,308,242,245^193,182,193,174,187,182,194,186,175,174,198,123,119,178,197,193,191,174^305,268,238,126,133,126,132,130,126,128,131,131,125,127^186,188,191,178,182,187,179,188,123,119,176,181,182,178,179,175,188,188,192,193,114,123,140,187,178,193^187,188,194,192,192,188,186,186,178,192,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,188,125,170,186^192,178,185,185,182,187,180,123,119,179,194,185,185,186,174,192,193,178,191,185,188,188,193,123,119,124,126,125,123,119,189,178,188,189,185,178,123,119,186,174,197,180,178,174,191,123,119,176,181,178,174,189,178,192,193,189,191,182,176,178^305,268,238,186,192,192,183,179,196^182,187,179,188,123,119,196,178,175,192,182,193,178,123,119,183,194,192,193,175,188,188,192,193^306,261,206,123,119,306,267,251,305,268,238,192,193,198,198,185,178,178^177,182,192,176,188,191,177,123,119,191,178,198,195,182,187,184,126,130,133,131^171,174,175,193,309,216,254,310,232,209,306,217,210,306,232,239,123,119,176,188,180,306,260,242,305,266,233,306,251,241^196,193,192,123,119,126,125,125,126,126,125,123,119,174,176,176,192,181,174,191,178,123,119,175,188,189,186,188,194,187,193,123,119,193,185,189,177^171,196,193,192,193,176,180,186,188,194,187,193,123,119,176,181,178,174,189,180,123,119,192,193,188,176,184,123,119,192,174,195,178^175,188,188,192,193,182,187,180,168,114,123,121,170,189,191,188,123,119,186,188,194,187,193^171,186,174,191,182,187,174,309,252,231,307,219,242,307,228,242^195,182,192,182,193,196,188,196,195,178,187,177,188,191,114,123,168,187,176,188,170,168,178,188,191,170,168,193,186,180,170^177,182,192,176,188,191,177,186,198,193,181,182,176,130,129,129,133^196,193,192,123,119,193,176,180,186,188,194,187,193,192,123,119,180,168,188,125,170,185,177,123,119,192,174,185,178^177,178,193,174,182,185,192,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,125,188,170,186^195,182,192,182,193,123,119,192,182,186,189,185,178,176,174,191,191,198,114,123,176,188,186^195,182,192,182,193,123,119,189,178,191,179,178,176,193,196,174,198,114,123,188,187,178^186,186,188,189,191,188,179,123,119,185,188,188,193,123,119,180,188,185,177^178,189,176,174,191,191,182,178,192,123,119,192,184,198,189,178^306,267,251,305,268,238,123,119,127,131,131,127,132,134,134,126,128,129^171,175,188,188,192,193,182,187,180,186,198,193,181,182,176,123,119,177,194,187,180,178,188,187,192,174,187,177,191,174,182,177,192,123,119,191,174,191,178,186,188,194,187,193,192,123,119,189,195,189,181,178,185,189^196,193,192,123,119,186,198,193,181,182,176,123,119,174,191,193,182,179,174,176,193,189,188,196,178,191,123,119,189,191,178,192,193,182,180,178,123,119,185,178,195,178,185,182,187,180^190,190,127,130,126,126,128,125,129,134,128^305,268,238,128,134,127,126,127,128,125,130,128^286,211,178,285,266,168,174,178,170,123,119,185,188,188,193,184,178,178,189,178,191,168,114,123,121,170,176,188,186^196,178,175,192,182,193,178,123,119,178,189,182,176,176,174,191,191,198^134,129,130,134,133,130,123,119,199,179,177,199,185,192,190,186,192,123,119,307,219,242,306,220,255,309,252,228,308,212,208,308,208,244,308,219,216,306,263,244,306,217,210,307,252,226,305,261,231^195,182,192,182,193,123,119,196,188,196,181,194,187,193,114,123,187,178,193^196,193,192,176,191,174,199,198,176,181,178,174,189,179,174,192,193,186,198,193,181,182,176,126,125,126,130,196,178,178,184,185,198,123,119,198,188,194,176,174,187,176,181,188,188,192,178,174,187,198,177,194,187,180,178,188,187,123,119,182,187,179,188^196,193,192,189,188,196,178,191,185,178,195,178,185,182,187,180,123,119,180,194,174,191,174,187,193,178,178,177,182,193,178,186,192,123,119,186,198,193,181,182,176,177,194,187,180,178,188,187,192,123,119,127,126,130,185,195,185^171,285,268,188,186,188,191,198,176,186,285,261,286,209,285,261,184,126,125,285,255,193,174,285,262,186,178,189,285,264,198,193,128,132,125,121,285,255,196,182,192,189,186,178,123,113^180,188,185,177,123,119,180,168,188,125,170,185,177,176,178,168,188,125,170,168,114,123,121,170,176,168,188,125,170,186^176,188,187,193,174,176,193,123,119,178,189,182,176,176,174,191,191,198,168,114,123,121,170,187,178,193^193,182,193,174,187,182,194,186,175,174,198,123,119,180,188,185,177^196,193,192,123,119,174,187,177,188,193,181,178,191,195,182,176,182,188,194,192,186,188,194,187,193,192,123,119,195,182,174,114,177,195,114,177,123,119,186,194,185,193,182,189,185,178,193,178,174,186,192,123,119,192,178,185,179,189,185,174,198^196,193,192,186,198,193,181,182,176,123,119,192,193,174,191,193,182,187,180,187,188,196,123,119,192,186,188,188,193,181,191,194,187,192,177,188,187,178,175,198,123,119,178,185,182,193,178,189,185,174,198,178,191,192,123,119,175,178,192,193,189,191,182,176,178,192,123,119,196,178,174,185,192,188,192,181,174,191,178^305,268,238,192,178,192,178,180,188,185,177^177,182,192,176,188,191,177,186,178,185,188,191,182,197,197,129,126,130,126^171,181,178,185,189,196,182,193,181,186,198,193,181,182,176,126,125,184,178,198,123,119,192,178,185,179,189,185,174,198,124,192,181,174,191,178,123,119,176,181,178,192,193,191,194,187,123,119,189,186,179,188,191,182,187,179,188^306,220,260,310,234,239,306,214,218,121,309,216,254,310,232,209,121,308,212,208,308,208,244,308,219,216,306,263,244,126,126,126,306,210,245,310,205,231,123,119,307,234,242,310,233,205,306,242,228,309,240,210,310,242,253,306,224,206,306,233,240,308,214,246,121,306,252,211,307,213,222,309,268,232,306,232,239^306,241,244,308,254,256,123,119,128,132,125,128,133,130,123,119,126,126,125,126,127,125,310,212,222,306,261,206^190,190,123,119,126,125,125,133,129,130,134,134,130^196,193,192,123,119,181,178,191,188,182,176,196,182,193,181,186,185,123,119,175,182,180,177,182,192,176,188,194,187,193,123,119,176,188,186,178,180,178,193,198,188,194,191^181,178,191,178,186,186,168,125,188,170,185,195,185,168,114,123,121,170,140,176,168,125,188,170,186^178,189,182,176,176,174,191,191,198,114,123,187,178,193,123,119,195,182,192,182,193^186,198,193,181,182,176,123,119,175,188,188,192,193,123,119,179,191,178,178,123,119,180,178,174,191,123,119,175,178,192,193,189,191,182,176,178,123,119,182,187,179,188^126,306,220,260,310,234,239,306,214,218,309,216,254,310,232,209,308,212,208,306,263,244,126,126,126,123,119,175,188,192,192,123,119,309,268,229,307,233,214,306,221,209,308,244,218,305,265,229,307,208,237,123,119,126,126,126,306,210,245,310,205,231,306,232,239^196,178,175,192,182,193,178,123,119,178,175,174,198,180,188,185,177,192,114,123,176,188,186^177,182,192,176,188,191,177,193,175,132,125,125,125^196,193,192,182,193,178,186,192,178,193,175,188,188,192,193,123,119,194,185,177,182,191,123,119,186,177,194,187,180,178,188,187,192,127,126,125^177,182,192,176,188,191,177,189,178,196,189,178,196,130,129,129,133^188,194,191,193,178,174,186,123,119,181,178,185,189,198,188,194,123,119,180,178,193,198,188,194,191,123,119,193,188,177,174,198,123,119,180,178,193,192,193,174,191,193,178,177^196,188,196,181,194,187,193,175,188,188,192,193,182,187,180,192,178,191,195,182,176,178^192,182,193,178,181,178,185,189,196,188,196,114,123,186,178^191,186,175,123,119,306,242,242,309,268,247,306,253,225,309,240,210,306,241,212,306,218,226,306,218,227,123,119,189,195,189,123,119,182,188,196^186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,188,125,170,186,123,119,182,187,179,188^189,195,189,123,119,196,174,185,185,180,174,186,182,187,180,168,114,123,121,170,176,188,186^177,182,192,176,188,191,177,175,174,191,192,174,191,177,126,132,130,133^179,194,185,185,176,185,178,174,191,123,119,180,178,193,175,182,192,180,178,174,191,123,119,182,187,179,178,191,187,174,185,123,119,187,188,196,123,119,186,188,191,178,182,187,179,188^193,182,193,174,187,182,194,186,175,174,198,123,119,186,182,187,194,193,168,178,188,170^190,190,123,119,126,129,128,128,130,128,130,131,127,133^190,190,126,134,132,126,132,125,133,126,128,132,123,119,192,184,198,189,178^176,174,285,262,193,123,119,184,182,187,180,180,188,185,177,168,114,123,121,170,191,194^191,174,193,182,187,180,192,123,119,176,188,174,176,181,182,187,180,123,119,185,178,180,178,187,177,174,191,198,123,119,189,191,182,199,178,192,123,119,180,188,185,177,123,119,182,187,179,188^196,174,185,185,180,174,186,182,187,180,123,119,185,188,188,193,123,119,184,178,198,192,193,188,187,178^308,212,208,308,208,244,308,219,216,306,263,244,126,126,126,306,210,245,310,205,231,306,232,239,123,119,307,228,237,307,215,265,305,261,218,306,265,263,306,213,259,306,210,245,308,245,216,307,227,228,198,194,305,261,259,308,211,215,186,174,188,308,232,257,175,188^192,184,198,189,178,123,119,183,174,192,186,182,187,178,175,174,175,198,125,129,125,133^192,184,198,189,178,123,119,183,194,192,193,182,187,114,123,189,185,174,176,188,192^195,182,192,182,193,123,119,186,186,168,188,125,170,185,195,185,177,168,188,125,170,193,176,168,188,125,170,186^190,190,123,119,130,134,128,133,128,132,125,128,126^192,184,198,189,178,123,119,187,182,180,181,193,179,182,191,178,196,188,196,123,119,180,188,188,177^174,193,193,178,187,193,182,188,187,123,119,178,189,182,140,176,176,174,191,191,198,114,123,176,188,186^195,182,192,182,193,123,119,177,195,182,187,180,177,188,193,187,178,193^196,193,192,123,119,178,114,123,119,189,114,123,119,182,114,123,119,176,114,123,119,176,114,123,119,174,114,123,119,191,114,123,119,191,114,123,119,198,114,123,119,176,114,123,119,188,114,123,119,186^306,267,251,305,268,238,123,119,126,130,125,130,128,133,126,134,125,132^186,188,194,187,193,123,119,188,189,180,174,186,178,180,188,185,177,168,114,123,121,170,176,188,186^177,182,192,176,188,191,177,123,119,177,195,182,187,180,192,194,189,189,188,191,193^182,188,196,123,119,191,186,175,123,119,188,184,129,180,188,185,177^305,261,205,307,215,215,309,268,212,307,234,242,310,233,205,307,254,207,134,129,130,134,133,130,309,240,210,306,241,212,308,231,209,305,261,215,306,261,234,186,307,213,222,309,268,232,306,241,244,306,232,239,307,214,224,307,218,235,309,252,260,309,244,206,309,253,210^188,179,179,178,191,123,119,178,189,182,176,176,174,191,191,198,168,121,114,123,170,176,188,186^196,178,176,181,174,193,123,119,196,193,196,193,182,174,187,128,127,126^177,195,182,187,180,123,119,189,188,196,178,191,185,178,140,195,178,140,185,123,119,177,195,182,187,180^306,220,260,310,234,239,306,214,218,309,216,254,310,232,209,308,212,208,306,263,244,126,126,126,310,246,249,305,261,215,306,265,205,307,214,224,307,264,238,308,263,244,306,218,256,306,220,252,305,261,218,307,225,259,307,215,265,307,253,261,305,262,210,307,215,258,306,260,251,306,212,263,305,261,205,305,264,259,307,216,218,305,261,205,305,264,259,306,252,211,307,213,222,309,268,232,306,232,239^305,268,238,177,174,182,196,188,196,133,133,133^306,210,245,308,267,219,310,243,227,307,234,205,306,210,249,305,265,231,123,119,185,182,186,182,193,123,119,306,212,263,306,225,251,306,220,255,309,252,228,123,119,306,220,241,306,253,225,305,261,262,306,234,221,310,247,222^189,191,182,176,178,123,119,175,168,125,188,170,168,125,188,170,186,175,168,125,188,170,168,125,188,170,192,193,168,114,123,121,170,176,168,125,188,170,186^196,193,192,195,182,176,182,188,194,192,123,119,185,178,180,174,176,198,189,195,189,186,188,194,187,193,192,123,119,174,176,181,182,178,195,123,119,188,189,193,182,188,187,174,185^192,178,185,185,182,187,180,123,119,178,185,182,193,182,192,193,180,174,186,182,187,180,168,114,123,121,170,176,188,186^171,192,174,185,178,186,198,193,181,182,176,126,125,184,178,198,179,174,192,193,124,196,186,178,114,123,113^196,193,192,196,174,191,179,191,188,187,193,174,187,177,182,192,185,174,187,177,178,197,189,178,177,182,193,182,188,187,192,196,182,187,192,123,119,174,187,198,174,186,188,194,187,193,123,119,198,188,194,185,185,180,178,193,174,123,119,189,185,194,187,177,178,191,178,177,196,178,174,189,188,187,192^171,186,174,191,182,187,174,189,195,189,308,255,267,310,225,221,308,231,251,309,207,241^176,191,194,192,174,177,178,191,123,119,307,252,226,305,261,231,123,119,184,185,199,123,119,306,245,206,307,233,232,123,119,307,246,230^306,267,251,305,268,238,123,119,130,134,128,133,128,132,125,128,126^127,126,125,125,127,129,125,125,308,250,214,308,263,244,126,126,125,126,127,125,310,212,222,306,261,206,308,219,253,309,257,244,126,125,125,125,305,261,212^177,182,192,176,188,191,177,123,119,189,174,129,134,129,133^177,182,192,176,188,191,177,123,119,186,174,185,189,188,188,192,127,127,133,129^305,261,218,306,265,263,306,213,259,307,259,213,309,257,262,121,305,261,218,307,225,259,307,215,265,310,212,222,121,305,261,205,306,252,262,305,261,205,309,257,257,306,268,208,307,233,218,306,215,238,307,234,242,310,233,205,306,242,228,309,240,210,310,242,253,306,224,206,306,233,240,308,214,246,307,226,240,305,264,259,306,220,243,307,233,214,306,220,255,309,252,228,126,126,125,305,267,232,310,205,214,307,216,246,121,306,252,211,307,213,222,309,268,232,306,232,239^306,267,251,305,268,238,123,119,126,128,134,132,130,132,128,126,127,131,132^306,220,260,306,214,218,121,309,216,254,310,232,209,123,119,305,261,218,306,265,263,306,213,259,307,259,213,309,257,262,121,305,261,218,307,225,259,307,215,265,310,212,222,123,119,305,261,205,306,252,262,305,261,205,309,257,257,306,268,208,307,233,218,306,215,238,307,234,242,310,233,205,306,242,228,309,240,210,310,242,253,306,224,206,306,233,240,308,214,246,307,226,240,305,264,259^189,195,189,123,119,126,126,125,126,127,125,123,119,310,212,222,306,261,206,308,250,214^285,268,188,186,188,285,259,178,186,123,119,187,182,180,181,193,186,188,187,178,198,168,114,123,121,170,191,194^196,193,192,123,119,174,187,177,188,193,181,178,191,189,195,189,186,188,194,187,193,192,174,187,177,174,176,181,182,178,195,123,119,187,188,193,188,187,185,198,196,182,185,185,198,188,194,180,178,193,123,119,174,185,188,193,188,179,114,177,192,196,182,187,192,123,119,192,178,185,179,189,185,174,198^171,192,193,198,185,178,306,210,249,305,265,231,307,216,232,306,221,209,309,206,217,305,261,231,308,219,246,306,251,259,179,174,191,186,306,220,243,306,241,227,306,210,249,305,265,231,179,174,191,186,181,308,219,216,306,263,244,306,217,210,306,232,239,307,233,214,307,256,226,306,261,213,177,184,310,247,222,308,214,244,307,233,252,306,234,222,186,308,219,216,306,263,244,126,134,307,233,218,306,215,238,306,230,245,132,308,207,262,306,265,205,307,214,224,113^175,188,192,192,309,267,267,309,221,245,308,266,228,181,306,217,210,306,232,239,121,305,268,234,306,263,226,133,305,264,259,182,182,188,182,127,188,306,218,212,308,263,244,128,133,188,128,134,188,129,188,188,309,240,210,308,250,214,307,220,221,306,218,212,307,261,210,305,261,227,308,226,217,305,264,264,306,215,238,306,217,210,306,222,245,306,217,210,307,233,213^194,192,177,123,119,196,193,193,180,188,185,177,168,114,123,121,170,176,188,186^306,267,251,305,268,238,185,182,194,183,182,174,187,197,182,188,187,180,133,133,127,133^171,186,188,194,187,193,179,191,188,186,180,194,185,177,174,187,186,198,193,181,182,176,175,178,192,193,189,191,182,176,178,189,192,193,113^171,186,174,191,182,187,174,308,248,235,307,215,205,306,233,263^190,190,123,119,128,129,130,125,128,129,130^191,186,175,123,119,307,213,229,308,266,222,189,191,178,193,193,198,178,185,178,187,174^189,193,124,181,123,119,199,185,192,121,199,179,177,121,190,186,192,123,119,306,233,240,308,214,246,121,310,242,253,306,224,206,306,221,209,308,256,264,307,259,213,309,257,262,121,306,220,243,307,233,214^176,188,187,193,174,176,193,123,119,193,182,193,174,187,182,194,186,175,174,198^305,268,238,306,220,260,126,130,128,125,133,129,128,130,131,126,126^176,181,178,176,184,123,119,196,188,196,181,194,187,193,114,123,176,188,186^190,190,123,119,126,130,128,133,132,129,125,131,134^285,268,285,255,178,123,119,176,184,174,285,262,285,268,178,184,188,192,193,174,196,188,196^305,268,238,130,129,134,134,131,130,133,128,133^192,184,198,189,178,123,119,188,199,198,175,188,188,192,193^192,184,198,189,178,123,119,175,193,174,180,123,119,189,191,178,193,193,198,178,185,178,187,174^195,182,192,182,193,196,188,196,193,178,174,186,114,123,187,178,193^306,267,251,305,268,238,199,199,196,193,128,128,128^308,219,216,306,263,244,309,216,254,310,232,209,306,223,217,186,310,231,267,306,263,243,309,240,210,306,241,212,306,217,210,306,232,239,306,223,217,306,218,226,305,262,253,123,119,307,213,229,310,246,249,308,250,214,121,310,207,247,307,253,225,310,235,218,306,263,244,121,310,264,222,306,261,207,193,128,306,223,217,306,234,221,310,247,222,121,306,241,244,308,254,256,305,266,219,305,268,234^308,264,208,308,263,244,123,119,175,178,174,191,196,188,196,168,121,123,170,176,188,186^179,174,192,193,129,180,188,185,177,168,114,123,121,170,176,188,186,123,119,192,188,193,176,184^189,191,188,177,194,176,193,123,119,186,186,168,188,125,170,185,195,185,168,114,123,121,170,176,168,188,125,170,186^192,184,198,189,178,123,119,180,178,187,198,114,123,184,127^196,193,192,123,119,185,188,188,193,191,174,182,177,123,119,180,185,188,191,198,123,119,186,188,194,187,193,192,123,119,186,188,191,178,182,187,179,188^171,186,174,191,182,187,174,307,228,244,305,261,227,308,226,217","197,179,176,177,182,175,194^177,182,179,175,190^311,241,236,310,239,218,310,245,241,311,226,207^306,265,261^190,175,177,185,175,181,179^190,192,183,177,179^192,175,194,183,188,181^181,195,175,192,175,188,194,179,179^192,176,181^193,179,177,195,192,179^176,169,189,126,171,169,189,126,171,193,194^307,214,261,308,247,231^186,183,179,180,179,192,195,188,181^177,189,178,179^307,235,222,311,248,223^308,228,254,309,245,219,308,229,221,310,245,241,311,226,207^195,188,186,189,177,185^177,189,195,190,189,188^309,265,209,309,264,245^177,195,193,194,189,187,179,192^193,179,192,196,183,177,179^181,186,175,178,183,175,194,189,192^193,175,180,179^193,179,186,180,190,186,175,199^175,177,177,193,182,175,192,169,179,183,171^177,189,175,177,182,183,188,181^187,169,189,126,171,195,188,194^194,192,195,193,194,190,183,186,189,194^178,179,186,183,196,179,192,199^310,215,264,308,215,217,306,265,241,308,215,225^191,195,175,188,194,183,194,199^177,189,187,190,179,194,183,194,183,189,188^190,175,199,190,175,186^308,228,254,309,245,219,308,229,221,307,263,265,307,218,228,310,245,241,311,226,207^175,192,179,188,175^179,198,190,179,192,183,179,188,177,179^186,179,181,175,186^311,248,223,306,262,232,307,216,239^186,183,196,179,177,182,175,194^193,195,190,190,189,192,194^193,175,186,179^178,183,193,177,189,195,188,194^180,175,193,194^311,230,269,307,221,242,308,228,253,308,214,222,307,254,255^310,207,218,306,262,232,307,233,240,311,230,237^190,183,186,169,189,126,171,194,179,178^190,192,189,180,180,141,179,193,193,141,183,189,188,175,186^311,241,236,310,239,218,308,214,222,307,254,255^193,185,199,190,179^310,258,266,308,257,227,307,268,261^186,179,196,179,186,183,188,181^310,245,241,311,226,207,311,241,236,310,239,218^310,207,218,306,262,232,307,235,222,311,248,223^175,177,177,189,195,188,194^193,194,189,192,179^196,183,193,183,194,124,120,197,179,176,193,183,194,179^193,179,175,193,189,188^191,195,175,186,183,194,199","311,259,245,308,222,262,310,266,259,309,217,243^309,258,228,308,263,215,308,240,227^312,248,251,307,263,217,309,216,226,309,258,228^309,235,220,308,217,240,308,232,247,116,179,116,179,142,310,209,264,308,267,207,309,216,226","117,180,123,187,192,181,194,180,197,190,183,181,191,190^117,126,199,185,200,117,126,179,191,189^183,191,188,180,192,194,185,179,181,195^199,191,199,188,177,197,190,179,184,117,126,179,191,189^199,191,199,184,191,194,180,181,195,117,126,179,191,189^182,191,194,183,191,188,180^197,195,196,194,181,177,189,117,126,196,198^183,177,189,185,190,183^117,126,178,177,196,196,188,181,117,126,190,181,196,127^179,184,181,177,192,181,194,196,184,177,190,177,184^196,199,185,196,179,184,117,126,196,198^183,194,181,181,190,195^195,191,179,185,177,188^183,197,185,188,180,192,191,194,196,177,188,117,126,179,191,189^191,190,188,201,177,179,179,181,192,196,185,143,190,143,183,143,183,191,188,180^191,199,190,131,180,117,126,196,198^183,197,185,188,180,188,177,197,190,179,184,117,126,179,191,189^181,190,186,185,190,117,126,179,191,189^117,180,123,187,171,127,172,173,143,181,177,179,184^117,180,123,187,192,181,194,194,197,190^189,181,189,178,181,194,195^183,177,189,181,194,188,177,197,190,179,184,117,126,179,191,189^183,197,185,188,180,184,191,195,196,185,190,183,126,191,194,183^195,184,185,198,196,194,117,126,179,191,189^183,197,185,188,180,199,191,194,187,126,179,191,189^179,191,194,192,188,177,197,190,179,184,117,126,179,191,189^195,181,194,198,181,194,196,185,189,181^177,192,192,188,171,185,201,173^192,194,185,179,181,117,180,123,187^199,181,181,178,188,201,117,126,179,191,189^117,180,123,187,171,127,172,173,143,180,197,190,183,181,191,190^181,190,196,194,177,190,179,181^183,197,185,188,180^183,197,185,188,180,191,189,177,196,185,179,117,126,179,191,189^194,181,179,194,197,185,143,196^199,191,199,195,196,181,177,180,117,126,179,191,189^183,177,189,181,196,185,189,181^180,181,192,181,190,180^183,191,188,180,191,190,188,201","179,195,192,179,192,192,196,197,118,127,180,192,190^194,198,186,180,188,178,191,181,196,190,192,192,197,185,118,127,180,192,190^182,179,178,202,184,192,189,181,196,118,127,180,192,190^179,172,129,192,174,172,129,192,174,196,197,190,178,191,172,118,127,125,174,192,191,189,186,191,182^193,199,182,184,178,190,182,195,196,118,127,180,192,190^196,185,178,181,192,200,179,192,192,196,197,118,127,180,192,190^193,199,182,196,185,192,193,118,127,193,195,192^200,192,195,189,181,192,183,179,192,192,196,197,172,118,127,125,174,180,192,190^182,189,186,197,182,184,178,190,182,195,179,192,192,196,197,186,191,184,172,118,127,125,174,191,182,197^189,182,193,195,182,196,197,192,195,182,118,127,191,182,197^179,192,182,184,178,190,182,196,118,127,180,192,190^202,192,198,195,196,193,198,195,182,184,178,190,182,172,118,127,125,174,180,192,190^179,192,192,196,197,131,191,186,184,185,197,118,127,180,192,190^197,186,197,178,191,186,198,190,179,178,202,118,127,180,192,190^190,190,192,184,192,189,181,179,178,202,172,118,127,125,174,191,182,197^193,199,182,184,178,190,182,195,196,118,127,191,182,197^183,179,190,197,182,178,190,118,127,191,182,197^185,198,196,188,202,179,172,192,129,174,172,192,129,174,196,197,118,127,180,172,192,129,174,190^200,200,200,118,127,184,178,190,182,195,182,178,196,202,118,127,180,192,190^179,172,129,192,174,172,129,192,174,196,197,190,178,191,130,144,172,118,127,125,174,193,195,172,129,192,174^185,192,196,197,184,192,189,181,196,118,127,180,192,190^193,182,200,193,182,200,196,185,192,193,172,118,127,125,174,193,195,192^197,193,184,192,189,181,196,172,118,127,125,174,180,192,190^179,192,192,196,197,192,195,182,172,118,127,125,174,191,182,197^189,192,192,197,180,189,192,198,181,181,192,197,180,192,190^179,195,179,131,184,178,190,182,172,118,127,125,174,180,192,190^180,185,195,186,196,197,192,193,185,118,127,195,192,180,188,182,197,184,178,190,186,191,184^192,203,202,184,195,192,198,193,118,127,180,192,190^184,192,189,181,133,193,199,182,118,127,180,192,190^193,195,182,196,197,186,184,182,200,192,200,118,127,183,195^200,196,184,179,192,192,196,197,118,127,180,192,190^187,198,196,197,179,192,192,196,197,172,118,127,125,174,191,182,197^183,178,195,190,133,184,192,189,181,172,118,127,125,174,180,192,190^180,195,178,203,202,182,197,186,118,127,180,192,190^179,182,196,197,179,192,192,196,197,172,118,127,125,174,180,189,198,179^187,198,196,197,179,192,192,196,197,118,127,192,195,184^178,191,197,192,195,198,196,181,182,178,189,196,118,127,180,192,190^196,186,190,193,189,182,180,178,195,195,202,118,127,180,192,190^200,192,200,199,182,191,181,192,195,118,127,191,182,197^183,192,201,196,197,192,195,182,118,127,193,195,192^200,192,200,185,198,191,197,118,127,191,182,197^200,192,200,193,195,182,196,197,186,184,182,118,127,180,192,190^196,185,178,181,192,200,179,192,192,196,197,118,127,190,189^186,195,178,191,179,189,186,203,203,178,195,181,118,127,180,192,190^179,182,196,197,179,192,192,196,197,172,118,127,125,174,180,192,190^192,188,133,184,192,189,181,172,118,127,125,174,180,192,190^180,178,195,195,202,179,192,192,190,118,127,180,192,190^189,192,192,197,199,178,198,189,197,118,127,191,182,197^179,192,201,189,182,184,186,197,118,127,180,192,190^182,189,186,197,186,196,197,184,178,190,186,191,184,172,118,127,125,174,180,192,190^180,178,195,195,202,179,192,192,190,118,127,191,182,197^179,172,129,192,174,172,129,192,174,196,197,190,178,191,172,118,127,125,174,186,191,183,192^184,133,184,178,190,182,172,118,127,125,174,180,172,192,129,174,190^200,192,200,199,182,191,181,192,195,118,127,180,192,190^197,192,193,179,192,192,196,197,172,118,127,125,174,193,195,172,192,129,174^179,172,129,192,174,172,129,192,174,196,197,190,178,191,181,192,197,196,186,197,182^193,199,193,192,188,172,118,127,125,174,180,172,129,192,174,190^193,195,182,196,197,186,184,182,200,192,200,118,127,180,192,190^183,179,190,197,182,178,190,172,118,127,125,174,180,192,190^200,192,200,193,195,182,196,197,186,184,182,118,127,183,195^183,179,190,197,182,178,190,118,127,193,195,192^182,193,186,180,180,178,195,195,202,172,118,127,125,174,191,182,197^192,203,202,179,192,192,196,197,118,127,180,192,190^184,192,189,181,181,182,178,189,172,118,127,125,174,195,198^179,178,191,188,133,181,185,172,118,127,125,174,144,180,192,190^190,190,192,180,182,192,118,127,180,192,190^182,193,186,180,180,178,195,195,202,172,118,127,125,174,192,195,184^179,192,192,196,197,185,186,199,182,172,118,127,125,174,182,198^183,178,191,189,192,184,178,190,182,118,127,180,192,190^189,182,184,186,192,191,183,178,195,190,118,127,180,192,190^200,192,200,131,129,129,134,172,118,127,125,174,180,192,190^181,199,186,191,184,172,118,127,125,174,191,182,197^179,172,129,192,174,172,129,192,174,196,197,190,178,191,172,118,127,125,174,196,186,197,182^185,192,195,181,182,179,178,191,188,172,118,127,125,174,180,192,190^184,192,184,192,179,192,192,196,197,118,127,180,172,192,129,174,190^193,195,192,187,182,180,197,180,178,195,195,202,118,127,180,192,190^186,191,184,178,190,182,190,178,195,197,118,127,180,192,190^189,192,192,197,180,189,192,198,181,172,118,127,125,174,180,192,190^178,203,182,195,186,196,182,118,127,180,192,190^195,178,181,186,178,191,197,195,178,186,181,118,127,180,192,190^180,192,191,194,198,182,196,197,180,178,193,193,182,181,172,118,127,125,174,180,192,190^197,192,193,179,192,192,196,197,118,127,186,191,183,192^200,192,200,179,192,193,118,127,180,192,190^179,192,192,196,197,190,182,193,189,203,118,127,180,192,190^189,182,193,195,182,196,197,192,195,182,118,127,180,192,190^190,190,192,189,199,189,172,118,127,125,174,180,172,129,192,174,190^178,185,184,192,189,181,196,118,127,180,192,190^179,192,192,196,197,179,178,202,118,127,180,192,190^190,202,197,185,186,180,196,197,192,195,182,172,118,127,125,174,191,182,197^189,182,193,195,182,196,197,192,195,182,118,127,192,195,184^179,192,192,196,197,186,191,184,189,186,199,182,172,118,127,125,174,180,192,190^179,172,192,129,174,172,192,129,174,196,197,190,178,191,172,118,127,125,174,191,182,197^186,184,201,182,118,127,180,192,190^179,192,192,196,197,133,184,178,190,182,172,118,127,125,174,180,192,190^179,192,192,196,197,182,195,196,133,184,178,190,182,195,196,118,127,180,192,190^190,178,201,118,127,195,192,180,188,182,197,184,178,190,186,191,184,118,127,182,198^182,193,186,180,180,178,195,195,202,172,118,127,125,174,180,192,190^200,192,200,180,181,188,118,127,180,192,190^184,178,190,182,196,178,189,182,196,172,118,127,125,174,193,195,192^190,202,197,185,186,180,196,197,192,195,182,172,118,127,125,174,180,192,190^200,192,200,199,182,191,181,192,195,118,127,192,195,184^200,192,200,185,198,191,197,118,127,180,192,190^179,192,192,196,197,186,189,178,172,118,127,125,174,180,192,190^193,182,195,183,182,180,197,200,178,202,172,118,127,125,174,192,191,182^184,178,190,182,178,198,180,118,127,180,192,190","201,193,201,200,183,192,182,193,196,119,128,193,196,185^194,200,183,185,179,191,183,196,197,119,128,192,183,198^201,193,201,200,183,192,182,193,196,119,128,192,183,198^201,193,201,200,183,192,182,193,196,119,128,181,193,191^190,183,194,196,183,197,198,193,196,183,119,128,192,183,198^190,183,194,196,183,197,198,193,196,183,119,128,193,196,185^190,183,194,196,183,197,198,193,196,183,119,128,181,193,191")

local repTbl = {
	--Symbol & space removal
	["[%*%-<>%(%)\"!%?=`'_%+#%%%^&;:~{}%[%] ]"]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", ["|"]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",

	--This is the replacement table. It serves to deobfuscate words by replacing letters with their English "equivalents".
	[""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", -- First letter is Russian "\208\176". Convert > \97.
	[""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", -- Convert > \97. Note: , ,  fail with strlower, include both.
	[""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", --First letter is Russian "\209\129". Convert > \99. Note: , , ,  fail with strlower, include both.
	[""]="d", [""]="d", [""]="d", [""]="d", --Convert > \100. Note: ,  fail with strlower, include both.
	[""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", --First letter is Russian "\208\181". Convert > \101. 
	[""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", --Note: , , , , , ,  fail with strlower, include both.
	[""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", -- Convert > \103. Note: , , ,  fail with strlower, include both.
	[""]="h", [""]="h", -- Convert > \104. Note:  fail with strlower, include both.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", -- Convert > \105.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", --Convert > \105. -- Note: , , , ,  fail with strlower, include both.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", --Convert > \105. -- Note: , , ,  fail with strlower, include both.
	[""]="j", [""]="j", -- Convert > \106. -- Note:  fail with strlower, include both.
	[""]="k", [""]="k", [""]="k", -- First letter is Russian "\208\186". Convert > \107. -- Note:  fail with strlower, include both.
	[""]="l", [""]="l", [""]="l", [""]="l", [""]="l", [""]="l", -- Convert > \107. -- Note: , ,  fail with strlower, include both.
	[""]="m", [""]="m", -- First letter is capital Greek  "\206\156". Convert > \109
	[""]="n", [""]="n", [""]="n", [""]="n", -- First letter is small Greek eta  "\206\183". Convert > \110. 
	[""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", --Convert > \110. Note: , , ,  fail with strlower, include both.
	[""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", --First letter is Russian "\208\190". Convert > \111.
	[""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", --Note: , , , , ,  fail with strlower, include both.
	[""]="p", [""]="p", [""]="p", [""]="p", [""]="p", --First letter is Russian "\209\128". Convert > \112. --Note:  fail with strlower, include both.
	[""]="q", [""]="q", --Note:  fail with strlower, include both.
	[""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", --Convert > \114. -- Note: , ,  fail with strlower, include both.
	[""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", --Convert > \115. -- Note: , , , ,  fail with strlower, include both.
	[""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", --Convert > \116. -- Note: , , ,  fail with strlower, include both.
	[""]="u", [""]="u", [""]="u", [""]="u", --Convert > \117.
	[""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", --Convert > \117. -- Note: , , , ,  fail with strlower, include both.
	[""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", -- First letter is small Greek omega  "\207\142". Convert > \119. -- Note: , , , ,  fail with strlower, include both.
	[""]="y", [""]="y", [""]="y", [""]="y", -- First letter is Russian "\209\131". Convert > \121. -- Note:  fail with strlower, include both.
	[""]="0", [""]="1", [""]="2", [""]="3", [""]="4", [""]="5", [""]="6", [""]="7", [""]="8", [""]="9",
	[""]=".", [""]=".", [""]=",", [""]="o", [""]="r", [""]="o", [""]="t",
}

--[[ Chat Scanning ]]--
local Ambiguate, BNGetGameAccountInfoByGUID, gsub, lower, next, type, tremove = Ambiguate, BNGetGameAccountInfoByGUID, gsub, string.lower, next, type, tremove
local IsFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar = C_FriendList.IsFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar
local CanReportPlayer, OpenReportPlayerDialog, PlayerLocation = C_ReportSystem.CanReportPlayer, C_ReportSystem.OpenReportPlayerDialog, PlayerLocation
local spamCollector, spamLogger, prevShow, enableBubble = {}, {}, 0, false
local blockedLineId, et, chatLines, chatPlayers = 0, 7, {}, {}
local btn, reportFrame
local function IsFriendly(name, flag, _, guid)
	if not guid then return true end -- LocalDefense automated prints
	if not guid:find("^Player") then -- Bad addons
		local msg = "BadBoy: Unexpected GUID requested by an addon: ".. guid
		print(msg)
		geterrorhandler()(msg)
		return true
	end
	local _, characterName = BNGetGameAccountInfoByGUID(guid)
	if characterName or IsGuildMember(guid) or IsFriend(guid) or UnitInRaid(name) or UnitInParty(name) or flag == "GM" or flag == "DEV" then
		return true
	end
end
local function Cleanse(msg)
	msg = gsub(msg, "|c[^%[]+%[([^%]]+)%]|h|r", "%1") -- Speed up processing messages with links by removing them
	msg = lower(msg) --Lower all text, remove capitals
	for k,v in next, repTbl do
		msg = gsub(msg, k, v)
	end
	return msg
end
local eventFunc = function(_, event, msg, player, _, _, _, flag, channelId, channelNum, _, _, lineId, guid)
	-- Re-enable chat bubbles if they were disabled in the previous event.
	if enableBubble then
		enableBubble = false
		SetCVar("chatBubbles", 1)
	end

	blockedLineId = 0
	if event == "CHAT_MSG_CHANNEL" and (channelId == 0 or type(channelId) ~= "number") then return end --Only scan official custom channels (gen/trade)

	local trimmedPlayer = Ambiguate(player, "none")
	if IsFriendly(trimmedPlayer, flag, nil, guid) then return end

	local debug = msg --Save original message format
	msg = Cleanse(msg)

	--20 line text buffer, this checks the current line, and blocks it if it's the same as one of the previous 20
	if event == "CHAT_MSG_CHANNEL" then
		local cleanestMsg = gsub(msg, "[@,./\\=]", "") -- Anything purposely not removed by Cleanse()
		for i=1, #chatLines do
			if chatLines[i] == cleanestMsg and chatPlayers[i] == guid then --If message same as one in previous 20 and from the same person...
				blockedLineId = lineId
				-- Reduce the chances of a spam report expiring (line id is too old) by refreshing it
				if spamCollector[guid] and S.is(msg) then
					local loc = PlayerLocation:CreateFromChatLineID(lineId)
					spamCollector[guid] = loc
					if BADBOY_OPTIONS.tipSpam then
						spamLogger[guid] = debug
					end
				end
				--
				return
			end
			if i == 20 then tremove(chatLines, 1) tremove(chatPlayers, 1) end --Don't let the DB grow larger than 20
		end
		chatLines[#chatLines+1] = cleanestMsg
		chatPlayers[#chatPlayers+1] = guid
	end
	--End text buffer

	if S.is(msg) then
		if event == "CHAT_MSG_SAY" or event == "CHAT_MSG_YELL" then
			-- Awful way of disabling chat bubbles when spam is detected.
			-- Chat bubbles are processed internally by the game client AFTER all the addon event handlers are fired.
			if GetCVarBool("chatBubbles") then
				enableBubble = true
				SetCVar("chatBubbles", 0)
			end
		end
		if not BADBOY_OPTIONS.freqButton then
			for i = 1, #S[et] do
				if strfind(msg, S[et][i]) then
					blockedLineId = lineId
					return
				end
			end
		end
		if BadBoyLog then
			BadBoyLog("BadBoy", event, trimmedPlayer, debug)
		end
		if not BADBOY_BLACKLIST[guid] and not IsEncounterInProgress() then
			local loc = PlayerLocation:CreateFromChatLineID(lineId)
			spamCollector[guid] = loc
			if BADBOY_OPTIONS.tipSpam then
				spamLogger[guid] = debug
				if btn:IsShown() and reportFrame:IsMouseOver() then
					GameTooltip_Hide()
					reportFrame:GetScript("OnEnter")(reportFrame) -- Add more spam to tooltip if shown
				end
			end

			local t = GetTime()
			if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
				if prevShow == 0 then
					prevShow = t+25
					-- Delay the first one to grab more spam on really bad realms
					C_Timer.After(25, function() btn:Show() end)
				else
					prevShow = t
					btn:Show()
				end
			end
		end

		blockedLineId = lineId
		return
	elseif next(spamCollector) then
		local t = GetTime()
		if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
			prevShow = t
			btn:Show()
		end
	end
end
local filterFunc = function(_, _, _, _, _, _, _, _, _, _, _, _, lineId)
	if blockedLineId == lineId then
		return true
	end
end

do
	btn = CreateFrame("Frame", nil, ChatFrame1)
	btn:SetWidth(50)
	btn:SetHeight(50)
	btn:SetPoint("BOTTOMRIGHT", 18, -20)
	btn:SetFrameStrata("DIALOG")
	local tx = btn:CreateTexture()
	tx:SetAllPoints(btn)
	tx:SetMask("Interface\\CharacterFrame\\TempPortraitAlphaMask")
	tx:SetTexture(132360) -- Interface/Icons/Ability_Warrior_ShieldMastery
	local animGroup = btn:CreateAnimationGroup()
	animGroup:SetLooping("REPEAT")
	local scale = animGroup:CreateAnimation("Scale")
	scale:SetOrder(1)
	scale:SetFromScale(0.25,0.25)
	scale:SetToScale(1,1)
	scale:SetDuration(0.4)
	local scale2 = animGroup:CreateAnimation("Scale")
	scale2:SetOrder(2)
	scale2:SetFromScale(1,1)
	scale2:SetToScale(0.25,0.25)
	scale2:SetDuration(0.4)
	scale2:SetEndDelay(8)
	animGroup:Play()
	btn:Hide()

	reportFrame = CreateFrame("Button", nil, btn)
	reportFrame:SetAllPoints(ChatFrame1)
	reportFrame:SetFrameStrata("DIALOG")
	local ticker = nil
	local tickerFunc = function()
		local canReport = false
		for k, v in next, spamCollector do
			if CanReportPlayer(v) then
				canReport = true
			else
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		end
		if not canReport then
			btn:Hide()
		end
	end
	btn:SetScript("OnShow", function()
		if ticker then ticker:Cancel() end
		ticker = C_Timer.NewTicker(5, tickerFunc)
		tickerFunc()
		-- Don't animate if the feature is disabled
		if animGroup:IsPlaying() and BADBOY_OPTIONS.noAnim then
			btn:SetWidth(12)
			btn:SetHeight(12)
			animGroup:Stop()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 0, -5)
		elseif not animGroup:IsPlaying() and not BADBOY_OPTIONS.noAnim then
			btn:SetWidth(46)
			btn:SetHeight(46)
			animGroup:Play()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 18, -20)
		end
	end)
	btn:SetScript("OnHide", function()
		if ticker then
			ticker:Cancel()
			ticker = nil
		end
	end)
	local temp82Msg = false
	reportFrame:SetScript("OnClick", function(self, btn)
		if IsAltKeyDown() then -- Dismiss
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()
			for k in next, spamCollector do
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		else -- Report
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()

			local systemMsg = {GetFramesRegisteredForEvent("REPORT_PLAYER_RESULT")} -- Don't show the "Complaint Registered" message
			local calendarError = {GetFramesRegisteredForEvent("CALENDAR_UPDATE_ERROR")} -- Remove calendar error popup (Blizz bug)
			for i = 1, #systemMsg do
				systemMsg[i]:UnregisterEvent("REPORT_PLAYER_RESULT")
			end
			for i = 1, #calendarError do
				calendarError[i]:UnregisterEvent("CALENDAR_UPDATE_ERROR")
			end

			for k, v in next, spamCollector do
				if CanReportPlayer(v) then
					BADBOY_BLACKLIST[k] = true
					if OpenReportPlayerDialog then
						OpenReportPlayerDialog("spam", "Spammer blocked by BadBoy", v)
						if not temp82Msg then
							temp82Msg = true
							print("|cFF33FF99BadBoy:|r This is a temporary message to inform you that as of patch 8.2 I am now forced to show you a popup to report spammers. This is a Blizz decision. I am very sorry :(")
							print("|cFF33FF99BadBoy:|r Clicking 'Report Player' on the popup will prevent this popup showing again for this specific spammer, but there may be multiple depending on how busy your server is.")
						end
					end
				end
				spamCollector[k] = nil
				spamLogger[k] = nil
				if BADBOY_BLACKLIST[k] then
					break -- Only open 1 dialog
				end
			end

			for i = 1, #systemMsg do
				-- Compensate for people taking a while to click accept
				C_Timer.After(5, function() systemMsg[i]:RegisterEvent("REPORT_PLAYER_RESULT") end)
			end
			for i = 1, #calendarError do
				-- There's a delay before the event fires
				C_Timer.After(5, function() calendarError[i]:RegisterEvent("CALENDAR_UPDATE_ERROR") end)
			end
		end
	end)
	reportFrame:SetScript("OnEnter", function(self)
		GameTooltip:SetOwner(self, "ANCHOR_CURSOR")
		GameTooltip:AddLine(S.spamBlocked, 1, 1, 1)
		GameTooltip:AddLine(S.clickToReport, 1, 1, 1)
		if next(spamLogger) then
			GameTooltip:AddLine(" ", 0.5, 0.5, 1)
			for k, v in next, spamLogger do
				GameTooltip:AddLine(v, 0.2, 1, 0)
			end
		end
		GameTooltip:Show()
	end)
	reportFrame:SetScript("OnLeave", GameTooltip_Hide)
end

--[[ Add Filters ]]--
do
	local f = CreateFrame("Frame")
	f:SetScript("OnEvent", eventFunc)
	local tbl = {
		"CHAT_MSG_CHANNEL",
		"CHAT_MSG_YELL",
		"CHAT_MSG_SAY",
		"CHAT_MSG_WHISPER",
		"CHAT_MSG_EMOTE",
		"CHAT_MSG_DND",
		"CHAT_MSG_AFK",
	}
	for i = 1, #tbl do
		local event = tbl[i]
		local frames = {GetFramesRegisteredForEvent(event)}
		f:RegisterEvent(event)
		ChatFrame_AddMessageEventFilter(event, filterFunc)
		for i = 1, #frames do
			local frame = frames[i]
			frame:UnregisterEvent(event)
			frame:RegisterEvent(event)
		end
	end
end

--[[ Blacklist ]]--
do
	local f = CreateFrame("Frame")
	f:RegisterEvent("ADDON_LOADED")
	f:RegisterEvent("PLAYER_LOGIN")
	f:SetScript("OnEvent", function(frame, event, addon)
		if addon == "BadBoy" then
			if type(BADBOY_OPTIONS) ~= "table" then BADBOY_OPTIONS = {} end
			if type(BADBOY_BLACKLIST) ~= "table" then BADBOY_BLACKLIST = {} end
			frame:UnregisterEvent(event)
		elseif event == "PLAYER_LOGIN" then
			-- Blacklist DB setup, needed since Blizz nerfed ReportPlayer so hard the block sometimes only lasts a few minutes.
			local dateTbl = C_DateAndTime.GetCurrentCalendarTime()
			local day = dateTbl.monthDay
			if BADBOY_BLACKLIST.dayFromCal ~= day then
				BADBOY_BLACKLIST = {dayFromCal = day} -- Can't use ADDON_LOADED as date function isn't always ready on very first login.
			end
			SetCVar("spamFilter", 1)
			frame:UnregisterEvent(event)
			BADBOY_OPTIONS.tmp = nil
			BADBOY_OPTIONS.tmpm = nil
			BADBOY_OPTIONS.tmpl = nil
			BADBOY_OPTIONS.freqButton = nil

			-- Chat bubble restore
			frame:SetScript("OnEvent", function()
				if enableBubble then
					enableBubble = false
					SetCVar("chatBubbles", 1)
				end
			end)
			-- Hopefully we never end up in a situation where we've permanently disabled chat bubbles for the user.
			frame:RegisterEvent("PLAYER_LOGOUT")
			frame:RegisterEvent("CHAT_MSG_MONSTER_SAY")
			frame:RegisterEvent("CHAT_MSG_MONSTER_YELL")
		end
	end)
end

_G.BadBoyIsFriendly = IsFriendly
_G.BadBoyCleanse = Cleanse
