
-- GLOBALS: BADBOY_BLACKLIST, BADBOY_OPTIONS, BadBoyLog, ChatFrame1, GetTime, print, CalendarGetDate
-- GLOBALS: GameTooltip, C_Timer, IsEncounterInProgress, GameTooltip_Hide
local _, S = ...
S.gnt(104,"196,221,218,193,200,217,195,205,199,211,203,218,207,211,203^196,221,218,193,200,217,218,195,205,213,210,202,204,213,216,201,217,205,213^201,199,217,207,212,213,148,144,216,213,210,210,148,144,202,213,219,200,210,203^196,217,203,210,210,207,212,205,205,213,210,202,217,165,204,213,216,201,217,205,213^196,221,218,193,217,218,195,199,201,201,213,219,212,218,221,207,218,206^202,193,213,219,195,193,219,200,195,200,210,203,148,144,139,202,145,148,144,218,216,207,214,214,165,210,203^216,213,210,210,148,144,139,202,145,148,144,216,213,210,210,148,144,139,202,145,148,144,200,203,218^196,200,219,223,207,212,205,213,217,216,217,205,213,210,202,221,207,218,206,221,213,221,205,213,210,202^201,217,205,213,217,209,207,212,217,148,144,205,213,210,202,148,144,217,206,213,214,148,144,211,213,219,212,218,217^196,221,218,193,200,217,218,195,201,217,205,213,201,202,209,203,203,165,223^216,213,210,210,148,144,205,199,211,203,148,144,205,213,210,202,148,144,221,207,212,148,144,210,213,221,203,216^196,221,218,193,200,217,218,195,201,206,203,199,214,201,217,205,213,217,209,207,212^196,205,213,218,217,213,211,203,216,217,150,157,149,165,216,165,217,165,153,165,205,213,210,202,210,199,223,207,212,205,199,216,213,219,212,202,148,144,211,203^200,219,223,207,212,205,165,216,219,212,203,217,201,199,214,203,193,199,205,195^205,213,210,202,204,213,216,216,219,212,203,217,201,199,214,203,205,213,210,202^196,221,218,193,200,217,218,195,211,223,221,213,221,205,213,210,202,148,144,201,217,205,213,217,209,207,212^210,219,201,209,148,144,216,213,210,210,148,144,202,213,219,200,210,203,148,144,205,213,210,202^200,203,218,148,144,216,213,210,210,148,144,222,152,148,144,222,153,148,144,211,207,212,148,144,211,199,222^196,221,218,193,200,217,218,195,211,223,205,213,210,202,204,213,216,201,217,205,213,217,209,207,212^196,221,218,200,205,213,210,202,148,144,205,199,211,203,218,207,211,203^196,221,218,193,200,217,218,195,201,217,205,213,217,218,203,199,211,205,207,204,218^196,221,218,193,217,200,218,195,221,213,221,205,213,210,202,204,213,216,201,217,205,213,217,209,207,212^221,218,193,200,217,195,221,213,221,205,213,210,202,148,144,216,217,205,213,210,202^196,221,218,193,200,217,195,193,153,156,195,150,202,199,223,217,165,214,216,203,214,199,207,202,205,199,211,203,218,207,211,203^196,218,216,199,202,207,212,205,221,213,221,205,213,210,202,204,213,216,213,165,217,165,216,217,205,213,210,202^196,221,218,193,200,217,218,195,201,217,139,148,165,205,213,217,209,207,212^216,213,210,210,148,144,221,207,212,148,144,202,213,219,200,210,203,148,144,211,207,212,148,144,211,199,222^201,199,217,207,212,213,148,144,200,203,218,148,144,139,202,145^196,217,203,210,210,207,212,205,217,213,211,203,201,217,205,213,201,199,217,203^196,221,218,200,205,213,210,202,148,144,211,213,219,212,218^196,217,203,210,210,207,212,205,201,217,205,213,217,209,207,212^201,199,217,207,212,213,148,144,202,207,201,203,148,144,139,202,145,148,144,218,216,207,214,210,203^196,221,218,218,221,213,221,205,204,213,216,213,217,216,217,205^202,213,219,200,210,203,148,144,218,216,207,214,214,165,210,203,148,144,201,199,217,207,212,213^196,221,218,217,139,202,145,202,199,223,217,165,205,199,211,203,201,199,216,202^196,221,218,218,221,213,221,205,213,210,202,204,213,216,213,210,202,217,201,206,213,213,210,216,217,205,213,210,202^196,221,218,193,200,217,218,195,201,217,205,213,209,203,223^201,199,217,207,212,213,148,144,210,203,205,207,218,148,144,217,199,204,203,148,144,201,199,217,207,212,213^196,221,218,217,201,206,203,199,214,199,212,202,204,199,217,218,205,213,210,202^196,200,219,223,207,212,205,201,217,139,148,165,205,193,150,213,195,217,209,207,212^201,199,217,207,212,213,148,144,221,206,207,217,214,203,216,148,144,207,212,204,213^196,221,218,193,200,217,195,200,199,210,199,212,201,203,214,199,223,214,199,210,200,223,205,213,210,202^196,221,218,217,139,202,145,209,204,213,216,139,202,145,203,219^196,221,218,193,200,217,195,205,213,217,209,207,212,217^196,221,218,218,221,213,221,205,204,213,216,216,217,150,157,205^196,221,218,193,200,217,218,195,201,217,205,213,201,206,203,199,214^196,221,218,193,200,217,195,216,217,199,201,201,213,219,212,218^221,218,193,200,217,195,216,219,212,203,217,201,199,214,203,199,201,201,213,219,212,218^221,218,193,200,217,195,216,219,212,203,217,201,199,214,203,205,213,210,202^221,199,212,218,218,213,217,203,210,210,193,149,194,195,200,219,223,201,217,205,213,207,218,203,211^210,219,201,209,148,144,216,213,210,210,148,144,139,202,145,209,148,144,211,207,212,219,218,203,217,148,144,214,217,218^196,221,218,193,200,217,195,139,202,145,216,217,199,201,201,213,219,212,218^196,221,218,218,221,213,221,205,213,210,202,204,213,216,213,217,216,217^201,199,217,207,212,213,148,144,139,202,145,148,144,202,213,219,200,210,203,148,144,139,202,145,148,144,218,216,207,214,214,165,210,203^196,221,218,217,201,206,203,199,214,205,213,210,202^196,221,218,193,200,217,195,205,199,211,203,201,213,202,203^196,221,218,193,200,217,218,195,201,217,217,209,207,212,217^196,221,218,200,216,217,205,214,138^221,218,193,200,217,195,148,144,216,219,212,203,217,201,199,214,203,211,213,212,203,223,148,144,139,202,145,209^196,221,218,193,200,217,218,195,201,217,205,213,201,199,217,203^196,218,216,199,202,207,212,205,201,217,205,213,148,144,205,213,210,202^196,221,218,200,213,217,216,217,205,214^196,221,218,193,200,217,218,195,201,217,205,213,207,218,203,211^221,213,221,205,213,210,202,204,213,216,201,217,205,213,209,203,223^205,213,210,202,148,144,218,216,207,214,214,165,210,203,148,144,201,199,217,207,212,213^221,218,193,200,217,218,195,216,217,153,165,205,213,210,202,148,144,221,213,221,205,213,210,202^196,221,218,193,200,217,218,195,201,217,205,213,199,201,201^196,221,218,193,200,217,218,195,199,212,223,201,217,205,213,217,209,207,212^196,221,218,193,200,217,195,199,165,212,165,199,221,203,217,213,211,203,216,217,199,201,201,213,219,212,218^218,216,199,202,207,212,205,211,223,221,213,216,210,202,213,204,221,199,216,201,216,199,204,218,205,213,210,202,204,213,216,148,144,216,219,212,203,217,201,199,214,203,205,213,210,202^196,217,203,210,210,207,212,205,201,217,205,213,201,199,217,203^196,200,219,223,207,212,205,201,217,205,213,209,203,223^205,199,211,200,210,203,148,144,216,213,210,210,148,144,222,152,148,144,216,213,210,210,148,144,222,155^196,205,213,218,199,212,223,216,219,212,203,217,201,199,214,203,205,213,210,202,149,221,211,203^196,221,218,193,200,217,218,195,201,217,205,213,201,199,211,213^196,217,203,210,210,207,212,205,201,217,205,213,207,218,203,211^196,221,218,193,200,217,195,139,202,145,202,199,223,148,144,205,199,211,203,201,199,216,202^196,221,218,193,200,217,218,195,209,203,223,217,207,212,201,217,205,213^196,221,218,193,200,217,218,195,201,217,205,213,209,212,207,193,204,220,195,203^221,199,212,218,218,213,200,219,223,193,149,194,195,217,203,210,210,201,217,205,213,207,218,203,211^203,222,201,206,199,212,205,207,212,205,216,217,205,213,210,202^201,199,217,207,212,213,148,144,139,202,145,222,152,148,144,139,202,145,222,153^196,221,218,217,139,202,145,202,199,223,217,165,205,199,211,203,218,207,211,203^196,221,218,200,139,202,145,211,150,157,205,214^196,200,219,223,207,212,205,201,206,203,199,214,201,217,205,213,217,209,207,212^196,200,219,223,207,212,205,201,217,205,213,209,212,207,193,204,220,195,203^196,221,218,193,200,217,195,214,216,203,214,199,207,202,201,199,216,202^196,221,218,193,200,217,218,195,217,213,211,203,201,217,205,213,217,209,207,212^201,199,217,207,212,213,148,144,149,221,148,144,139,202,145,148,144,216,213,210,210^221,218,193,200,217,195,216,219,212,203,217,201,199,214,203,214,219,216,203^221,218,193,200,217,195,221,213,221,205,213,210,202,148,144,216,217,201,213,207,212,218,165,217^196,205,213,218,199,212,223,216,217,150,165,153,149,216,217,150,165,157,205,213,210,202,210,199,223,207,212,205,199,216,213,219,212,202,148,144,205,213,213,202,213,204,204,203,216^201,199,217,207,212,213,148,144,216,213,210,210,148,144,139,202,145,148,144,216,213,210,210,148,144,139,202,145^196,221,218,193,217,218,195,221,213,221,199,201,201,213,219,212,218^196,221,218,193,200,217,218,195,210,203,205,207,213,212,201,165,202,165,209,203,223^221,218,217,221,213,221,199,201,201,213,219,212,218,148,144,203,214,207,201^196,221,218,193,200,217,195,205,199,211,203,201,199,216,202^216,213,219,210,203,218,218,203,148,144,216,213,210,210,148,144,152,222,148,144,153,222^139,202,145,148,144,202,193,213,219,195,193,219,200,195,200,210,203,148,144,139,202,145,148,144,218,216,207,214^202,207,201,203,148,144,222,152,148,144,222,153,148,144,200,203,218,217^196,221,218,193,200,217,195,214,216,203,214,199,207,202,205,199,211,203,201,199,216,202^216,219,212,203,217,201,199,214,203,205,213,210,202,204,213,216,221,213,221,205,213,210,202^196,221,218,193,200,217,195,139,202,145,211,213,212,218,206,148,144,205,199,211,203,218,207,211,203^196,200,219,223,207,212,205,216,217,153,217,218,219,204,204^196,221,218,193,200,217,218,195,216,217,150,157,205,213,210,202^216,213,210,210,205,199,211,200,210,203,148,144,139,202,145,148,144,210,213,217,203,139,202,145,148,144,221,207,212,148,144,139,202,145","331,294,264,212,208,200,152,152,152,153,156^218,200,211,209,204,217,206,220,211,203,149,145,203,204,219,200,208,211,149,145,218,219,214,202,210^218,298,269,211,206,204,217,206,220,211,203,221,208,200,212,215^206,220,211,203,149,145,205,208,213,213,218,200,219,219,210,214,215,200,206,204,213,214,212,218,222,208,218,207^222,219,218,221,208,202,208,214,220,218,149,145,202,200,217,217,224,224,214,220,217,204,206,200,217,203,149,145,218,204,211,205,215,211,200,224,149,145,217,204,211,200,219,204,203,218,219,220,205,205^221,223,203,200,208,222,214,222,159,159,159^197,218,298,269,211,206,204,217,206,220,211,203,221,208,200,218,222,208,215,215^222,219,218,202,217,200,225,224,202,207,204,200,215,205,200,218,219,212,224,219,207,208,202,152,151,152,156,222,204,204,210,211,224,149,145,224,214,220,202,200,213,202,207,214,214,218,204,200,213,224,203,220,213,206,204,214,213,149,145,208,213,205,214^331,287,273,331,289,289,333,242,293,332,246,253,208,208,214,208,153,214,332,244,238,334,289,270,154,159,214,154,160,214,155,214,214,335,266,236,334,276,240,333,246,247,332,244,238,333,287,236,331,287,253,334,252,243,331,290,290,332,241,264,332,243,236,332,248,271,332,243,236,333,259,239,206,152,153,151,151,331,287,238,334,245,279,335,283,270^197,218,200,211,209,204,217,206,140,149,166,139^212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,214,151,196,212,149,145,202,214,213,219,200,202,219^222,219,218,149,145,215,208,202,210,149,145,222,204,204,210,211,224,202,207,204,218,219,218,205,214,217,202,207,204,200,215,215,217,208,202,204,149,145,218,219,200,202,210,200,217,212,214,217,149,145,202,207,204,200,215,204,217,215,217,208,202,204^332,267,270,334,280,282,153,152,151,333,254,263,336,256,247,332,239,286,149,145,154,158,156,155,151,151,333,276,269,332,256,271,336,268,279,332,250,232,333,239,249,333,243,238^218,298,269,211,206,204,217,206,214,211,203,214,221,204,217,212,215,149,145,140,203,146,210^197,218,200,211,209,204,217,206,220,211,203,149,145,201,204,207,214,221,200,213,203,204^331,294,264,154,160,160,152,153,159,156,155,159^197,194,221,222,196,208,211,211,210,214,215,194,200,218,196,206,220,211,203,149,145,218,222,208,218,207^222,219,218,222,200,217,205,217,214,213,219,200,213,203,208,218,211,200,213,203,204,223,215,204,203,208,219,208,214,213,218,222,208,213,218,149,145,200,213,224,200,212,214,220,213,219,149,145,224,214,220,211,211,206,204,219,200,149,145,215,211,220,213,203,204,217,204,203,222,204,200,215,214,213,218^216,216,152,160,158,152,158,151,159,152,154,158,149,145,218,210,224,215,204^222,219,218,208,219,204,212,218,204,219,201,214,214,218,219,149,145,220,211,203,208,217,149,145,212,203,220,213,206,204,214,213,218,153,152,151^205,220,211,211,217,220,213,149,145,206,220,200,217,200,213,219,204,204,209,220,218,219,205,214,217,140,203,140,203,146,204,220,217,149,145,219,214,213,208,206,207,219^213,214,206,204,213,203,204,217,218,210,200,211,210,214,201,204,212,214,213,219,149,145,208,213,205,214^197,206,221,208,200,218,222,208,218,207,205,208,213,213,218^197,206,218,200,211,209,218,201,208,211,211,208,206,219,149,145,218,222,208,218,207^331,287,273,331,289,289,332,250,232,333,287,266,332,276,247,149,145,215,217,214,205,214,220,213,203,218,204,200^202,211,200,218,218,149,145,205,201,212,219,204,200,212,140,149,202,214,212^216,216,149,145,154,155,156,151,154,155,156^197,205,208,213,213,218,206,220,211,203,149,145,218,222,208,218,207,149,145,222,212,208,206^201,204,218,219,204,213,149,145,218,210,224,215,204,149,145,218,200,217,212,200,204,211,149,145,202,214,200,202,207,208,213,206^197,205,208,213,213,218,206,220,211,203,205,214,217,140,203,140,203,146,210,217,149,145,212,200,213,206,203,204,217^218,208,219,204,207,204,211,215,222,214,222,140,149,212,204^197,205,208,213,213,218,206,221,208,200,218,222,208,218,207^197,203,200,213,218,210,206,220,211,203,149,145,211,204,221,204,217,208,213,206,149,145,140,203,146,210^218,210,224,215,204,149,145,200,215,215,214,211,200,223,154,151,159,156^217,214,311,290,311,283,200,194,140,149,147,196,215,312,235,149,145,221,208,218,200^201,200,219,219,211,204,219,200,206,149,145,206,207,214,218,219,203,214,206,153,152,154,155,155,151^197,218,200,213,200,206,214,213,149,145,210,214,215,200,206,220,211,203,139^216,216,149,145,152,156,154,159,158,155,151,157,160^331,294,264,153,155,156,156,156,157,153,152,156^206,214,211,203,149,145,218,298,269,211,206,204,217,209,204,206,140,203,140,203,146,210,149,145,222,207,208,218,215,204,217^332,293,277,331,294,264,225,225,222,219,154,154,154^332,246,286,336,260,265,332,240,244,330,231,232,335,242,280,336,258,235,332,236,271,336,231,257,332,277,240,333,240,255,336,281,232,333,253,278,147,334,238,234,334,234,270,334,245,242,332,289,270,206,332,258,265,147,219,153,152,332,268,254,335,266,236,149,145,334,265,293,332,245,242,332,258,265,336,255,262,332,246,269,333,259,240,332,247,235,332,267,270,333,259,244,332,246,281,335,278,254,334,245,242,332,289,270,152,152,151,336,255,294,333,263,291,333,242,240,334,245,258,332,246,281,335,278,254,336,257,293,332,289,269^203,208,218,202,214,217,203,219,201,152,194,152,151,196,151,151^197,213,200,213,218,214,212,200,217,218,220,206,204,213,215,200,206,220,211,203,149,145,215,217,208,218^197,206,205,208,213,213,218,221,208,200,218,222,208,218,207^218,204,211,211,208,213,206,149,145,201,214,214,218,219,149,145,206,220,200,166,217,200,213,219,204,204,149,145,206,208,221,204,200,222,200,224,149,145,208,213,205,204,217,213,200,211,149,145,218,215,214,219^201,200,211,214,201,208,213,203,167,214,220,219,211,214,214,210,140,149,202,214,212^222,219,218,149,145,207,204,217,214,208,202,222,208,219,207,212,211,149,145,201,208,206,203,208,218,202,214,220,213,219,149,145,202,214,212,204,206,204,219,224,214,220,217^197,218,200,211,209,204,217,206,220,211,203,147,218,222,208,218,207^218,298,269,211,206,204,217,206,220,211,203,149,145,218,210,224,215,204^197,212,200,217,208,213,200,334,274,261,333,241,231,332,259,289^216,216,149,145,153,159,156,152,158,154,152,159,159,158^216,216,149,145,156,160,154,159,154,158,151,154,152^197,218,204,208,206,204,217,206,220,208,208,221,208,200,221,208,215,215,218^332,293,277,331,294,264,149,145,152,156,159,156,158,157,153,156,151,151,157^219,208,219,200,213,208,220,212,201,200,224,149,145,206,214,211,203^213,214,206,211,204,206,149,145,218,298,269,211,206,204,217,214,221,204,217,212,214,201,208,211,204,215,200,224^207,204,217,204,212,212,194,151,214,196,211,221,211,194,140,149,147,196,166,202,194,151,214,196,212^212,224,219,207,208,202,149,145,210,204,224,149,145,220,215,206,217,200,203,204,149,145,212,200,218,219,204,217,149,145,200,202,207,208,204,221,149,145,218,210,208,213,149,145,222,204,204,210,211,224^223,208,213,201,200,201,204,224,152,152,153,154^219,208,219,200,213,208,220,212,201,200,224,149,145,211,208,221,217,200,208,218,214,213^197,218,214,206,204,217,204,213,203,200,213,218,210,206,214,211,203,218,298,269,211,206,204,217^219,204,211,204,206,217,200,212,149,145,200,212,208,217,200,213,206,200,212,208,213,206^332,293,277,331,294,264,149,145,218,204,218,204,206,214,211,203^197,215,206,215,332,286,268,331,292,259,332,277,267,331,292,245,331,294,260^218,215,204,211,215,204,213,206,200,217,205,208,213,213,218,219,208,211,211,206,200,213,206,211,208,206,219,221,208,200,218,222,208,218,207^197,206,205,208,213,213,218,200,219,219,166,210,214,215,200^311,286,214,311,290,214,219,214,149,145,205,220,213,212,212,214,140,149,217,220^212,224,219,207,208,202,206,220,208,211,203,208,218,218,204,211,208,208,213,206,149,145,217,220,213,218,200,213,203,212,224,219,207,208,202,203,220,213,206,204,214,213,210,204,224,218,149,145,200,207,204,200,203,214,205,219,207,204,202,220,217,221,204,219,214,203,200,224,149,145,213,214,217,204,216,220,208,217,204,212,204,213,219,218^218,207,200,203,214,222,201,214,214,218,219,140,149,202,214,212,149,145,206,220,208,211,203^218,298,269,211,206,204,217,211,208,203,219,206,220,211,203,149,145,212,214,201,208,211,204,215,200,224^203,208,218,202,214,217,203,212,224,219,207,208,202,156,155,155,159^218,204,204,212,214,217,204,149,145,222,214,222,207,220,213,219,140,149,166,202,214,212^197,218,298,269,211,206,204,217,206,220,211,203,149,145,222,207,208,218,215^202,214,213,219,200,202,219,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,214,151,196,212^213,214,220,218,218,214,212,212,204,218,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,214,151,196,212^212,200,206,204,219,214,222,204,217,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,214,151,196,212^332,293,277,331,294,264,149,145,153,157,157,153,158,160,160,152,154,155^208,213,205,214,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,166,202,194,151,214,196,212^222,204,201,215,200,206,204,149,145,204,215,208,202,202,200,217,217,224^218,204,211,211,208,213,206,149,145,202,211,204,200,217,149,145,203,208,218,202,214,220,213,219,149,145,208,213,205,204,217,213,200,211,149,145,206,220,200,166,217,200,213,219,204,204^332,293,277,331,294,264,149,145,154,156,156,154,154,159,160,158,152^221,208,218,208,219,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,151,214,196,212^216,216,149,145,154,156,159,153,153,151,151,157,157^222,204,201,218,208,219,204,149,145,204,201,200,224,206,214,211,203,218,140,149,202,214,212^197,201,208,211,211,208,206,219,206,220,211,203,205,208,213,213,218,208,213,213,204,139^197,218,200,211,204,212,224,219,207,208,202,152,151,210,204,224,205,200,218,219,150,222,212,204,140,149,139^197,218,298,269,211,206,204,217,206,220,211,203,149,145,140,203,146,210,205,214,217,140,203,146,210,217^197,222,219,218,219,202,206,212,214,220,213,219,149,145,202,207,204,200,215,206,149,145,218,219,214,202,210,149,145,218,200,221,204^218,204,211,211,208,213,206,149,145,204,211,208,219,208,218,219,206,200,212,208,213,206,194,140,149,147,196,202,214,212^197,218,200,211,209,204,217,206,220,211,203,221,208,200,218,222,208,218,207^201,208,211,211,208,206,200,218,219,204,206,220,211,203,149,145,140,203,146,210,149,145,212,200,213,206,203,217,200,201,200,219,219^218,204,211,211,208,213,206,149,145,219,208,212,204,217,149,145,218,204,211,205,215,211,200,224,149,145,205,200,218,219,149,145,219,214,215,206,204,200,217,149,145,208,213,205,214^203,208,218,202,214,217,203,149,145,215,200,155,160,155,159^221,208,218,208,219,149,145,222,214,222,207,220,213,219,140,149,202,214,212^332,268,268,335,294,273,332,279,251,335,242,280,336,258,235,150,332,246,281,335,278,254,332,243,236,332,258,265,149,145,152,156,332,280,233,331,292,245,331,294,260,149,145,152,152,153,151,334,276,240,334,289,270,149,145,336,238,248,332,287,232,334,270,249,332,246,248^152,332,246,286,336,260,265,332,240,244,335,242,280,336,258,235,334,238,234,332,289,270,152,152,152,149,145,201,214,218,218,149,145,335,294,255,333,259,240,332,247,235,334,270,244,331,291,255,333,234,263,149,145,152,152,152,332,236,271,336,231,257,332,258,265^197,212,200,217,208,213,200,332,259,266,332,236,240,332,237,258^153,152,151,151,153,155,151,151,334,276,240,334,289,270,152,152,151,152,153,151,336,238,248,332,287,232,334,245,279,335,283,270,152,151,151,151,331,287,238^222,219,218,221,208,202,208,214,220,218,149,145,214,219,207,204,217,215,221,215,212,214,220,213,219,218,149,145,202,214,212,215,211,204,219,208,214,213,149,145,207,220,213,203,217,204,203,149,145,205,208,218,207,224^197,206,220,211,203,208,213,213,204,149,145,201,204,219,200,211,213,208,213,206,221,208,200,218,222,208,218,207^197,218,200,211,209,204,217,206,208,206,204,213,149,145,218,219,214,202,210,149,145,218,204,210^332,293,277,331,294,264,149,145,153,153,155,158,157,159,153,156,152,153^201,214,214,218,219,208,213,206,194,140,149,147,196,215,217,214,149,145,211,214,214,219^215,217,214,203,220,202,219,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,214,151,196,212^311,294,215,214,311,283,200,311,283,311,287,212,217,215,214,311,280,311,292,311,287,312,237,224,149,145,311,294,214,311,283,200,215,214,210,149,145,311,281,311,294,212^197,140,203,146,210,205,208,213,213,218,149,145,167,218,222,208,218,207^218,210,224,215,204,149,145,214,225,224,201,214,214,218,219^311,294,311,281,204,149,145,202,210,200,311,288,311,294,204,210,214,218,219,200,222,214,222^221,208,218,208,219,149,145,202,200,217,217,224,201,214,214,212,194,140,149,147,196,202,214,212^332,293,277,331,294,264,206,207,204,218,219,211,220,214,201,214^222,219,218,149,145,200,213,203,214,219,207,204,217,215,221,215,212,214,220,213,219,218,200,213,203,200,202,207,208,204,221,149,145,213,214,219,214,213,211,224,222,208,211,211,224,214,220,206,204,219,149,145,200,211,214,219,214,205,140,203,218,222,208,213,218,149,145,218,204,211,205,215,211,200,224^216,147,166,216,152,151,154,159,156,160^197,207,200,217,140,203,146,210,219,208,211,211,218,200,211,220,221,208,200,218,222,208,218,207^311,294,215,214,311,283,200,311,285,200,149,145,202,214,208,213,218,218,219,214,217,204,194,140,149,147,196,217,220^206,214,211,203,149,145,206,194,214,151,196,211,203,202,204,194,214,151,196,194,140,149,147,196,202,194,214,151,196,212^197,222,219,218,220,211,203,208,217,213,212,150,207,202,150,212,224,219,207,208,218,202,207,149,145,153,152,151,212,224,219,207,208,218,202,207,204,221,204,217,211,208,204,218,204,149,145,220,211,203,208,217,207,202,205,220,211,211,206,204,200,217^210,214,215,200,206,220,211,203,218,200,211,209,204,217,209,200,206,220,219,212,208,219,219^214,205,205,204,217,149,145,204,215,208,202,202,200,217,217,224,194,147,140,149,196,202,214,212^197,218,204,211,206,204,217,201,208,211,211,208,206,206,220,211,211,149,145,218,210,224,215,204^203,208,218,202,214,217,203,149,145,203,221,208,213,206,218,220,215,215,214,217,219^331,294,264,149,145,158,158,159,156,159,158,154,152,157^218,210,224,215,204,149,145,201,204,211,210,214,217,210,167,206,212,200,208,211,140,149,202,214,212^205,201,212,219,204,200,212,140,149,202,214,212,149,145,206,200,212,204^197,201,208,211,211,208,206,219,206,220,211,203,219,208,211,218,200,211,206^214,211,214,211,214,215,204,222,156,155,155,159^197,206,205,208,213,213,218,218,222,208,218,207,139^203,208,218,202,214,217,203,212,204,211,214,217,208,223,223,155,152,156,152^217,212,201,149,145,332,268,268,335,294,273,332,279,251,335,266,236,332,267,238,332,244,252,332,244,253,149,145,215,221,215,149,145,208,214,222^332,267,270,334,280,282,149,145,154,158,151,154,159,156,149,145,152,152,151,152,153,151,336,238,248,332,287,232^219,208,211,201,220,203,149,145,218,298,269,211,206,204,217,140,203,146,210,149,145,212,214,201,208,211,204,215,200,224^331,287,290,335,235,248,332,260,247,336,273,248,149,145,332,244,232,332,280,233,331,292,245,331,294,260,149,145,153,152,151,151,215,221,215,334,276,240,334,289,270^202,217,220,218,200,203,204,217,149,145,333,278,252,331,287,257,149,145,210,211,225,149,145,332,271,232,333,259,258,149,145,333,272,256^160,157,151,160,159,156,201,214,218,218,149,145,217,214,211,211,332,287,232,332,236,244,335,283,288,149,145,332,243,236,335,292,275,333,259,244,333,259,289,334,268,271^332,293,277,331,294,264,149,145,152,159,157,160,153,153,151,159,158,155,156^218,298,269,211,206,204,217,140,203,146,210,206,220,211,203,149,145,212,214,201,208,211,204^197,201,214,214,218,219,208,213,206,212,224,219,207,208,202,149,145,203,220,213,206,204,214,213,218,200,213,203,217,200,208,203,218,149,145,217,200,217,204,212,214,220,213,219,218,149,145,215,221,215,207,204,211,215^197,221,208,211,211,213,200,206,214,213,210,214,215,200,206,220,211,203,149,145,218,200,211,209,204,217,220,166,219,166,212,208,219,219,201,208,211,211,208,206,219^197,210,214,215,204,217,206,220,211,203,205,214,217,215,204,213,206,200,217^197,206,220,211,203,205,208,213,213,218,215,200,218,222,208,218,207^197,212,200,217,208,213,200,331,287,250,331,287,257,334,257,235,333,241,267,334,247,237,331,287,250,332,277,285^197,311,294,214,212,214,217,224,202,212,311,287,312,235,311,287,210,152,151,311,281,219,200,311,288,212,204,215,311,290,224,219,154,158,151,147,311,281,222,208,218,215,212,204,149,139^222,219,218,212,224,219,207,208,202,149,145,218,219,200,217,219,208,213,206,213,214,222,149,145,218,212,214,214,219,207,217,220,213,218,203,214,213,204,201,224,149,145,204,211,208,219,204,215,211,200,224,204,217,218,149,145,201,204,218,219,215,217,208,202,204,218,149,145,222,204,200,211,218,214,218,207,200,217,204^203,221,208,213,206,194,140,149,147,196,217,220,149,145,224,202,311,290,224,217,311,287^222,219,218,221,208,202,208,214,220,218,149,145,211,204,206,200,202,224,215,221,215,212,214,220,213,219,218,149,145,200,202,207,208,204,221,149,145,214,215,219,208,214,213,200,211^197,201,208,211,211,208,206,219,206,220,211,203,221,208,200,218,222,208,218,207^197,222,219,194,201,218,196,206,220,211,203,218,222,208,218,207,139^207,140,203,146,210,149,145,222,194,218,139,196,222,208,218,207,149,145,201,208,211,211,208,206,219^221,208,218,208,219,206,215,211,200,224,140,149,215,217,214^331,294,264,203,200,208,222,214,222,159,159,159^222,219,218,149,145,219,202,206,212,214,220,213,219,218,149,145,206,194,214,151,196,211,203,149,145,218,200,211,204^215,221,215,149,145,222,200,211,211,206,200,212,208,213,206,194,140,149,147,196,202,214,212^222,214,222,207,220,213,219,201,214,214,218,219,208,213,206,218,204,217,221,208,202,204^222,204,201,218,208,219,204,149,145,204,215,208,202,202,200,217,217,224^202,207,204,202,210,149,145,222,214,222,207,220,213,219,140,149,213,204,219^197,201,204,207,214,221,204,217,203,220,206,167,218,222,208,218,207^197,218,298,269,211,206,204,217,206,220,211,203,149,145,218,210,217,208,221,219,208,211,212,208,206^219,208,219,200,213,208,220,212,201,200,224,149,145,214,201,219,204,213,204,225^215,221,215,149,145,208,214,222,149,145,214,210,155,206,214,211,203^222,219,218,149,145,218,210,224,215,204,149,145,201,214,214,218,219,208,213,206,207,204,211,215^332,243,236,332,258,265,149,145,156,153,158,154,154,159,160,154,155^197,210,214,215,204,217,140,203,146,210,206,220,211,203,221,208,200,218,222,208,218,207^210,211,225,149,145,333,240,266,152,155,159,155,155,158,152,153,153,155^197,206,220,211,203,140,203,146,210,149,145,210,217,149,145,218,210,224,215,204^216,216,153,158,160,152,153,155,157,154,152^203,208,218,202,214,217,203,149,145,217,204,224,221,208,213,210,152,156,159,157^217,212,201,149,145,333,239,255,334,292,248,215,217,204,219,219,224,204,211,204,213,200^332,293,277,331,294,264,149,145,152,154,160,158,156,158,154,152,153,157,158^205,220,211,211,202,211,204,200,217,149,145,206,204,219,201,208,218,206,204,200,217,149,145,208,213,205,204,217,213,200,211,149,145,213,214,222,149,145,212,214,217,204,208,213,205,214^332,258,265,149,145,152,153,160,153,158,151,157,152,154,155^218,210,224,215,204,149,145,215,221,204,218,207,214,215^203,204,200,211,218,149,145,204,215,208,202,202,200,217,217,224,140,149,213,204,219^222,219,218,149,145,204,140,149,145,215,140,149,145,208,140,149,145,202,140,149,145,202,140,149,145,200,140,149,145,217,140,149,145,217,140,149,145,224,140,149,145,202,140,149,145,214,140,149,145,212^197,206,220,211,203,205,208,213,213,218,200,219,219,210,214,215,200,201,208,211,211,208,206,219^311,294,214,212,214,311,285,204,212,149,145,213,208,206,207,219,212,214,213,204,224,194,140,149,147,196,217,220^197,222,219,218,215,214,222,204,217,211,204,166,221,204,166,211,208,213,206,149,145,200,217,219,208,205,200,202,219^332,293,277,331,294,264,204,224,204,218,211,214,219^221,208,218,208,219,149,145,212,212,194,214,151,196,211,221,211,203,194,214,151,196,219,202,194,214,151,196,212^197,218,200,211,209,204,217,206,220,211,203,215,200,218,222,208,218,207^311,292,311,287,311,286,210,311,287,204,312,237,204,311,292,312,242,149,145,206,204,219,211,214,214,219,194,140,149,147,196,217,220^197,218,200,194,211,208,196,209,204,217,206,221,208,200,218,222,208,218,207^332,293,277,331,294,264,211,208,220,209,208,200,213,223,208,214,213,206,159,159,153,159^204,215,202,200,217,217,208,204,218,149,145,218,210,224,215,204^218,210,224,215,204,149,145,201,219,200,206,149,145,215,217,204,219,219,224,204,211,204,213,200^202,214,213,219,200,202,219,149,145,204,215,208,202,202,200,217,217,224,194,140,149,147,196,213,204,219^334,238,234,334,234,270,334,245,242,332,289,270,149,145,332,236,271,336,231,257,331,290,286,333,263,291,331,292,245,332,290,240,149,145,333,275,265,335,294,245,333,253,279,334,245,272,332,277,285,332,258,261,332,292,249,149,145,201,214,218,218^201,214,214,218,219,149,145,204,223,219,217,204,212,204,211,224,149,145,205,200,218,219,149,145,152,151,151,152,152,151^332,236,271,334,293,245,336,269,253,333,260,231,332,236,275,331,291,257,149,145,211,208,212,208,219,149,145,332,238,289,332,251,277,332,246,281,335,278,254,149,145,332,246,267,332,279,251,331,287,288,332,260,247,336,273,248^214,205,205,204,217,218,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,214,151,196,212^197,335,231,232,334,240,243,334,293,245,333,259,244,202,214,206^201,220,224,218,200,205,204,220,211,203,208,217,149,145,200,213,224,202,207,200,217,200,202,219,204,217,208,218,222,204,211,202,214,212,204,149,145,206,204,219,202,207,204,200,215,149,145,202,220,217,221,204^206,220,211,203,149,145,218,210,224,215,204,149,145,211,204,221,204,217,200,213,218^197,222,219,218,212,224,219,207,208,202,149,145,222,204,204,210,211,224,211,214,214,219,149,145,207,204,211,215,224,214,220,219,214,202,211,204,200,217,149,145,211,204,219,220,218,207,200,213,203,211,204,219,207,204,201,214,217,208,213,206,215,200,217,219,218^331,294,264,212,218,218,209,205,222^202,214,213,219,200,202,219,149,145,219,208,219,200,213,208,220,212,201,200,224^197,212,200,217,208,213,200,332,247,235,334,270,244,334,257,277,335,233,267^208,213,205,214,149,145,204,215,208,202,202,200,217,217,224,194,140,149,147,196,202,214,212^197,218,204,211,206,204,217,206,220,211,211,221,208,200,221,208,215,215,218^208,213,205,214,149,145,222,204,201,218,208,219,204,149,145,209,220,218,219,201,214,214,218,219^332,246,286,336,260,265,332,240,244,335,242,280,336,258,235,334,238,234,332,289,270,194,211,152,196,194,211,152,196,194,211,152,196,149,145,333,290,264,194,211,152,196,194,211,152,196,194,214,151,196,334,289,270,332,244,282,332,246,278,149,145,212,194,211,152,196,194,211,152,196,194,211,152,196^332,293,277,331,294,264,149,145,153,159,155,156,160,157,154,151,154^221,208,218,208,219,222,214,222,219,204,200,212,140,149,213,204,219^222,219,218,149,145,152,151,151,152,152,151,149,145,200,202,202,218,207,200,217,204,149,145,201,214,215,212,214,220,213,219,149,145,219,211,215,203^331,287,231,333,241,241,335,294,238,333,260,268,336,259,231,333,280,233,160,155,156,160,159,156,335,266,236,332,267,238,334,257,235,331,287,241,332,287,260,212,333,239,248,335,294,258,332,267,270,332,258,265,333,240,250,333,244,261,335,278,286,335,270,232,335,279,236^197,206,221,208,200,218,222,208,218,207,149,145,218,210,224,215,204^197,212,200,217,208,213,200,336,255,294,333,258,291,335,242,246,334,257,235,336,265,235,335,270,232^202,200,311,288,219,149,145,210,208,213,206,206,214,211,203,194,140,149,147,196,217,220^197,218,214,210,204,217,140,203,146,210,221,208,200,218,222,208,218,207^221,208,218,208,219,149,145,203,221,208,213,206,140,149,213,204,219^197,206,220,211,203,205,208,213,213,218,149,145,210,214,215,200,149,145,218,222,208,218,207,139^332,246,281,335,278,254,212,335,293,293,335,247,271,334,292,254,149,145,152,152,151,152,153,151,334,289,270,149,145,155,151,151,335,266,236,334,276,240,149,145,215,221,215,153,155,151,151^221,223,209,208,213,206,223,220,200,213,154,154,155,155,156,153,152^216,216,154,152,159,153,156,159,154,156,151,160,149,145,218,210,224,215,204^219,208,219,200,213,208,220,212,201,200,224,149,145,204,223,219,217,200^331,294,264,214,210,155,206,214,211,203^332,246,286,336,260,265,332,240,244,335,242,280,336,258,235,334,238,234,332,289,270,152,152,152,336,272,275,331,287,241,332,291,231,333,240,250,333,290,264,334,289,270,332,244,282,332,246,278,331,287,244,333,251,285,333,241,291,333,279,287,331,288,236,333,241,284,332,286,277,332,238,289,331,287,231,331,290,285,333,242,244,331,287,231,331,290,285,332,278,237,333,239,248,335,294,258,332,258,265^218,204,217,221,208,202,204,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,214,151,196,212^213,214,206,211,204,206,149,145,218,298,269,211,206,204,217,221,208,200,212,214,201,208,211,204,215,200,224^197,218,298,269,211,206,204,217,206,222,207,208,218,215,204,217,139^197,218,200,211,209,204,217,140,203,146,210,149,145,218,222,208,218,207^197,204,213,203,200,213,218,210,204,217,203,204,217,218,298,269,211,206,204,217,206,220,211,203^222,214,222,212,200,217,219,194,140,149,147,196,217,220,149,145,311,286,214,311,290,214,219,214^203,208,218,202,214,217,203,203,214,217,219,222,208,223,153,153,156,155^197,210,214,215,204,217,206,220,211,203,139^218,298,269,211,206,204,217,206,220,211,203,221,208,200,212,214,201,208,211,204,166,215,200,224^197,207,200,217,206,220,211,203,149,145,218,222,208,218,207,201,208,211,211,208,206,219^197,218,200,211,209,204,217,206,220,211,203,149,145,218,210,224,215,204^331,294,264,201,200,201,204,224,152,152,153,154^215,214,222,204,217,211,204,166,221,204,166,211,208,213,206,149,145,217,200,217,204,212,214,220,213,219,218,149,145,202,200,217,217,224^218,207,208,213,204,201,214,214,218,219,159,154,154,151^201,214,214,218,219,219,214,203,200,224,149,145,218,207,200,203,214,222,201,214,214,218,219,140,149,202,214,212^206,214,214,206,211,204,149,145,204,215,208,202,202,200,217,217,224^332,287,232,149,145,332,293,277,331,294,264,218,219,224,224,211,204,204^212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,214,151,196,212,149,145,208,213,205,214^197,213,200,206,214,213,218,214,212,218,200,211,209,204,217,206,220,166,211,166,203,166,221,208,200,218,222,208,218,207^331,294,264,159,160,155,156,159,151,153,154,152^202,207,204,202,210,149,145,222,214,222,207,220,213,219,140,149,202,214,212^197,210,214,215,204,217,222,166,214,166,222,166,206,220,211,203,221,208,200,218,222,208,218,207^154,155,214,154,156,214,154,157,214,154,158,214,335,266,236,334,276,240,333,246,247,332,244,238,149,145,333,287,236,331,287,253,334,252,243,331,290,290,332,241,264,332,243,236,332,248,271,332,243,236,333,259,239,149,145,153,152,151,151,215,221,215,334,270,278,332,239,237^197,218,200,211,209,204,217,222,214,222,206,220,211,203,206,204,213,214,212,218,222,208,218,207^197,218,200,211,209,204,217,218,215,204,211,221,200,211,220,219,200,221,208,200,218,222,208,218,207^216,216,149,145,159,155,158,155,157,156,153,159,157^221,331,294,264,149,145,152,156,151,156,154,159,152,160,151,158^197,218,298,269,211,206,204,217,206,220,211,203,219,208,211,203,200,213,218,210,204,217,204^197,202,214,206,334,293,245,333,259,244,332,286,268,331,292,259,332,277,267^220,218,203,149,145,222,219,219,206,214,211,203,194,140,149,147,196,202,214,212^218,210,224,215,204,149,145,209,200,213,204,201,214,214,218,219^331,287,290,335,235,248,332,260,247,336,273,248,149,145,336,234,292,331,294,260,332,289,252,149,145,334,276,240,334,289,270,149,145,335,266,236,334,276,240,149,145,331,287,253,331,290,290,149,145,215,221,215^197,206,220,211,203,205,208,213,213,218,201,208,211,211,208,206,219,167,218,222,208,218,207^197,218,200,211,209,204,217,206,220,211,203,167,218,222,208,218,207^222,219,218,212,204,202,207,200,206,214,207,220,211,212,210,153,149,145,332,260,247,336,273,248,331,288,260,331,288,260,149,145,336,238,248,334,265,270,332,244,232,331,287,238,331,287,234,332,244,232,149,145,152,140,203,151,149,145,152,153,151,149,145,154,140,203,151^197,207,204,211,215,222,208,219,207,212,224,219,207,208,202,152,151,210,204,224,149,145,218,204,211,205,215,211,200,224,150,218,207,200,217,204,149,145,202,207,204,218,219,217,220,213,149,145,215,212,205,214,217,208,213,205,214^218,208,219,204,149,145,212,212,194,214,151,196,211,221,211,140,149,202,194,214,151,196,212^203,208,218,202,214,217,203,219,201,158,151,151,151^197,218,200,211,209,204,217,206,220,211,203,150,222,139^222,219,218,220,211,203,208,217,207,202,150,213,212,149,145,201,214,214,218,219,203,204,218,208,212,215,211,204,218,203,214,213,209,214,213,218,149,145,212,200,219,204,212,215,218,215,214,220,217,211,200,202,214,205,205,217,204,207,204,201,203,214,212,200,203,200,208,217,204,139^332,293,277,331,294,264,149,145,152,156,151,156,154,159,152,160,151,158^201,204,218,220,202,207,204,213,149,145,222,214,222,221,204,213,203,214,217,140,149,202,214,212^215,219,150,207,149,145,225,211,218,147,225,205,203,147,216,212,218,149,145,332,259,266,334,240,272,147,336,268,279,332,250,232,332,247,235,334,282,290,333,285,239,335,283,288,147,332,246,269,333,259,240^201,214,218,218,335,293,293,335,247,271,334,292,254,207,332,243,236,332,258,265,147,331,294,260,332,289,252,159,331,290,285,208,208,214,208,153,214,332,244,238,334,289,270,154,159,214,154,160,214,155,214,214,335,266,236,334,276,240,333,246,247,332,244,238,333,287,236,331,287,253,334,252,243,331,290,290,332,241,264,332,243,236,332,248,271,332,243,236,333,259,239^202,214,213,219,200,202,219,149,145,204,215,208,202,202,200,217,217,224,194,140,149,147,196,202,214,212^212,214,220,213,219,149,145,214,215,206,200,212,204,206,214,211,203,194,140,149,147,196,202,214,212^221,208,218,208,219,209,201,218,219,140,149,215,217,214^221,208,218,208,219,222,214,222,221,204,213,203,214,217,140,149,194,213,202,214,196,194,204,214,217,196,194,219,212,206,196^200,219,219,204,213,219,208,214,213,149,145,204,215,208,166,202,202,200,217,217,224,140,149,202,214,212^331,294,264,154,160,153,152,153,154,151,156,154^208,214,222,149,145,217,212,201,149,145,214,210,155,206,214,211,203^203,204,219,200,208,211,218,149,145,214,225,224,206,217,214,220,215,140,149,202,214,212^219,208,219,200,213,208,220,212,201,200,224,149,145,212,208,213,220,219,194,204,214,196^218,210,224,215,204,149,145,206,204,213,224,140,149,210,153^197,218,298,269,211,206,204,217,206,215,217,208,218,208,210,210,204,205,200,218,211,200,206,219^218,219,214,217,212,200,213,206,203,206,220,211,203,208,213,213,204,149,145,205,208,213,213,218,201,208,211,211,208,206,219^216,216,149,145,152,151,151,159,155,156,160,160,156^331,294,264,332,246,286,152,156,154,151,159,155,154,156,157,152,152^214,220,217,219,204,200,212,149,145,207,204,211,215,224,214,220,149,145,206,204,219,224,214,220,217,149,145,219,214,203,200,224,149,145,206,204,219,218,219,200,217,219,204,203^333,259,275,333,259,244,149,145,332,246,281,335,278,254,152,152,151,149,145,335,238,273,332,286,280,331,287,241,332,246,286,150,333,254,263,333,241,291,336,238,248,150,331,287,244,332,291,289,332,239,285,333,285,239,335,283,288,333,260,268,334,257,235,333,259,242,332,246,242,212,212,212,212^222,219,218,149,145,217,220,213,218,149,145,200,217,219,208,205,200,202,219,215,214,222,204,217,149,145,211,204,221,204,211,208,213,206,149,145,212,214,217,204,149,145,208,213,205,214^197,218,298,269,211,206,204,217,212,214,213,219,204,217,149,145,208,213,205,214,149,145,204,205,205,204,210,219,208,221^212,224,219,207,208,202,149,145,201,214,214,218,219,149,145,205,217,204,204,149,145,206,204,200,217,149,145,201,204,218,219,215,217,208,202,204,149,145,208,213,205,214^197,218,200,211,209,204,217,222,214,222,206,220,211,203,149,145,218,222,208,218,207^205,200,218,219,155,206,214,211,203,194,140,149,147,196,202,214,212,149,145,218,214,219,202,210^215,204,222,215,204,222,218,207,214,215,140,149,215,217,214,149,145,212,224,219,207,208,202^197,218,298,269,211,206,204,217,206,220,211,203,205,214,217,140,203,146^221,208,218,208,219,149,145,215,204,217,205,204,202,219,222,200,224,140,149,214,213,204^197,206,220,211,203,218,298,269,211,166,206,204,218,149,145,222,205,214,217,212,204,217,204,208,213,205,214^336,238,248,149,145,152,156,159,151,153,156,156,158,152,153,157^218,298,269,211,206,204,217,206,149,145,212,214,201,208,211,204,215,200,224^216,216,153,156,152,152,154,151,155,160,154^202,219,200,219,311,287,210,149,145,202,210,200,311,288,311,294,149,145,215,221,204,219,214,215^200,217,219,208,205,200,202,219,215,214,222,204,217,149,145,204,225,155,224,214,220,140,149,204,220^331,287,244,332,291,289,332,239,285,333,285,239,335,283,288,147,331,287,244,333,251,285,333,241,291,336,238,248,147,331,287,231,332,278,288,331,287,231,335,283,283,332,294,234,333,259,244,332,241,264,333,260,268,336,259,231,332,268,254,335,266,236,336,268,279,332,250,232,332,259,266,334,240,272,333,252,266,331,290,285,332,246,269,333,259,240,332,246,281,335,278,254,152,152,151,331,293,258,336,231,240,333,242,272,147,332,278,237,333,239,248,335,294,258,332,258,265^222,219,218,212,224,219,207,208,202,152,140,203,218,219,200,217,219,208,213,206,213,214,222,149,145,218,212,214,214,219,207,217,220,213,218,149,145,204,223,215,204,217,208,204,213,202,204,149,145,204,211,208,219,204,215,211,200,224,204,217,218,149,145,201,204,218,219,215,217,208,202,204,218,149,145,200,211,218,214,218,204,211,211,208,213,206,149,145,206,214,211,203,214,213,211,224^222,219,218,212,203,220,213,206,204,214,213,218,153,152,156,149,145,206,220,200,217,200,213,219,204,204,203,211,214,214,219,149,145,208,218,211,200,213,203,204,223,215,204,203,208,219,208,214,213,218^197,205,208,213,213,218,218,215,204,211,221,200,211,220,219,200,149,145,219,200,217,218,222,208,218,207,149,145,222,212,208,206^214,205,205,204,217,208,213,206,201,214,203,160,150,160,149,145,202,214,212,204,206,204,219,224,214,220,217,140,203,140,203,140,203,140,203,140,203,140,203,211,214,214,219,149,145,201,204,218,219,215,217,208,202,204^222,219,218,149,145,212,224,219,207,208,202,210,204,224,149,145,202,200,217,217,224,217,220,213,149,145,202,214,212,204,206,204,219,224,214,220,217,200,211,211,149,145,202,207,204,200,215,215,217,208,202,204^216,158,153,155,153,153,154,155,155,159^218,210,224,215,204,149,145,202,200,211,221,208,213,140,149,205,217,204,204,225,204^334,245,279,332,259,271,333,259,240,332,258,265,336,264,285,334,289,270,332,240,278,333,259,275,335,242,280,336,258,235,149,145,332,236,271,336,231,257,333,252,266,332,244,253,333,290,264,334,289,270,332,244,282,332,246,278,332,246,278,335,289,289,332,279,287,149,145,332,246,269,333,259,240,332,246,281,335,278,254,152,152,151,333,275,265,335,294,245,332,249,271,335,278,265^216,216,149,145,152,156,152,154,160,155,152,159,152,155^197,210,214,215,204,217,206,221,208,200,218,222,208,218,207^334,238,234,334,234,270,334,245,242,332,289,270,152,152,152,332,236,271,336,231,257,332,258,265,149,145,333,254,263,333,241,291,331,287,244,332,291,289,332,239,285,332,236,271,334,271,242,333,253,254,224,220,331,287,285,334,237,241,212,200,214,334,258,283,201,214^197,200,201,219,335,242,280,336,258,235,332,243,236,332,258,265,149,145,202,214,206,332,286,268,331,292,259,332,277,267^197,212,200,217,208,213,200,215,221,215,334,281,293,336,251,247,334,257,277,335,233,267^218,210,224,215,204,149,145,212,200,225,204,222,214,222^221,208,218,208,219,205,200,218,219,217,220,213,194,140,149,147,196,208,213,205,214^212,200,213,206,211,204,217,203,220,206,214,211,203,149,145,210,217,214,213,204,217,149,145,212,214,201,208,211,204,215,200,224^332,253,241,152,332,246,286,336,260,265,332,240,244,207,334,245,242,332,289,270,152,152,152,332,236,271,336,231,257,333,290,264,211,211,214,332,244,282,332,246,278,332,268,254,335,266,236,150,336,268,279,332,250,232,150,332,259,266,334,240,272,333,243,248,333,233,271,332,253,259,333,275,265,334,257,235,333,242,294,332,238,289,331,287,231,331,290,285,331,290,255,331,287,231,331,290,285^160,155,156,160,159,156,149,145,225,205,203,225,211,218,216,212,218,149,145,333,245,268,332,246,281,335,278,254,334,238,234,334,234,270,334,245,242,332,289,270,332,243,236,333,278,252,331,287,257^222,219,218,149,145,212,224,219,207,208,202,149,145,200,217,219,208,205,200,202,219,215,214,222,204,217,149,145,215,217,204,218,219,208,206,204,149,145,211,204,221,204,211,208,213,206^222,219,218,221,208,202,208,214,220,218,149,145,214,219,207,204,217,215,221,215,212,214,220,213,219,218,149,145,202,200,217,217,208,204,203,149,145,218,210,208,211,211,149,145,218,204,211,205,215,211,200,224^197,206,220,211,203,221,208,200,218,222,208,218,207^218,210,224,215,204,149,145,213,208,206,207,219,205,208,217,204,222,214,222,149,145,206,214,214,203^208,206,205,200,213,218,149,145,218,219,214,202,210,149,145,203,204,211,208,221,204,217^218,210,224,215,204,149,145,207,204,211,212,208,217,158,156,158,159^197,218,298,269,211,206,204,217,206,194,214,220,196,211,203,149,145,212,214,201,208,211,204,215,200,224^197,202,214,206,332,236,275,331,291,257,335,247,271,332,265,250^216,216,149,145,152,155,154,154,156,154,156,157,153,159^222,200,211,211,206,200,212,208,213,206,149,145,211,214,214,219,149,145,210,204,224,218,219,214,213,204^312,237,204,311,292,194,200,204,196,149,145,211,214,214,219,210,204,204,215,204,217,194,140,149,147,196,202,214,212^334,245,242,332,289,270,335,242,280,336,258,235,332,249,243,212,336,257,293,332,289,269,335,266,236,332,267,238,332,243,236,332,258,265,332,249,243,332,244,252,331,288,279,149,145,333,239,255,336,272,275,334,276,240,147,336,233,273,333,279,251,336,261,244,332,289,270,147,336,290,248,332,287,233,219,154,332,249,243,332,260,247,336,273,248,147,332,267,270,334,280,282,331,292,245,331,294,260^221,208,218,208,219,149,145,222,214,222,201,214,215,140,149,202,214,212^197,218,298,269,211,206,204,217,140,203,146,210,149,145,212,214,201,208,211,204,215,200,224^197,213,200,206,214,213,218,214,212,201,204,207,214,221,204,217,210,214,215,200,206,220,194,211,208,196,203^332,293,277,331,294,264,149,145,152,159,151,156,160,154,160,158,156,157,151^218,210,224,215,204,149,145,206,204,217,200,211,203,201,200,216^221,208,218,208,219,149,145,218,208,212,215,211,204,202,200,217,217,224,140,149,202,214,212^197,194,221,222,196,208,211,211,213,200,206,214,213,210,214,215,194,200,218,196,206,220,211,203,149,145,218,222,208,218,207^197,218,200,211,209,204,217,206,220,211,203,218,213,200,201,201,219,221,208,200,218,222,208,218,207^218,210,224,215,204,149,145,209,200,218,212,208,213,204,201,200,201,224,151,155,151,159^221,208,218,208,219,149,145,222,214,222,207,220,213,219,140,149,213,204,219^332,293,277,331,294,264,149,145,206,214,211,203,205,214,217,218^197,206,205,208,213,213,218,201,208,211,211,208,206,219,139^201,208,211,211,208,206,219,206,220,211,203,149,145,140,203,146,210,149,145,218,222,208,218,207^203,204,219,200,208,211,218,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,151,214,196,212^222,219,218,213,214,217,212,200,211,200,213,203,207,204,217,214,208,202,201,200,219,219,211,204,214,205,203,200,225,200,217,200,211,214,217,212,224,219,207,208,202,217,220,213,218,150,222,205,214,217,208,213,205,214^197,218,200,211,209,204,217,201,208,211,211,208,206,219,206,220,211,203,139^197,201,208,211,211,208,206,219,206,220,166,211,166,203,166,205,208,213,213,218,149,145,218,222,208,218,207^209,200,206,218,200,211,209,204,217,206,220,211,203,221,208,200,218,222,208,218,207^213,214,206,204,213,149,145,218,210,200,211,210,214,201,204,206,149,145,208,213,205,214^215,221,215,149,145,152,152,151,152,153,151,149,145,336,238,248,332,287,232,334,276,240^331,294,264,156,155,160,160,157,156,159,154,159^222,219,218,149,145,222,208,219,207,212,211,149,145,207,208,206,207,216,220,200,211,208,219,224,149,145,201,208,206,203,208,218,202,214,220,213,219^197,218,214,210,204,217,206,221,208,200,218,222,208,218,207^222,219,218,212,224,219,207,208,202,202,207,204,218,219,205,200,217,212,149,145,214,220,217,200,218,218,208,218,219,200,213,202,204,149,145,200,213,224,200,212,214,220,213,219,149,145,217,204,200,203,224,219,214,206,214^197,222,219,201,206,194,214,220,196,211,203,221,208,200,218,222,208,218,207^217,200,219,208,213,206,218,149,145,202,214,200,202,207,208,213,206,149,145,211,204,206,204,213,203,200,217,224,149,145,215,217,208,225,204,218,149,145,206,214,211,203,149,145,208,213,205,214^222,219,218,215,214,222,204,217,211,204,221,204,211,208,213,206,149,145,206,220,200,217,200,213,219,204,204,203,208,219,204,212,218,149,145,212,224,219,207,208,202,203,220,213,206,204,214,213,218,149,145,153,152,156,211,221,211^216,216,149,145,153,153,158,159,151,155,159,152,158,160^197,218,200,211,209,204,217,206,201,208,211,211,208,206,219,221,208,200,218,222,208,218,207^197,218,200,211,209,204,217,206,220,211,203,149,145,140,203,146,210,217,205,214,217,140,203,146,210,149,145,218,222,208,218,207^216,216,149,145,154,152,160,155,156,153,152,159,155,159^203,208,218,202,214,217,203,149,145,218,220,213,213,224,155,152,156,152^332,236,271,333,259,244,333,259,231,331,292,245,331,290,286,149,145,215,221,215,152,159,151,151,149,145,152,152,151,152,153,151,149,145,336,238,248,332,287,232^212,212,214,215,217,214,205,149,145,211,214,214,219,149,145,206,214,211,203^219,208,219,200,213,208,220,212,201,200,224,149,145,206,217,200,219,208,218^215,217,208,202,204,149,145,201,194,151,214,196,194,151,214,196,212,201,194,151,214,196,194,151,214,196,218,219,194,140,149,147,196,202,194,151,214,196,212^208,213,205,214,149,145,201,194,214,151,196,194,214,151,196,212,201,194,214,151,196,194,214,151,196,218,219,147,202,194,214,151,196,212^332,246,286,332,240,244,147,335,242,280,336,258,235,149,145,331,287,244,332,291,289,332,239,285,333,285,239,335,283,288,147,331,287,244,333,251,285,333,241,291,336,238,248,149,145,331,287,231,332,278,288,331,287,231,335,283,283,332,294,234,333,259,244,332,241,264,333,260,268,336,259,231,332,268,254,335,266,236,336,268,279,332,250,232,332,259,266,334,240,272,333,252,266,331,290,285^197,212,200,217,208,213,200,335,278,257,333,245,268,333,254,268^218,298,269,211,206,204,217,206,220,211,203,149,145,215,217,208,218,204,217^197,332,293,277,334,275,248,147,336,233,277,331,290,285,207,334,245,242,332,289,270,152,332,240,244,152,207,152,152,333,252,266,206,336,231,262,333,260,268,212,212,333,260,268,139^197,218,200,211,209,204,217,206,150,222,212,204,139^221,208,218,208,219,149,145,204,215,140,149,166,208,202,202,200,217,217,224,140,149,202,214,212^203,221,208,213,206,149,145,215,214,222,204,217,211,204,166,221,204,166,211,149,145,203,221,208,213,206^331,294,264,211,214,221,204,201,200,201,224,153,154,155^203,221,208,213,206,149,145,224,202,311,290,224,217,311,287,149,145,203,221,208,213,206^221,208,218,208,219,149,145,202,214,213,216,220,204,218,219,202,200,215,215,204,203,194,140,149,147,196,202,214,212^197,205,208,213,213,218,140,203,140,203,146,210,147,140,203,140,203,146,210,217,221,208,200,218,222,208,218,207^206,220,211,203,210,221,200,217,149,145,221,208,200,218,222,208,218,207^218,210,224,215,204,149,145,202,207,208,204,205,201,214,214,218,219^218,298,269,211,206,204,217,206,149,145,140,203,146,210,217,166,215,217^205,200,202,204,201,214,214,210,140,149,202,214,212,150,218,215,217,225,204,203,200,209,210,214,213,219,214,215,211^197,218,219,224,211,204,332,236,275,331,291,257,333,242,258,332,247,235,335,232,243,331,287,257,334,245,272,332,277,285,205,200,217,212,332,246,269,332,267,253,332,236,275,331,291,257,205,200,217,212,207,334,245,242,332,289,270,332,243,236,332,258,265,333,259,240,333,282,252,332,287,239,203,210,336,273,248,334,240,270,333,259,278,332,260,248,212,334,245,242,332,289,270,152,160,333,259,244,332,241,264,332,256,271,158,334,233,288,332,291,231,333,240,250,139^197,218,200,211,209,204,217,206,147,149,145,218,210,217,208,221^212,224,219,207,208,202,149,145,202,214,200,202,207,208,213,206,149,145,212,212,214,215,217,214,205^222,219,218,149,145,200,213,203,214,219,207,204,217,221,208,202,208,214,220,218,212,214,220,213,219,218,149,145,221,208,200,140,203,221,140,203,149,145,212,220,211,219,208,215,211,204,219,204,200,212,218,149,145,218,204,211,205,215,211,200,224^218,298,269,211,206,204,217,206,220,211,203,149,145,208,213,205,214^331,294,264,149,145,152,158,158,159,159,160,156,156,154,155,152^203,208,218,202,214,217,203,149,145,212,200,211,215,214,214,218,153,153,159,155^334,290,234,334,289,270,149,145,201,204,200,217,222,214,222,194,147,149,196,202,214,212^197,332,236,271,333,253,279,335,294,258,332,289,269,150,335,242,280,336,258,235,334,245,242,332,289,270,332,236,271,336,231,257,335,294,258,334,290,235,332,279,280,332,291,231,333,240,250,333,260,268,332,247,235,334,270,244,335,231,232,333,260,294,333,259,275,333,259,244,332,246,281,335,278,254,152,152,151,334,245,279,332,259,271,332,291,231,333,240,250,147,332,236,271,334,282,290,333,254,263,334,274,261,331,289,240,333,275,265,335,294,245,332,247,235,331,292,244,335,231,232,333,260,294,333,253,279,332,288,283,332,294,274,331,288,247,139^197,206,220,166,211,166,203,166,205,208,213,213,218,167,218,222,208,218,207^205,220,211,211,202,211,204,200,217,149,145,201,194,214,151,196,194,214,151,196,218,219,149,145,206,204,219,201,208,218,206,204,200,217,149,145,207,204,211,211,205,208,217,204,208,213,205,204,217,213,200,211,149,145,212,214,217,204,208,213,205,214^332,293,277,333,239,248,152,156,156,158,155,159,155,154,157,151,159^222,217,208,219,204,149,145,212,212,194,214,151,196,211,221,211,194,140,149,147,196,202,194,214,151,196,212^332,246,286,336,260,265,332,240,244,147,335,242,280,336,258,235,147,334,238,234,334,234,270,334,245,242,332,289,270,152,152,152,332,236,271,336,231,257,149,145,333,260,268,336,259,231,332,268,254,335,266,236,336,268,279,332,250,232,332,259,266,334,240,272,147,332,278,237,333,239,248,335,294,258,332,258,265^218,215,204,211,215,204,213,206,200,217,167,218,222,208,218,207^206,220,208,211,203,149,145,218,207,200,203,214,222,201,214,214,218,219,140,149,202,214,212^203,208,218,202,214,217,203,220,215,154,160,151,154^204,215,208,202,202,200,217,217,224,140,149,213,204,219,149,145,221,208,218,208,219^331,294,264,152,159,152,158,156,152,154,157,157,151,153^221,208,218,208,219,149,145,200,213,219,200,217,204,218,201,214,214,218,219,140,149,202,214,212^212,214,217,204,208,213,205,214,149,145,202,207,208,204,205,201,214,214,218,219,140,149,166,213,204,219^332,293,277,331,294,264,152,156,156,158,155,159,155,154,157,151,159^197,222,219,218,140,203,146,210,206,220,211,203,205,214,217,218,222,208,218,207^203,208,218,202,214,217,203,201,200,217,218,200,217,203,152,158,156,159^332,293,277,331,294,264,149,145,156,160,154,159,154,158,151,154,152^216,216,149,145,155,157,160,159,157,156,155,159,156^197,218,200,194,211,208,196,209,204,217,206,220,194,208,211,196,203,215,200,194,218,139,196,222,194,208,211,196,218,207^216,334,293,267,149,145,152,153,153,159,158,152,157,158,152^197,218,200,211,209,204,217,201,208,211,211,208,206,219,166,206,220,211,203,194,212,221,196,194,204,208,196,194,203,200,196,218,222,208,218,207^203,208,218,202,214,217,203,215,204,222,215,204,222,156,155,155,159^197,212,214,220,213,219,205,217,214,212,206,220,211,203,200,213,212,224,219,207,208,202,201,204,218,219,215,217,208,202,204,215,218,219,139^331,294,264,218,204,218,204,206,214,211,203^218,221,204,213,149,145,205,208,213,213,218,149,145,218,219,214,202,210,149,145,218,210,224,215,204^197,218,200,211,209,204,217,221,208,200,218,222,208,218,207^197,206,220,211,203,205,208,213,213,218,149,145,221,208,200,218,222,194,208,211,196,218,207^206,220,211,203,218,200,211,209,204,194,217,218,196,221,208,200,218,222,208,218,207^200,220,219,214,149,145,218,207,200,203,214,222,201,214,214,218,219,140,149,202,214,212^210,214,201,214,211,203,149,145,218,215,217,225,204,203,200,209,210,214,213,219,214,194,140,149,147,196,215,211^218,204,211,211,208,213,206,149,145,205,220,211,211,212,200,218,219,204,217,211,214,214,219,149,145,150,152,151,149,145,215,204,214,215,211,204,149,145,212,200,223,206,204,200,217,149,145,202,207,204,200,215,204,218,219,215,217,208,202,204^206,214,211,203,155,214,210,194,140,149,147,196,202,214,212,149,145,218,214,219,202,210^218,210,224,215,204,149,145,209,220,218,219,208,213,140,149,215,211,200,202,214,218^222,219,218,220,211,203,208,217,207,204,217,214,208,202,205,220,211,211,206,204,200,217,149,145,152,151,215,214,220,217,217,204,202,214,212,215,204,213,218,204,207,204,201,203,214,212,200,203,200,208,217,204,139^332,277,240,333,240,255,336,281,232,333,253,278,147,334,238,234,334,234,270,334,245,242,332,289,270,149,145,332,291,289,332,241,258,332,258,265,336,255,262,147,333,245,240,335,247,292,160,155,156,160,159,156,335,266,236,332,267,238,333,259,240,332,268,254,335,266,236,150,336,268,279,332,250,232,150,332,259,266,334,240,272,332,236,271,334,271,242,334,258,283,333,249,276,147,332,278,237,333,239,248,335,294,258,332,258,265^222,219,218,149,145,211,214,214,219,217,200,208,203,149,145,206,211,214,217,224,149,145,212,214,220,213,219,218,149,145,212,214,217,204,208,213,205,214^331,294,264,206,214,211,203,222,214,222^335,241,278,209,208,213,206,223,220,200,213,154,154,155,155,156,153,152^221,208,218,208,219,215,204,222,215,204,222,218,207,214,215^222,204,202,207,200,219,149,145,222,219,222,219,208,200,213,154,153,152^216,156,155,160,160,157,156,159,154,159^311,286,214,311,290,214,219,214,149,145,212,212,214,200,207,194,140,149,147,196,217,220^197,212,200,217,208,213,200,333,254,270,331,287,253,334,252,243^197,213,200,206,214,213,218,214,212,218,214,210,204,217,206,220,211,203,200,219,219,210,214,215,200^201,214,214,218,219,208,213,206,194,140,149,147,196,215,217,214,149,145,212,214,220,213,219^197,206,220,211,203,218,200,211,209,204,218,201,208,211,211,208,206,219,149,145,218,222,208,218,207^332,251,277,332,293,277,149,145,159,160,155,156,159,151,153,154,152^218,204,211,211,208,213,206,149,145,222,200,217,202,217,200,205,219,149,145,205,220,211,211,206,204,200,217,201,214,214,218,219,149,145,224,214,220,222,208,211,211,206,204,219,149,145,217,204,211,208,202,218,149,145,218,215,214,219,218^215,204,213,206,200,217,205,208,213,213,218,221,208,200,218,222,208,218,207^221,208,218,208,219,149,145,203,221,208,213,206,203,214,219,213,204,219^140,203,140,203,140,203,210,206,214,211,203,149,145,218,219,200,217,219,213,214,222,149,145,202,220,217,221,204,149,145,211,214,214,219,200,217,204,218,207,200,217,204,203,149,145,205,220,211,211,206,220,208,211,203,149,145,203,208,218,202,214,217,203","204,209,219,203,215,221,214,220^201,203,203,215,221,214,220^206,201,219,220^216,218,209,203,205^218,202,207^334,254,280,335,271,245,334,255,247,333,289,291,333,244,254,336,271,267,337,252,233^202,195,215,152,197,195,215,152,197,219,220^217,221,201,214,220,209,220,225^219,220,215,218,205^219,205,218,222,209,203,205^336,241,290,334,241,243,332,291,267,334,241,251^221,214,212,215,203,211^201,218,205,214,201^216,201,203,211,201,207,205^223,205,202,203,208,201,220^203,215,201,203,208,209,214,207^207,212,201,204,209,201,220,215,218^207,221,201,218,201,214,220,205,205^212,209,205,206,205,218,221,214,207^336,284,292,334,283,253,333,294,287^334,254,280,335,271,245,334,255,247,336,271,267,337,252,233^217,221,201,212,209,220,225^203,215,221,216,215,214^332,291,287^219,201,212,205^203,215,204,205^203,208,205,201,216^337,256,295,333,247,268,334,254,279,334,240,248,333,280,281^337,267,262,336,265,244,336,271,267,337,252,233^219,205,201,219,215,214^219,205,212,206,216,212,201,225^216,218,215,206,206,167,205,219,219,167,209,215,214,201,212^337,274,249,332,288,258,333,242,265^336,233,244,332,288,258,333,259,266,337,256,263^219,205,203,221,218,205^216,209,212,195,215,152,197,220,205,204^204,205,212,209,222,205,218,225^336,271,267,337,252,233,337,267,262,336,265,244^212,205,207,201,212^335,291,235,335,290,271^333,240,287,334,273,257^205,224,216,205,218,209,205,214,203,205^333,261,248,337,274,249^222,209,219,209,220,150,146,223,205,202,219,209,220,205^216,201,225,216,201,212^219,221,216,216,215,218,220^219,211,225,216,205^203,221,219,220,215,213,205,218^218,201,220,209,214,207^203,215,213,216,205,220,209,220,209,215,214^220,218,221,219,220,216,209,212,215,220^213,195,215,152,197,221,214,220^337,267,262,336,265,244,334,240,248,333,280,281^219,201,206,205^201,203,203,219,208,201,218,195,205,209,197^212,205,222,205,212,209,214,207^336,233,244,332,288,258,333,261,248,337,274,249^212,209,222,205,203,208,201,220","338,274,277,333,289,243,335,242,252,335,284,254^335,261,246,334,243,266,334,258,273,142,205,142,205,168,336,235,290,334,293,233,335,242,252^337,285,271,334,248,288,336,292,285,335,243,269^335,284,254,334,289,241,334,266,253","207,216,212,211,216,143,152,205,217,215^209,203,215,207,220,214,203,223,216,205,210,143,152,205,217,215^221,210,211,224,222,220,143,152,205,217,215^206,207,218,207,216,206^143,152,225,211,226,143,152,205,217,215^143,152,204,203,222,222,214,207,143,152,216,207,222,153^143,206,149,213,197,153,198,199,169,207,203,205,210^225,217,225,214,203,223,216,205,210,143,152,205,217,215^209,223,211,214,206^208,217,220,209,217,214,206^207,216,222,220,203,216,205,207^209,217,214,206,218,220,211,205,207,221^225,217,225,210,217,220,206,207,221,143,152,205,217,215^221,217,205,211,203,214^205,210,207,203,218,207,220,222,210,203,216,203,210^218,220,211,205,207,143,206,149,213^217,216,214,227,203,205,205,207,218,222,211,169,216,169,209,169,209,217,214,206^209,220,207,207,216,221^209,223,211,214,206,214,203,223,216,205,210,143,152,205,217,215^225,217,225,221,222,207,203,206,143,152,205,217,215^221,207,220,224,207,220,222,211,215,207^209,217,214,206,217,216,214,227^222,225,211,222,205,210,143,152,222,224^143,206,149,213,218,207,220,220,223,216^223,221,222,220,207,203,215,143,152,222,224^225,207,207,204,214,227,143,152,205,217,215^217,225,216,157,206,143,152,222,224^209,223,211,214,206,218,217,220,222,203,214,143,152,205,217,215^143,206,149,213,218,207,220,206,223,216,209,207,217,216^209,203,215,211,216,209^143,206,149,213,197,153,198,199,169,206,223,216,209,207,217,216^209,223,211,214,206,225,217,220,213,152,205,217,215^209,203,215,207,222,211,215,207^203,218,218,214,197,211,227,199^205,217,220,218,214,203,223,216,205,210,143,152,205,217,215^215,207,215,204,207,220,221^209,223,211,214,206,217,215,203,222,211,205,143,152,205,217,215^209,223,211,214,206,210,217,221,222,211,216,209,152,217,220,209^220,207,205,220,223,211,169,222","215,208,219,221,208,222,223,218,221,208,144,153,206,218,216^205,198,155,218,200,198,155,218,200,222,223,216,204,217,198,144,153,151,200,212,217,209,218^215,218,218,223,206,215,218,224,207,207,218,223,206,218,216^226,218,226,219,221,208,222,223,212,210,208,144,153,206,218,216^205,221,205,157,210,204,216,208,198,144,153,151,200,206,218,216^212,221,204,217,205,215,212,229,229,204,221,207,144,153,206,218,216^205,218,218,222,223,212,215,204,198,144,153,151,200,206,218,216^226,218,226,219,221,208,222,223,212,210,208,144,153,209,221^218,229,228,205,218,218,222,223,144,153,206,218,216^210,204,216,208,204,224,206,144,153,206,218,216^209,204,217,215,218,210,204,216,208,144,153,206,218,216^215,208,219,221,208,222,223,218,221,208,144,153,217,208,223^226,218,226,225,208,217,207,218,221,144,153,206,218,216^223,212,223,204,217,212,224,216,205,204,228,144,153,206,218,216^211,218,221,207,208,205,204,217,214,198,144,153,151,200,206,218,216^226,218,226,211,224,217,223,144,153,206,218,216^210,218,215,207,159,219,225,208,144,153,206,218,216^219,225,208,222,211,218,219,144,153,219,221,218^210,218,210,218,205,218,218,222,223,144,153,206,198,218,155,200,216^208,219,212,206,206,204,221,221,228,198,144,153,151,200,218,221,210^204,229,208,221,212,222,208,144,153,206,218,216^205,198,155,218,200,198,155,218,200,222,223,216,204,217,207,218,223,222,212,223,208^219,225,208,210,204,216,208,221,222,144,153,217,208,223^228,218,224,221,222,219,224,221,208,210,204,216,208,198,144,153,151,200,206,218,216^209,205,216,223,208,204,216,144,153,219,221,218^209,218,227,222,223,218,221,208,144,153,219,221,218^223,218,219,205,218,218,222,223,198,144,153,151,200,219,221,198,218,155,200^226,218,221,215,207,218,209,205,218,218,222,223,198,144,153,151,200,206,218,216^221,204,207,212,204,217,223,221,204,212,207,144,153,206,218,216^220,224,212,206,214,204,217,207,222,216,218,218,223,211,144,153,206,218,216^205,218,218,222,223,216,208,219,215,229,144,153,206,218,216^212,210,227,208,144,153,206,218,216^226,218,226,157,155,155,160,198,144,153,151,200,206,218,216^216,228,223,211,212,206,222,223,218,221,208,198,144,153,151,200,217,208,223^210,159,210,204,216,208,198,144,153,151,200,206,198,218,155,200,216^208,215,212,223,208,210,204,216,208,221,205,218,218,222,223,212,217,210,198,144,153,151,200,217,208,223^208,205,204,228,210,218,215,207,222,144,153,206,218,216^205,218,218,222,223,159,210,204,216,208,198,144,153,151,200,206,218,216^209,205,216,223,208,204,216,144,153,217,208,223^210,204,216,208,222,204,215,208,222,198,144,153,151,200,219,221,218^218,229,228,210,221,218,224,219,144,153,206,218,216^215,218,218,223,206,215,218,224,207,198,144,153,151,200,206,218,216^219,225,219,218,214,198,144,153,151,200,206,198,155,218,200,216^206,218,217,220,224,208,222,223,206,204,219,219,208,207,198,144,153,151,200,206,218,216^215,208,219,221,208,222,223,218,221,208,144,153,218,221,210^205,218,218,222,223,211,212,225,208,198,144,153,151,200,208,224^222,211,204,207,218,226,205,218,218,222,223,144,153,206,218,216^205,198,218,155,200,198,218,155,200,222,223,216,204,217,198,144,153,151,200,217,208,223^215,208,210,212,218,217,209,204,221,216,144,153,206,218,216^209,204,221,216,159,210,218,215,207,198,144,153,151,200,206,218,216^206,211,221,212,222,223,218,219,211,144,153,221,218,206,214,208,223,210,204,216,212,217,210^212,217,210,204,216,208,216,204,221,223,144,153,206,218,216^226,218,226,211,224,217,223,144,153,217,208,223^205,208,222,223,205,218,218,222,223,198,144,153,151,200,206,215,224,205^226,222,210,205,218,218,222,223,144,153,206,218,216^219,225,208,210,204,216,208,221,222,144,153,206,218,216^215,218,218,223,225,204,224,215,223,144,153,217,208,223^218,214,159,210,218,215,207,198,144,153,151,200,206,218,216^219,221,218,213,208,206,223,206,204,221,221,228,144,153,206,218,216^208,219,212,206,206,204,221,221,228,198,144,153,151,200,206,218,216^206,204,221,221,228,205,218,218,216,144,153,217,208,223^205,204,217,214,159,207,211,198,144,153,151,200,170,206,218,216^205,218,208,210,204,216,208,222,144,153,206,218,216^210,218,215,207,207,208,204,215,198,144,153,151,200,221,224^216,204,227,144,153,221,218,206,214,208,223,210,204,216,212,217,210,144,153,208,224^205,218,227,215,208,210,212,223,144,153,206,218,216^205,221,218,205,218,218,222,223,144,153,206,218,216^208,215,212,223,212,222,223,210,204,216,212,217,210,198,144,153,151,200,206,218,216^209,205,216,223,208,204,216,198,144,153,151,200,206,218,216^219,208,221,209,208,206,223,226,204,228,198,144,153,151,200,218,217,208^211,224,222,214,228,205,198,218,155,200,198,218,155,200,222,223,144,153,206,198,218,155,200,216^207,225,212,217,210,198,144,153,151,200,217,208,223^223,218,219,205,218,218,222,223,144,153,212,217,209,218^216,216,218,215,225,215,198,144,153,151,200,206,198,155,218,200,216^204,217,223,218,221,224,222,207,208,204,215,222,144,153,206,218,216^219,208,226,219,208,226,222,211,218,219,198,144,153,151,200,219,221,218^219,221,208,222,223,212,210,208,226,218,226,144,153,206,218,216^211,218,222,223,210,218,215,207,222,144,153,206,218,216^205,218,218,222,223,212,217,210,215,212,225,208,198,144,153,151,200,206,218,216^226,218,226,225,208,217,207,218,221,144,153,217,208,223^213,224,222,223,205,218,218,222,223,144,153,218,221,210^216,216,218,206,208,218,144,153,206,218,216^226,226,226,144,153,210,204,216,208,221,208,204,222,228,144,153,206,218,216^205,218,218,222,223,218,221,208,198,144,153,151,200,217,208,223^223,219,210,218,215,207,222,198,144,153,151,200,206,218,216^216,228,223,211,212,206,222,223,218,221,208,198,144,153,151,200,206,218,216^226,218,226,225,208,217,207,218,221,144,153,218,221,210^222,212,216,219,215,208,206,204,221,221,228,144,153,206,218,216^205,198,155,218,200,198,155,218,200,222,223,216,204,217,198,144,153,151,200,218,217,215,212,217,208^205,208,222,223,205,218,218,222,223,198,144,153,151,200,206,218,216^206,204,221,221,228,205,218,218,216,144,153,206,218,216^219,221,208,222,223,212,210,208,226,218,226,144,153,209,221^208,219,212,206,206,204,221,221,228,198,144,153,151,200,217,208,223^226,218,226,205,218,219,144,153,206,218,216^226,218,226,206,207,214,144,153,206,218,216^205,198,155,218,200,198,155,218,200,222,223,216,204,217,156,170,198,144,153,151,200,219,221,198,155,218,200^216,216,218,210,218,215,207,205,204,228,198,144,153,151,200,217,208,223^205,218,218,222,223,208,221,222,159,210,204,216,208,221,222,144,153,206,218,216^213,224,222,223,205,218,218,222,223,198,144,153,151,200,217,208,223^205,198,155,218,200,198,155,218,200,222,223,216,204,217,198,144,153,151,200,222,212,223,208^205,218,218,222,223,157,217,212,210,211,223,144,153,206,218,216^222,211,204,207,218,226,205,218,218,222,223,144,153,216,215^204,211,210,218,215,207,222,144,153,206,218,216^206,221,204,229,228,208,223,212,144,153,206,218,216","216,209,220,222,209,223,224,219,222,209,145,154,207,219,217^227,219,227,226,209,218,208,219,222,145,154,207,219,217^216,209,220,222,209,223,224,219,222,209,145,154,219,222,211^216,209,220,222,209,223,224,219,222,209,145,154,218,209,224^227,219,227,226,209,218,208,219,222,145,154,219,222,211^220,226,209,211,205,217,209,222,223,145,154,218,209,224^227,219,227,226,209,218,208,219,222,145,154,218,209,224")

local repTbl = {
	--Symbol & space removal
	["[%*%-<>%(%)\"!%?=`'_%+#%%%^&;:~{}%[%] ]"]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", ["|"]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",

	--This is the replacement table. It serves to deobfuscate words by replacing letters with their English "equivalents".
	[""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", -- First letter is Russian "\208\176". Convert > \97.
	[""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", -- Convert > \97. Note: , ,  fail with strlower, include both.
	[""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", --First letter is Russian "\209\129". Convert > \99. Note: , , ,  fail with strlower, include both.
	[""]="d", [""]="d", [""]="d", [""]="d", --Convert > \100. Note: ,  fail with strlower, include both.
	[""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", --First letter is Russian "\208\181". Convert > \101. 
	[""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", --Note: , , , , , ,  fail with strlower, include both.
	[""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", -- Convert > \103. Note: , , ,  fail with strlower, include both.
	[""]="h", [""]="h", -- Convert > \104. Note:  fail with strlower, include both.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", -- Convert > \105.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", --Convert > \105. -- Note: , , , ,  fail with strlower, include both.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", --Convert > \105. -- Note: , , ,  fail with strlower, include both.
	[""]="j", [""]="j", -- Convert > \106. -- Note:  fail with strlower, include both.
	[""]="k", [""]="k", [""]="k", -- First letter is Russian "\208\186". Convert > \107. -- Note:  fail with strlower, include both.
	[""]="l", [""]="l", [""]="l", [""]="l", [""]="l", [""]="l", -- Convert > \107. -- Note: , ,  fail with strlower, include both.
	[""]="m", [""]="m", -- First letter is capital Greek  "\206\156". Convert > \109
	[""]="n", [""]="n", [""]="n", [""]="n", -- First letter is small Greek eta  "\206\183". Convert > \110. 
	[""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", --Convert > \110. Note: , , ,  fail with strlower, include both.
	[""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", --First letter is Russian "\208\190". Convert > \111.
	[""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", --Note: , , , , ,  fail with strlower, include both.
	[""]="p", [""]="p", [""]="p", [""]="p", [""]="p", --First letter is Russian "\209\128". Convert > \112. --Note:  fail with strlower, include both.
	[""]="q", [""]="q", --Note:  fail with strlower, include both.
	[""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", --Convert > \114. -- Note: , ,  fail with strlower, include both.
	[""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", --Convert > \115. -- Note: , , , ,  fail with strlower, include both.
	[""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", --Convert > \116. -- Note: , , ,  fail with strlower, include both.
	[""]="u", [""]="u", [""]="u", [""]="u", --Convert > \117.
	[""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", --Convert > \117. -- Note: , , , ,  fail with strlower, include both.
	[""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", -- First letter is small Greek omega  "\207\142". Convert > \119. -- Note: , , , ,  fail with strlower, include both.
	[""]="y", [""]="y", [""]="y", [""]="y", -- First letter is Russian "\209\131". Convert > \121. -- Note:  fail with strlower, include both.
	[""]="0", [""]="1", [""]="2", [""]="3", [""]="4", [""]="5", [""]="6", [""]="7", [""]="8", [""]="9",
	[""]=".", [""]=".", [""]=",", [""]="o", [""]="r", [""]="o", [""]="t",
}

--[[ Chat Scanning ]]--
local Ambiguate, BNGetGameAccountInfoByGUID, gsub, lower, next, type, tremove = Ambiguate, BNGetGameAccountInfoByGUID, gsub, string.lower, next, type, tremove
local IsFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar = C_FriendList.IsFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar
local CanReportPlayer, ReportPlayer, PlayerLocation = C_ReportSystem.CanReportPlayer, C_ReportSystem.ReportPlayer, PlayerLocation
local spamCollector, backupCollector, spamLogger, prevShow, enableBubble = {}, {}, {}, 0, false
local blockedLineId, et, chatLines, chatPlayers = 0, 7, {}, {}
local btn, reportFrame
local function IsFriendly(name, flag, _, guid)
	if not guid then return true end -- LocalDefense automated prints
	if not guid:find("^Player") then -- Bad addons
		local msg = "BadBoy: Unexpected GUID requested by an addon: ".. guid
		print(msg)
		geterrorhandler()(msg)
		return true
	end
	local _, characterName = BNGetGameAccountInfoByGUID(guid)
	if characterName or IsGuildMember(guid) or IsFriend(guid) or UnitInRaid(name) or UnitInParty(name) or flag == "GM" or flag == "DEV" then
		return true
	end
end
local function Cleanse(msg)
	msg = gsub(msg, "|c[^%[]+%[([^%]]+)%]|h|r", "%1") -- Speed up processing messages with links by removing them
	msg = lower(msg) --Lower all text, remove capitals
	for k,v in next, repTbl do
		msg = gsub(msg, k, v)
	end
	return msg
end
local eventFunc = function(_, event, msg, player, _, _, _, flag, channelId, channelNum, _, _, lineId, guid)
	-- Re-enable chat bubbles if they were disabled in the previous event.
	if enableBubble then
		enableBubble = false
		SetCVar("chatBubbles", 1)
	end

	blockedLineId = 0
	if event == "CHAT_MSG_CHANNEL" and (channelId == 0 or type(channelId) ~= "number") then return end --Only scan official custom channels (gen/trade)

	local trimmedPlayer = Ambiguate(player, "none")
	if IsFriendly(trimmedPlayer, flag, nil, guid) then return end

	local debug = msg --Save original message format
	msg = Cleanse(msg)

	--20 line text buffer, this checks the current line, and blocks it if it's the same as one of the previous 20
	if event == "CHAT_MSG_CHANNEL" then
		local cleanestMsg = gsub(msg, "[@,./\\=]", "") -- Anything purposely not removed by Cleanse()
		for i=1, #chatLines do
			if chatLines[i] == cleanestMsg and chatPlayers[i] == guid then --If message same as one in previous 20 and from the same person...
				blockedLineId = lineId
				-- Reduce the chances of a spam report expiring (line id is too old) by refreshing it
				if spamCollector[guid] and S.is(msg) then
					local loc = PlayerLocation:CreateFromChatLineID(lineId)
					spamCollector[guid] = loc
					if BADBOY_OPTIONS.tipSpam then
						spamLogger[guid] = debug
					end
				elseif backupCollector[guid] and next(spamCollector) and S.is(msg) then
					local loc = PlayerLocation:CreateFromChatLineID(lineId)
					backupCollector[guid] = loc
				end
				--
				return
			end
			if i == 20 then tremove(chatLines, 1) tremove(chatPlayers, 1) end --Don't let the DB grow larger than 20
		end
		chatLines[#chatLines+1] = cleanestMsg
		chatPlayers[#chatPlayers+1] = guid
	end
	--End text buffer

	if S.is(msg) then
		if event == "CHAT_MSG_SAY" or event == "CHAT_MSG_YELL" then
			-- Awful way of disabling chat bubbles when spam is detected.
			-- Chat bubbles are processed internally by the game client AFTER all the addon event handlers are fired.
			if GetCVarBool("chatBubbles") then
				enableBubble = true
				SetCVar("chatBubbles", 0)
			end
		end
		if not BADBOY_OPTIONS.freqButton then
			for i = 1, #S[et] do
				if strfind(msg, S[et][i]) then
					blockedLineId = lineId
					return
				end
			end
		end
		if BadBoyLog then
			BadBoyLog("BadBoy", event, trimmedPlayer, debug)
		end
		if not BADBOY_BLACKLIST[guid] and not IsEncounterInProgress() then
			local loc = PlayerLocation:CreateFromChatLineID(lineId)
			spamCollector[guid] = loc
			if BADBOY_OPTIONS.tipSpam then
				spamLogger[guid] = debug
				if btn:IsShown() and reportFrame:IsMouseOver() then
					GameTooltip_Hide()
					reportFrame:GetScript("OnEnter")(reportFrame) -- Add more spam to tooltip if shown
				end
			end

			local t = GetTime()
			if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
				if prevShow == 0 then
					prevShow = t+25
					-- Delay the first one to grab more spam on really bad realms
					C_Timer.After(25, function() btn:Show() end)
				else
					prevShow = t
					btn:Show()
				end
			end
		end

		if BADBOY_BLACKLIST[guid] then
			-- We have already reported this person today. We won't show the button again, but add them to the backup table to report them
			-- again only if we click the button for other spam, to completely eliminate processing their chat, improving performance.
			local loc = PlayerLocation:CreateFromChatLineID(lineId)
			backupCollector[guid] = loc
		end

		blockedLineId = lineId
		return
	elseif next(spamCollector) then
		local t = GetTime()
		if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
			prevShow = t
			btn:Show()
		end
	end
end
local filterFunc = function(_, _, _, _, _, _, _, _, _, _, _, _, lineId)
	if blockedLineId == lineId then
		return true
	end
end

do
	btn = CreateFrame("Frame", nil, ChatFrame1)
	btn:SetWidth(50)
	btn:SetHeight(50)
	btn:SetPoint("BOTTOMRIGHT", 18, -20)
	btn:SetFrameStrata("DIALOG")
	local tx = btn:CreateTexture()
	tx:SetAllPoints(btn)
	tx:SetMask("Interface\\CharacterFrame\\TempPortraitAlphaMask")
	tx:SetTexture(132360) -- Interface/Icons/Ability_Warrior_ShieldMastery
	local animGroup = btn:CreateAnimationGroup()
	animGroup:SetLooping("REPEAT")
	local scale = animGroup:CreateAnimation("Scale")
	scale:SetOrder(1)
	scale:SetFromScale(0.25,0.25)
	scale:SetToScale(1,1)
	scale:SetDuration(0.4)
	local scale2 = animGroup:CreateAnimation("Scale")
	scale2:SetOrder(2)
	scale2:SetFromScale(1,1)
	scale2:SetToScale(0.25,0.25)
	scale2:SetDuration(0.4)
	scale2:SetEndDelay(8)
	animGroup:Play()
	btn:Hide()

	reportFrame = CreateFrame("Button", nil, btn)
	reportFrame:SetAllPoints(ChatFrame1)
	reportFrame:SetFrameStrata("DIALOG")
	local ticker = nil
	local tickerFunc = function()
		local canReport = false
		for k, v in next, spamCollector do
			if CanReportPlayer(v) then
				canReport = true
			else
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		end
		for k, v in next, backupCollector do
			if not CanReportPlayer(v) then
				backupCollector[k] = nil
			end
		end
		if not canReport then
			btn:Hide()
		end
	end
	btn:SetScript("OnShow", function()
		if ticker then ticker:Cancel() end
		ticker = C_Timer.NewTicker(5, tickerFunc)
		tickerFunc()
		-- Don't animate if the feature is disabled
		if animGroup:IsPlaying() and BADBOY_OPTIONS.noAnim then
			btn:SetWidth(12)
			btn:SetHeight(12)
			animGroup:Stop()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 0, -5)
		elseif not animGroup:IsPlaying() and not BADBOY_OPTIONS.noAnim then
			btn:SetWidth(46)
			btn:SetHeight(46)
			animGroup:Play()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 18, -20)
		end
	end)
	btn:SetScript("OnHide", function()
		if ticker then
			ticker:Cancel()
			ticker = nil
		end
	end)
	reportFrame:SetScript("OnClick", function(self, btn)
		if IsAltKeyDown() then -- Dismiss
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()
			for k in next, spamCollector do
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		else -- Report
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()

			local systemMsg = {GetFramesRegisteredForEvent("REPORT_PLAYER_RESULT")} -- Don't show the "Complaint Registered" message
			local calendarError = {GetFramesRegisteredForEvent("CALENDAR_UPDATE_ERROR")} -- Remove calendar error popup (Blizz bug)
			for i = 1, #systemMsg do
				systemMsg[i]:UnregisterEvent("REPORT_PLAYER_RESULT")
			end
			for i = 1, #calendarError do
				calendarError[i]:UnregisterEvent("CALENDAR_UPDATE_ERROR")
			end

			for k, v in next, spamCollector do
				if CanReportPlayer(v) then
					BADBOY_BLACKLIST[k] = true
					ReportPlayer("spam", v, "Reported by the BadBoy addon. If this seems wrong, tell the author @funkbw on Twitter.")
				end
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
			for k, v in next, backupCollector do
				if CanReportPlayer(v) then
					ReportPlayer("spam", v, "Reported by the BadBoy addon. If this seems wrong, tell the author @funkbw on Twitter.")
				end
				backupCollector[k] = nil
			end

			for i = 1, #systemMsg do
				systemMsg[i]:RegisterEvent("REPORT_PLAYER_RESULT")
			end
			for i = 1, #calendarError do
				-- There's a delay before the event fires
				C_Timer.After(5, function() calendarError[i]:RegisterEvent("CALENDAR_UPDATE_ERROR") end)
			end
		end
	end)
	reportFrame:SetScript("OnEnter", function(self)
		GameTooltip:SetOwner(self, "ANCHOR_CURSOR")
		GameTooltip:AddLine(S.spamBlocked, 1, 1, 1)
		GameTooltip:AddLine(S.clickToReport, 1, 1, 1)
		if next(spamLogger) then
			GameTooltip:AddLine(" ", 0.5, 0.5, 1)
			for k, v in next, spamLogger do
				GameTooltip:AddLine(v, 0.2, 1, 0)
			end
		end
		GameTooltip:Show()
	end)
	reportFrame:SetScript("OnLeave", GameTooltip_Hide)
end

--[[ Add Filters ]]--
do
	local f = CreateFrame("Frame")
	f:SetScript("OnEvent", eventFunc)
	local tbl = {
		"CHAT_MSG_CHANNEL",
		"CHAT_MSG_YELL",
		"CHAT_MSG_SAY",
		"CHAT_MSG_WHISPER",
		"CHAT_MSG_EMOTE",
		"CHAT_MSG_DND",
		"CHAT_MSG_AFK",
	}
	for i = 1, #tbl do
		local event = tbl[i]
		local frames = {GetFramesRegisteredForEvent(event)}
		f:RegisterEvent(event)
		ChatFrame_AddMessageEventFilter(event, filterFunc)
		for i = 1, #frames do
			local frame = frames[i]
			frame:UnregisterEvent(event)
			frame:RegisterEvent(event)
		end
	end
end

--[[ Blacklist ]]--
do
	local f = CreateFrame("Frame")
	f:RegisterEvent("ADDON_LOADED")
	f:RegisterEvent("PLAYER_LOGIN")
	f:SetScript("OnEvent", function(frame, event, addon)
		if addon == "BadBoy" then
			if type(BADBOY_OPTIONS) ~= "table" then BADBOY_OPTIONS = {} end
			if type(BADBOY_BLACKLIST) ~= "table" then BADBOY_BLACKLIST = {} end
			frame:UnregisterEvent(event)
		elseif event == "PLAYER_LOGIN" then
			-- Blacklist DB setup, needed since Blizz nerfed ReportPlayer so hard the block sometimes only lasts a few minutes.
			local dateTbl = C_DateAndTime.GetCurrentCalendarTime()
			local day = dateTbl.monthDay
			if BADBOY_BLACKLIST.dayFromCal ~= day then
				BADBOY_BLACKLIST = {dayFromCal = day} -- Can't use ADDON_LOADED as date function isn't always ready on very first login.
			end
			SetCVar("spamFilter", 1)
			frame:UnregisterEvent(event)
			BADBOY_OPTIONS.tmp = nil
			BADBOY_OPTIONS.tmpm = nil
			BADBOY_OPTIONS.tmpl = nil
			BADBOY_OPTIONS.freqButton = nil

			-- Chat bubble restore
			frame:SetScript("OnEvent", function()
				if enableBubble then
					enableBubble = false
					SetCVar("chatBubbles", 1)
				end
			end)
			-- Hopefully we never end up in a situation where we've permanently disabled chat bubbles for the user.
			frame:RegisterEvent("PLAYER_LOGOUT")
			frame:RegisterEvent("CHAT_MSG_MONSTER_SAY")
			frame:RegisterEvent("CHAT_MSG_MONSTER_YELL")
		end
	end)
end

_G.BadBoyIsFriendly = IsFriendly
_G.BadBoyCleanse = Cleanse
