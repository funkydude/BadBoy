
-- GLOBALS: BADBOY_BLACKLIST, BADBOY_OPTIONS, BadBoyLog, ChatFrame1, GetTime, print, CalendarGetDate
-- GLOBALS: GameTooltip, C_Timer, IsEncounterInProgress, GameTooltip_Hide
local _, S = ...
S.gnt(262,"204,223,202,207,200,213,206,208,213,206,217,218,206,214,211,203^222,219,194,201,218,196,222,214,222,206,214,211,203,149,145,217,218,202,214,208,213,219,166,218^197,201,220,224,208,213,206,202,207,204,200,215,202,218,206,214,218,210,208,213^197,222,219,194,201,218,196,201,200,211,200,213,202,204,215,200,224,215,200,211,201,224,206,214,211,203^217,220,213,204,218,202,200,215,204,206,214,211,203,205,214,217,222,214,222,206,214,211,203^197,222,219,194,201,218,219,196,202,218,218,210,208,213,218^222,219,194,201,218,196,217,220,213,204,218,202,200,215,204,206,214,211,203^197,206,214,219,218,214,212,204,217,218,151,158,150,166,217,166,218,166,154,166,206,214,211,203,211,200,224,208,213,206,200,217,214,220,213,203,149,145,212,204^203,214,220,201,211,204,149,145,219,217,208,215,215,166,211,204,149,145,202,200,218,208,213,214^222,219,194,201,218,196,217,220,213,204,218,202,200,215,204,200,202,202,214,220,213,219^201,204,219,149,145,217,214,211,211,149,145,223,153,149,145,223,154,149,145,212,208,213,149,145,212,200,223^197,222,219,194,201,218,196,140,203,146,212,214,213,219,207,149,145,206,200,212,204,219,208,212,204^222,200,213,219,219,214,218,204,211,211,194,150,195,196,201,220,224,202,218,206,214,208,219,204,212^217,214,211,211,149,145,222,208,213,149,145,203,214,220,201,211,204,149,145,212,208,213,149,145,212,200,223^202,200,218,208,213,214,149,145,140,203,146,223,153,149,145,140,203,146,223,154^222,219,194,201,218,196,149,145,217,220,213,204,218,202,200,215,204,212,214,213,204,224,149,145,140,203,146,210^197,222,219,218,140,203,146,203,200,224,218,166,206,200,212,204,202,200,217,203^197,222,219,194,201,218,196,217,218,200,202,202,214,220,213,219^197,218,204,211,211,208,213,206,202,218,206,214,208,219,204,212^197,201,220,224,208,213,206,217,218,154,218,219,220,205,205^211,220,202,210,149,145,217,214,211,211,149,145,140,203,146,210,149,145,212,208,213,220,219,204,218,149,145,215,218,219^217,214,211,211,149,145,140,203,146,149,145,217,214,211,211,149,145,140,203,146,149,145,201,204,219^197,222,219,194,201,218,196,140,203,146,203,200,224,149,145,206,200,212,204,202,200,217,203^197,222,219,194,201,218,196,206,200,212,204,202,200,217,203^197,222,219,194,201,218,219,196,202,218,206,214,202,207,204,200,215^197,222,219,194,201,218,219,196,202,218,206,214,202,200,218,204^197,222,219,194,201,218,219,196,202,218,206,214,210,213,208,194,205,221,196,204^202,200,218,208,213,214,149,145,140,203,146,149,145,203,214,220,201,211,204,149,145,140,203,146,149,145,219,217,208,215,215,166,211,204^222,219,194,201,218,196,222,214,222,206,214,211,203,149,145,217,218,206,214,211,203^206,200,212,201,211,204,149,145,217,214,211,211,149,145,223,153,149,145,217,214,211,211,149,145,223,156^206,214,211,203,149,145,219,217,208,215,215,166,211,204,149,145,202,200,218,208,213,214^197,222,219,194,201,218,219,196,202,207,204,200,215,202,218,206,214,218,210,208,213^197,218,204,211,211,208,213,206,206,214,211,203,218,166,205,214,217,202,218,206,214^197,222,219,194,201,218,196,200,166,213,166,200,222,204,218,214,212,204,217,218,200,202,202,214,220,213,219^197,222,219,201,140,203,146,212,151,158,206,215^222,219,218,222,214,222,200,202,202,214,220,213,219,149,145,204,215,208,202^197,222,219,194,201,218,219,196,202,218,206,214,218,219,204,200,212,206,208,205,219^222,214,222,206,214,211,203,205,214,217,202,218,206,214,210,204,224^197,222,219,201,214,218,217,218,206,215^202,218,206,214,218,210,208,213,218,149,145,206,214,211,203,149,145,218,207,214,215,149,145,212,214,220,213,219,218^197,219,217,200,203,208,213,206,202,218,206,214,149,145,206,214,211,203^197,222,219,194,201,218,219,196,218,214,212,204,202,218,206,214,218,210,208,213^197,222,219,218,202,207,204,200,215,200,213,203,205,200,218,219,206,214,211,203^197,222,219,194,201,218,219,196,202,218,206,214,210,204,224^211,220,202,210,149,145,217,214,211,211,149,145,203,214,220,201,211,204,149,145,206,214,211,203^203,208,202,204,149,145,223,153,149,145,223,154,149,145,201,204,219,218^202,200,218,208,213,214,149,145,222,207,208,218,215,204,217,149,145,208,213,205,214^197,218,204,211,211,208,213,206,202,218,206,214,202,200,218,204^197,201,220,224,208,213,206,202,218,206,214,210,213,208,194,205,221,196,204^222,219,194,201,218,196,217,220,213,204,218,202,200,215,204,215,220,217,204^197,222,219,219,222,214,222,206,214,211,203,205,214,217,214,211,203,218,202,207,214,214,211,217,218,206,214,211,203^219,217,200,203,208,213,206,212,224,222,214,217,211,203,214,205,222,200,217,202,217,200,205,219,206,214,211,203,205,214,217,149,145,217,220,213,204,218,202,200,215,204,206,214,211,203^197,222,219,218,202,207,204,200,215,206,214,211,203^217,214,220,211,204,219,219,204,149,145,217,214,211,211,149,145,153,223,149,145,154,223^197,222,219,194,201,218,196,206,200,212,204,219,208,212,204^197,222,219,218,140,203,146,203,200,224,218,166,206,200,212,204,219,208,212,204^197,219,217,200,203,208,213,206,222,214,222,206,214,211,203,205,214,217,214,166,218,166,217,218,206,214,211,203^197,222,219,194,218,219,196,222,214,222,200,202,202,214,220,213,219^140,203,146,149,145,203,194,214,220,196,194,220,201,196,201,211,204,149,145,140,203,146,149,145,219,217,208,215^197,222,219,194,201,218,196,206,200,212,204,202,214,203,204^197,222,219,194,201,218,196,206,214,218,210,208,213,218^197,222,219,194,201,218,219,196,202,218,206,214,202,200,212,214^197,218,204,211,211,208,213,206,202,218,206,214,218,210,208,213^202,200,218,208,213,214,149,145,217,214,211,211,149,145,140,203,146,149,145,217,214,211,211,149,145,140,203,146^202,200,218,208,213,214,149,145,150,222,149,145,140,203,146,149,145,217,214,211,211^201,220,224,208,213,206,166,217,220,213,204,218,202,200,215,204,194,200,206,196^197,222,219,194,201,218,219,196,211,204,206,208,214,213,202,166,203,166,210,204,224^197,206,214,219,200,213,224,217,218,151,166,154,150,217,218,151,166,158,206,214,211,203,211,200,224,208,213,206,200,217,214,220,213,203,149,145,206,214,214,203,214,205,205,204,217^197,206,214,219,200,213,224,217,220,213,204,218,202,200,215,204,206,214,211,203,150,222,212,204^202,200,218,208,213,214,149,145,211,204,206,208,219,149,145,218,200,205,204,149,145,202,200,218,208,213,214^197,222,219,219,222,214,222,206,205,214,217,217,218,151,158,206^197,222,219,194,201,218,196,215,217,204,215,200,208,203,206,200,212,204,202,200,217,203^197,222,219,194,201,218,219,196,212,224,206,214,211,203,205,214,217,202,218,206,214,218,210,208,213^197,222,219,194,201,218,219,196,202,218,140,149,166,206,214,218,210,208,213^197,222,219,218,140,203,146,210,205,214,217,140,203,146,204,220^197,222,219,194,201,218,219,196,217,218,151,158,206,214,211,203^197,222,219,219,222,214,222,206,205,214,217,214,218,217,218,206^197,222,219,194,201,218,219,196,202,218,206,214,200,202,202^197,222,219,194,218,219,196,200,202,202,214,220,213,219,222,208,219,207^217,214,211,211,149,145,206,200,212,204,149,145,206,214,211,203,149,145,222,208,213,149,145,211,214,222,204,217^197,222,219,194,201,218,219,196,202,218,206,214,202,203,210,204,204,166,224^222,200,213,219,219,214,201,220,224,194,150,195,196,218,204,211,211,202,218,206,214,208,219,204,212^197,222,219,194,201,218,219,196,202,218,206,214,208,219,204,212^197,222,219,201,217,218,206,215,139^197,222,219,194,201,218,196,140,203,146,217,218,200,202,202,214,220,213,219^222,219,194,201,218,219,196,217,218,154,166,206,214,211,203,149,145,222,214,222,206,214,211,203^203,194,214,220,196,194,220,201,196,201,211,204,149,145,140,203,146,149,145,219,217,208,215,215,166,211,204^197,222,219,219,222,214,222,206,214,211,203,205,214,217,214,218,217,218^202,200,218,208,213,214,149,145,203,208,202,204,149,145,140,203,146,149,145,219,217,208,215,211,204^197,222,219,194,201,218,219,196,212,224,222,214,222,206,214,211,203,149,145,202,218,206,214,218,210,208,213^202,200,218,208,213,214,149,145,217,214,211,211,149,145,203,214,220,201,211,204^197,222,219,194,201,218,219,196,210,204,224,218,208,213,202,218,206,214^202,200,218,208,213,214,149,145,201,204,219,149,145,140,203,146^197,201,220,224,208,213,206,202,218,140,149,166,206,194,151,214,196,218,210,208,213^197,222,219,194,201,218,196,194,154,157,196,151,203,200,224,218,166,215,217,204,215,200,208,203,206,200,212,204,219,208,212,204^197,218,204,211,211,208,213,206,218,214,212,204,202,218,206,214,202,200,218,204^197,222,219,194,201,218,219,196,200,213,224,202,218,206,214,218,210,208,213^197,222,219,201,206,214,211,203,149,145,206,200,212,204,219,208,212,204^197,222,219,194,201,218,219,196,206,214,211,203,205,214,217,202,218,206,214^206,214,211,203,205,214,217,217,220,213,204,218,202,200,215,204,206,214,211,203^197,201,220,224,208,213,206,214,218,217,218,206,214,211,203,222,208,219,207,222,214,222,206,214,211,203^197,222,219,201,206,214,211,203,149,145,212,214,220,213,219^197,201,220,224,208,213,206,202,218,206,214,210,204,224^217,214,211,211,206,200,212,201,211,204,149,145,140,203,146,149,145,211,214,218,204,140,203,146,149,145,222,208,213,149,145,140,203,146^197,222,219,194,201,218,196,215,217,204,215,200,208,203,202,200,217,203^197,222,219,194,218,201,219,196,222,214,222,206,214,211,203,205,214,217,202,218,206,214,218,210,208,213","223,220,219,221,212,204,209,218,214,215,218,213,201,212,150,146,208,205,218,215,209,203,150,146,213,225,220,208,209,203,204,221,214,207,205,215,214,219,202,215,215,219,220,150,146,160,153,152,150,146,213,204,221,214,207,205,215,214,219^198,219,201,212,210,205,218,222,209,201,219,223,209,219,208^198,207,221,212,204,206,209,214,214,219,202,209,212,212,209,207,220,168,219,223,209,219,208^206,201,219,220,156,207,215,212,204,195,141,150,148,197,203,215,213,150,146,219,215,220,203,211^216,205,223,216,205,223,219,208,215,216,141,150,216,218,215,150,146,213,225,220,208,209,203^209,207,206,201,214,219,150,146,219,220,215,203,211,150,146,204,205,212,209,222,205,218^223,220,219,207,208,221,221,214,208,205,218,215,209,203,150,146,221,212,204,209,218,213,225,220,208,209,203,150,146,208,205,218,215,209,203,223,209,220,208,216,205,218,219,215,214,201,212,212,215,215,220,150,146,213,204,221,214,207,205,215,214,219,215,214,201,214,225,212,205,222,205,212,223,209,220,208,212,215,215,220^198,202,205,208,215,222,205,218,204,221,207,168,219,223,209,219,208^219,299,270,212,207,205,218,207,215,212,204,215,222,205,218,213,216,150,146,141,204,147,211^198,207,206,209,214,214,219,219,223,209,219,208,140^335,246,280,333,260,272,334,260,241,333,259,266,337,265,286,335,290,271,333,241,279,334,260,276,336,243,281,337,259,236,150,146,333,237,272,337,232,258,334,253,267,333,245,254,334,291,265,335,290,271,333,245,283,333,247,279,333,247,279,336,290,290,333,280,288,150,146,333,247,270,334,260,241,333,247,282,336,279,255,153,153,152,334,276,266,336,295,246,333,250,272,336,279,266^204,209,219,203,215,218,204,220,202,153,195,153,152,197,152,152^222,332,295,265,150,146,153,157,152,157,155,160,153,161,152,159^214,215,221,219,219,215,213,213,205,219,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,215,152,197,213^198,202,215,215,219,220,209,214,207,213,225,220,208,209,203,150,146,204,221,214,207,205,215,214,219,201,214,204,218,201,209,204,219,150,146,218,201,218,205,213,215,221,214,220,219,150,146,216,222,216,208,205,212,216^198,223,220,219,221,212,204,209,218,214,213,151,208,203,151,213,225,220,208,209,219,203,208,150,146,154,153,152,213,225,220,208,209,219,203,208,205,222,205,218,212,209,205,219,205,150,146,221,212,204,209,218,208,203,206,221,212,212,207,205,201,218^223,220,219,153,152,153,157,213,225,220,208,209,203,211,205,225,221,212,204,209,218,206,221,212,212,150,146,203,215,213,205,207,205,220,201,212,212,155,141,204,141,204,150,146,207,205,201,218,202,205,219,220,216,218,209,203,205^333,294,278,332,295,265,226,226,223,220,155,155,155^198,219,201,212,210,205,218,141,204,147,211,150,146,219,223,209,219,208^198,223,220,219,216,215,223,205,218,212,205,167,222,205,167,212,209,214,207,150,146,201,218,220,209,206,201,203,220^202,205,219,220,205,214,150,146,219,211,225,216,205,150,146,219,201,218,213,201,205,212,150,146,203,215,201,203,208,209,214,207^219,209,220,205,208,205,212,216,223,215,223,141,150,213,205^202,205,219,221,203,208,205,214,150,146,223,215,223,222,205,214,204,215,218,141,150,203,215,213^222,209,219,209,220,150,146,223,215,223,202,215,216,141,150,203,215,213^312,287,215,312,291,215,220,215,150,146,206,221,214,213,213,215,141,150,218,221^198,201,202,220,336,243,281,337,259,236,333,244,237,333,259,266,150,146,203,215,207,333,287,269,332,293,260,333,278,268^217,157,156,161,161,158,157,160,155,160^205,216,203,201,218,218,209,205,219,150,146,219,211,225,216,205^335,239,235,335,235,271,335,246,243,333,290,271,150,146,333,237,272,337,232,258,332,291,287,334,264,292,332,293,246,333,291,241,150,146,334,276,266,336,295,246,334,254,280,335,246,273,333,278,286,333,259,262,333,293,250,150,146,202,215,219,219^332,288,274,332,290,290,333,251,233,334,288,267,333,277,248,150,146,216,218,215,206,215,221,214,204,219,205,201^198,333,294,278,335,276,249,148,337,234,278,332,291,286,208,335,246,243,333,290,271,153,333,241,245,153,208,153,153,334,253,267,207,337,232,263,334,261,269,213,213,334,261,269,140^220,209,212,202,221,204,150,146,219,299,270,212,207,205,218,141,204,147,211,150,146,213,215,202,209,212,205,216,201,225^332,295,265,212,215,222,205,202,201,202,225,154,155,156^198,219,299,270,212,207,205,218,207,223,208,209,219,216,205,218,140^198,207,221,212,204,219,201,212,210,205,219,202,209,212,212,209,207,220,150,146,219,223,209,219,208^198,223,220,195,202,219,197,207,221,212,204,219,223,209,219,208,140^216,205,214,207,201,218,206,209,214,214,219,222,209,201,219,223,209,219,208^198,219,201,212,210,205,218,207,151,223,213,205,140^332,288,245,333,292,290,333,240,286,334,286,240,336,284,289,148,332,288,245,334,252,286,334,242,292,337,239,249,148,332,288,232,333,279,289,332,288,232,336,284,284,333,295,235,334,260,245,333,242,265,334,261,269,337,260,232,333,269,255,336,267,237,337,269,280,333,251,233,333,260,267,335,241,273,334,253,267,332,291,286,333,247,270,334,260,241,333,247,282,336,279,255,153,153,152,332,294,259,337,232,241,334,243,273,148,333,279,238,334,240,249,336,295,259,333,259,266^223,220,219,150,146,223,209,220,208,213,212,150,146,208,209,207,208,217,221,201,212,209,220,225,150,146,202,209,207,204,209,219,203,215,221,214,220^216,222,216,150,146,209,215,223,150,146,215,211,156,207,215,212,204^206,221,212,212,203,212,205,201,218,150,146,207,205,220,202,209,219,207,205,201,218,150,146,209,214,206,205,218,214,201,212,150,146,214,215,223,150,146,213,215,218,205,209,214,206,215^223,220,219,219,213,215,215,220,208,221,212,204,209,218,150,146,214,215,218,205,217,221,209,218,205,213,205,214,220,219,150,146,207,205,220,155,141,204,141,204,155,141,204,141,204,209,212,222,212,209,220,205,213,219,150,146,220,209,220,212,205,150,146,207,205,201,218,209,214,207,215,206,206,205,218^219,211,225,216,205,150,146,210,221,219,220,209,214,141,150,216,212,201,203,215,219^216,222,216,150,146,223,201,212,212,207,201,213,209,214,207,195,141,150,148,197,203,215,213^204,205,201,212,150,146,221,212,204,209,218,218,221,214,219,150,146,204,221,214,207,205,215,214,219,218,221,214,219,150,146,220,218,201,204,205,212,215,215,220,201,222,201,209,212,150,146,219,213,215,215,220,208,207,221,209,212,204,218,221,214^222,209,219,209,220,150,146,219,209,213,216,212,205,203,201,218,218,225,141,150,203,215,213^219,299,270,212,207,205,218,207,150,146,141,204,147,211,218,167,216,218^215,221,218,220,205,201,213,150,146,208,205,212,216,225,215,221,150,146,207,205,220,225,215,221,218,150,146,220,215,204,201,225,150,146,207,205,220,219,220,201,218,220,205,204^222,209,219,209,220,150,146,213,213,195,215,152,197,212,222,212,204,195,215,152,197,220,203,195,215,152,197,213^223,220,219,150,146,212,215,215,220,218,201,209,204,150,146,207,212,215,218,225,150,146,213,215,221,214,220,219,150,146,213,215,218,205,209,214,206,215^332,295,265,155,161,154,153,154,155,152,157,155^335,246,243,333,290,271,336,243,281,337,259,236,333,250,244,213,337,258,294,333,290,270,336,267,237,333,268,239,333,244,237,333,259,266,333,250,244,333,245,253,332,289,280,150,146,334,240,256,337,273,276,335,277,241,148,337,234,274,334,280,252,337,262,245,333,290,271,148,337,291,249,333,288,234,220,155,333,250,244,333,261,248,337,274,249,148,333,268,271,335,281,283,332,293,246,332,295,261^198,219,201,212,210,205,218,223,215,223,207,221,212,204,150,146,219,223,209,219,208^198,222,209,212,212,214,201,207,215,214,211,215,216,201,207,221,212,204,150,146,219,201,212,210,205,218,221,167,220,167,213,209,220,220,202,209,212,212,209,207,220^203,220,201,220,312,288,211,150,146,203,211,201,312,289,312,295,150,146,216,222,205,220,215,216^198,333,237,272,334,254,280,336,295,259,333,290,270,151,336,243,281,337,259,236,335,246,243,333,290,271,333,237,272,337,232,258,336,295,259,335,291,236,333,280,281,333,292,232,334,241,251,334,261,269,333,248,236,335,271,245,336,232,233,334,261,295,334,260,276,334,260,245,333,247,282,336,279,255,153,153,152,335,246,280,333,260,272,333,292,232,334,241,251,148,333,237,272,335,283,291,334,255,264,335,275,262,332,290,241,334,276,266,336,295,246,333,248,236,332,293,245,336,232,233,334,261,295,334,254,280,333,289,284,333,295,275,332,289,248,140^198,207,221,212,204,219,299,270,212,167,207,205,219,150,146,223,206,215,218,213,205,218,205,209,214,206,215^222,209,219,209,220,150,146,205,216,141,150,167,209,203,203,201,218,218,225,141,150,203,215,213^223,220,219,221,212,204,209,218,218,221,214,219,150,146,209,220,205,213,219,216,205,218,218,221,214,150,146,204,215,214,205,202,225,205,224,216,205,218,209,205,214,203,205,204,150,146,213,221,212,220,209,216,212,205,220,209,213,205,219,201,204,201,225^204,209,219,203,215,218,204,213,225,220,208,209,203,157,156,156,160^198,219,201,212,210,205,218,207,221,212,204,219,214,201,202,202,220,222,209,201,219,223,209,219,208^219,299,270,212,207,205,218,207,221,212,204,222,209,201,213,216^198,219,201,212,210,205,218,207,221,212,204,150,146,141,204,147,211,218,206,215,218,141,204,147,211,150,146,219,223,209,219,208^223,220,219,221,212,204,209,218,150,146,206,201,219,220,201,214,204,219,213,215,215,220,208,150,146,207,221,201,218,201,214,220,205,205,150,146,219,205,218,222,209,203,205^207,215,212,204,150,146,219,299,270,212,207,205,218,210,205,207,141,204,141,204,147,211,150,146,223,208,209,219,216,205,218^202,209,212,212,209,207,201,219,220,205,207,221,212,204,150,146,141,204,147,211,150,146,213,201,214,207,204,218,201,202,201,220,220^223,220,219,213,225,220,208,209,203,204,221,214,207,205,215,214,219,154,153,152,212,222,212,150,146,209,220,205,213,219,205,220,202,215,215,219,220,150,146,221,212,204,209,218,150,146,213,225,220,208,209,203^217,159,154,156,154,154,155,156,156,160^223,220,219,222,209,203,209,215,221,219,150,146,215,220,208,205,218,216,222,216,213,215,221,214,220,219,150,146,203,201,218,218,209,205,204,150,146,219,211,209,212,212,150,146,219,205,212,206,216,212,201,225^333,294,278,332,295,265,150,146,153,160,158,161,154,154,152,160,159,156,157^198,141,204,147,211,206,209,214,214,219,150,146,168,219,223,209,219,208^198,219,205,212,212,209,214,207,221,212,204,209,218,160,151,160,202,215,219,219,211,209,212,212,219,202,215,215,219,220,219,205,218,222,209,203,205,150,146,201,212,212,220,208,205,212,215,215,220,219,150,146,207,221,201,218,201,214,220,205,205^207,215,212,204,150,146,207,195,215,152,197,212,204,203,205,195,215,152,197,195,141,150,148,197,203,195,215,152,197,213^206,221,212,212,203,212,205,201,218,150,146,202,195,215,152,197,195,215,152,197,219,220,150,146,207,205,220,202,209,219,207,205,201,218,150,146,208,205,212,212,206,209,218,205,209,214,206,205,218,214,201,212,150,146,213,215,218,205,209,214,206,215^332,295,265,333,247,287,153,157,155,152,160,156,155,157,158,153,153^198,195,222,223,197,209,212,212,214,201,207,215,214,211,215,216,195,201,219,197,207,221,212,204,150,146,219,223,209,219,208^223,220,219,213,205,203,208,201,207,215,208,221,212,213,211,154,150,146,333,261,248,337,274,249,332,289,261,332,289,261,150,146,337,239,249,335,266,271,333,245,233,332,288,239,332,288,235,333,245,233,150,146,153,141,204,152,150,146,153,154,152,150,146,155,141,204,152^217,217,150,146,153,152,152,160,156,157,161,161,157^333,294,278,332,295,265,205,225,205,219,212,215,220^220,205,212,205,207,218,201,213,150,146,201,213,209,218,201,214,207,201,213,209,214,207^198,207,219,201,212,210,219,202,209,212,212,209,207,220,150,146,219,223,209,219,208^198,206,209,214,214,219,219,216,205,212,222,201,212,221,220,201,150,146,220,201,218,219,223,209,219,208,150,146,223,213,209,207^223,220,219,150,146,219,211,225,216,205,150,146,202,215,215,219,220,209,214,207,208,205,212,216^217,217,150,146,160,156,159,156,158,157,154,160,158^222,209,219,209,220,223,215,223,222,205,214,204,215,218,141,150,195,214,203,215,197,195,205,215,218,197,195,220,213,207,197^223,220,219,221,212,204,209,218,215,214,201,214,225,204,209,206,206,209,203,221,212,220,225,150,146,206,201,219,220,216,215,223,205,218,212,205,167,222,205,167,212,212,209,214,207,150,146,213,204,221,214,207,205,215,214,219^333,294,278,332,295,265,150,146,157,161,155,160,155,159,152,155,153^198,202,209,212,212,209,207,220,207,221,212,204,206,209,214,214,219,209,214,214,205,140^207,221,212,204,150,146,219,211,225,216,205,150,146,212,205,222,205,218,201,214,219^198,211,215,216,205,218,207,221,212,204,206,215,218,216,205,214,207,201,218^198,223,220,219,221,212,204,209,218,214,215,218,213,201,212,151,208,205,218,215,209,203,148,213,225,220,208,209,203,204,221,214,207,205,215,214,219,154,153,152,212,222,212,140^204,209,219,203,215,218,204,150,146,213,201,212,216,215,215,219,154,154,160,156^333,252,278,333,294,278,150,146,160,161,156,157,160,152,154,155,153^198,219,215,211,205,218,207,222,209,201,219,223,209,219,208^202,215,215,219,220,150,146,205,224,220,218,205,213,205,212,225,150,146,206,201,219,220,150,146,153,152,152,153,153,152^221,212,204,209,218,150,146,207,205,220,201,212,212,155,141,204,141,204,212,215,215,220,150,146,223,205,201,218,205,218,205,201,204,225,220,215,219,220,201,218,220,214,215,223,150,146,202,205,219,220,216,218,209,203,205^206,221,212,212,203,212,205,201,218,221,212,204,209,218,150,146,207,205,220,225,215,221,218,201,212,212,141,204,141,204,141,204,141,204,147,212,215,215,220,150,146,203,221,220,220,209,214,207,150,146,223,205,205,211,212,225,150,146,202,205,219,220,216,218,209,203,205^216,218,215,204,221,203,220,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,215,152,197,213^333,268,271,335,281,283,154,153,152,334,255,264,337,257,248,333,240,287,150,146,155,159,157,156,152,152,334,277,270,333,257,272,337,269,280,333,251,233,334,240,250,334,244,239^223,220,219,221,212,204,209,218,150,146,206,221,212,212,218,221,214,219,150,146,213,221,212,220,209,216,212,205,220,209,213,205,219,201,204,201,225,150,146,216,209,203,211,220,208,205,213,215,219,220,203,215,214,222,205,214,209,205,214,220,150,146,210,215,209,214,221,219^208,205,218,205,213,213,195,152,215,197,212,222,212,195,141,150,148,197,167,203,195,152,215,197,213^217,217,150,146,154,160,157,153,159,155,153,160,160,159^219,299,270,212,207,205,218,207,221,212,204,150,146,219,211,225,216,205^198,216,207,216,333,287,269,332,293,260,333,278,268,332,293,246,332,295,261^198,213,201,218,209,214,201,333,260,267,333,237,241,333,238,259^202,209,212,212,209,207,220,207,221,212,204,150,146,141,204,147,211,150,146,219,223,209,219,208^198,219,201,212,210,205,218,207,221,212,204,148,219,223,209,219,208^198,219,201,195,212,209,197,210,205,218,207,222,209,201,219,223,209,219,208^215,212,215,212,215,216,205,223,157,156,156,160^219,299,270,212,207,205,218,212,209,204,220,207,221,212,204,150,146,213,215,202,209,212,205,216,201,225^203,215,214,220,201,203,220,150,146,220,209,220,201,214,209,221,213,202,201,225^333,247,287,337,261,266,333,241,245,336,243,281,337,259,236,335,239,235,333,290,271,153,153,153,337,273,276,332,288,242,333,292,232,334,241,251,334,291,265,335,290,271,333,245,283,333,247,279,332,288,245,334,252,286,334,242,292,334,280,288,332,289,237,334,242,285,333,287,278,333,239,290,332,288,232,332,291,286,334,243,245,332,288,232,332,291,286,333,279,238,334,240,249,336,295,259,333,259,266^222,209,219,209,220,223,215,223,220,205,201,213,141,150,214,205,220^219,211,225,216,205,150,146,214,209,207,208,220,206,209,218,205,223,215,223,150,146,207,215,215,204^220,209,220,201,214,209,221,213,202,201,225,150,146,207,218,201,220,209,219^198,206,209,214,214,219,141,204,141,204,147,211,148,141,204,141,204,147,211,218,222,209,201,219,223,209,219,208^204,209,219,203,215,218,204,202,201,218,219,201,218,204,153,159,157,160^219,205,212,212,209,214,207,150,146,205,212,209,220,209,219,220,207,201,213,209,214,207,195,141,150,148,197,203,215,213^219,211,225,216,205,150,146,207,205,214,225,141,150,211,154^211,215,202,215,212,204,150,146,219,216,218,226,205,204,201,210,211,215,214,220,215,195,141,150,148,197,216,212^223,220,219,221,212,204,209,218,208,203,150,146,207,221,201,218,201,214,220,205,205,204,212,215,215,220,150,146,209,220,205,213,209,214,223,205,205,211,212,225,203,208,205,219,220^219,211,225,216,205,150,146,213,201,226,205,223,215,223^198,219,299,270,212,207,205,218,207,221,212,204,150,146,219,211,218,209,222,220,209,212,213,209,207^198,219,201,212,210,205,218,207,221,212,204,150,146,202,205,208,215,222,201,214,204,205^333,247,287,337,261,266,333,241,245,148,336,243,281,337,259,236,148,335,239,235,335,235,271,335,246,243,333,290,271,153,153,153,333,237,272,337,232,258,150,146,334,261,269,337,260,232,333,269,255,336,267,237,337,269,280,333,251,233,333,260,267,335,241,273,148,333,279,238,334,240,249,336,295,259,333,259,266^223,220,219,221,212,204,209,218,208,203,206,221,212,212,207,205,201,218,150,146,213,225,220,208,209,203,204,221,214,207,205,215,214,219,154,153,152,212,205,222,205,212,206,215,218,223,205,205,211,212,225,203,208,205,219,220^204,205,220,201,209,212,219,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,152,215,197,213^198,214,201,214,219,215,213,201,218,219,221,207,205,214,216,201,207,221,212,204,150,146,216,218,209,219^216,215,223,205,218,212,205,167,222,205,167,212,209,214,207,150,146,218,201,218,205,213,215,221,214,220,219,150,146,203,201,218,218,225^198,219,201,212,210,205,218,219,216,205,212,222,201,212,221,220,201,222,209,201,219,223,209,219,208^198,213,215,221,214,220,206,218,215,213,207,221,212,204,201,214,213,225,220,208,209,203,202,205,219,220,216,218,209,203,205,216,219,220,140^198,219,201,212,210,205,218,207,221,212,204,168,219,223,209,219,208^219,299,270,212,207,205,218,207,150,146,213,215,202,209,212,205,216,201,225^210,201,207,219,201,212,210,205,218,207,221,212,204,222,209,201,219,223,209,219,208^219,205,212,212,209,214,207,150,146,206,221,212,212,213,201,219,220,205,218,212,215,215,220,150,146,151,153,152,150,146,216,205,215,216,212,205,150,146,213,201,224,207,205,201,218,150,146,203,208,205,201,216,205,219,220,216,218,209,203,205^204,209,219,203,215,218,204,204,215,218,220,223,209,224,154,154,157,156^201,218,220,209,206,201,203,220,216,215,223,205,218,150,146,205,226,156,225,215,221,141,150,205,221^333,294,278,332,295,265,150,146,154,160,156,157,161,158,155,152,155^198,211,215,216,205,218,141,204,147,211,207,221,212,204,222,209,201,219,223,209,219,208^219,205,212,212,209,214,207,150,146,203,212,205,201,218,150,146,204,209,219,203,215,221,214,220,150,146,209,214,206,205,218,214,201,212,150,146,207,221,201,167,218,201,214,220,205,205^216,218,209,203,205,150,146,202,195,152,215,197,195,152,215,197,213,202,195,152,215,197,195,152,215,197,219,220,195,141,150,148,197,203,195,152,215,197,213^209,214,206,215,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,167,203,195,152,215,197,213^198,206,209,214,214,219,207,221,212,204,206,215,218,141,204,141,204,147,211,218,150,146,213,201,214,207,204,205,218^333,294,278,332,295,265,150,146,153,160,152,157,161,155,161,159,157,158,152^223,220,219,150,146,208,205,218,215,209,203,223,209,220,208,213,212,150,146,202,209,207,204,209,219,203,215,221,214,220,150,146,203,215,213,205,207,205,220,225,215,221,218^337,239,249,150,146,153,157,160,152,154,157,157,159,153,154,158^332,288,232,334,242,242,336,295,239,334,261,269,337,260,232,334,281,234,161,156,157,161,160,157,336,267,237,333,268,239,335,258,236,332,288,242,333,288,261,213,334,240,249,336,295,259,333,268,271,333,259,266,334,241,251,334,245,262,336,279,287,336,271,233,336,280,237^312,287,215,312,291,215,220,215,150,146,213,213,215,201,208,195,141,150,148,197,218,221^161,156,157,161,160,157,150,146,226,206,204,226,212,219,217,213,219,150,146,334,246,269,333,247,282,336,279,255,335,239,235,335,235,271,335,246,243,333,290,271,333,244,237,334,279,253,332,288,258^222,209,219,209,220,150,146,201,214,220,201,218,205,219,202,215,215,219,220,141,150,203,215,213^198,203,215,207,335,294,246,334,260,245,333,287,269,332,293,260,333,278,268^198,219,201,212,210,205,218,207,209,207,205,214,150,146,219,220,215,203,211,150,146,219,205,211^217,217,150,146,157,161,155,160,155,159,152,155,153^213,225,220,208,209,203,150,146,202,215,215,219,220,150,146,206,218,205,205,150,146,207,205,201,218,150,146,202,205,219,220,216,218,209,203,205,150,146,209,214,206,215^223,220,219,150,146,218,221,214,219,150,146,201,218,220,209,206,201,203,220,216,215,223,205,218,150,146,212,205,222,205,212,209,214,207,150,146,213,215,218,205,150,146,209,214,206,215^198,219,299,270,212,207,205,218,207,221,212,204,206,215,218,141,204,147^204,205,201,212,219,150,146,205,216,209,203,203,201,218,218,225,141,150,214,205,220^204,222,209,214,207,150,146,225,203,312,291,225,218,312,288,150,146,204,222,209,214,207^206,201,203,205,202,215,215,211,141,150,203,215,213,151,219,216,218,226,205,204,201,210,211,215,214,220,215,216,212^217,217,155,153,160,154,157,160,155,157,152,161,150,146,219,211,225,216,205^333,247,287,337,261,266,333,241,245,336,243,281,337,259,236,335,239,235,333,290,271,195,212,153,197,195,212,153,197,195,212,153,197,150,146,334,291,265,195,212,153,197,195,212,153,197,195,215,152,197,335,290,271,333,245,283,333,247,279,150,146,213,195,212,153,197,195,212,153,197,195,212,153,197^222,209,219,209,220,150,146,216,205,218,206,205,203,220,223,201,225,141,150,215,214,205^219,205,212,212,209,214,207,150,146,202,215,215,219,220,150,146,207,221,201,167,218,201,214,220,205,205,150,146,207,209,222,205,201,223,201,225,150,146,209,214,206,205,218,214,201,212,150,146,219,216,215,220^333,294,278,332,295,265,212,209,221,210,209,201,214,224,209,215,214,207,160,160,154,160^223,205,202,219,209,220,205,150,146,205,216,209,203,203,201,218,218,225^333,294,278,332,295,265,150,146,153,155,161,159,157,159,155,153,154,158,159^198,219,299,270,212,207,205,218,141,204,147,211,150,146,213,215,202,209,212,205,216,201,225^198,205,214,204,201,214,219,211,205,218,204,205,218,219,299,270,212,207,205,218,207,221,212,204^332,295,265,213,209,201,153,153,153,154,157^204,222,209,214,207,195,141,150,148,197,218,221,150,146,225,203,312,291,225,218,312,288^219,211,225,216,205,150,146,202,220,201,207,150,146,216,218,205,220,220,225,205,212,205,214,201^312,295,216,215,312,284,201,312,284,312,288,213,218,216,215,312,281,312,293,312,288,313,238,225,150,146,312,295,215,312,284,201,216,215,211,150,146,312,282,312,295,213^335,239,235,335,235,271,335,246,243,333,290,271,153,153,153,333,237,272,337,232,258,333,259,266,150,146,334,255,264,334,242,292,332,288,245,333,292,290,333,240,286,333,237,272,335,272,243,334,254,255,225,221,332,288,286,335,238,242,213,201,215,335,259,284,202,215^332,295,265,202,201,202,205,225,153,153,154,155^213,225,220,208,209,203,150,146,203,215,201,203,208,209,214,207,150,146,213,213,215,216,218,215,206^223,218,209,220,205,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,215,152,197,213^213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,215,152,197,213,150,146,209,214,206,215^219,211,225,216,205,150,146,207,205,218,201,212,204,202,201,217^222,209,219,209,220,150,146,203,215,214,217,221,205,219,220,203,201,216,216,205,204,195,141,150,148,197,203,215,213^202,215,215,219,220,220,215,204,201,225,150,146,219,208,201,204,215,223,202,215,215,219,220,141,150,203,215,213^202,215,215,219,220,209,214,207,195,141,150,148,197,216,218,215,150,146,213,215,221,214,220^198,207,221,212,204,206,209,214,214,219,150,146,211,215,216,201,150,146,219,223,209,219,208,140^198,207,221,212,204,206,209,214,214,219,150,146,222,209,201,219,223,195,209,212,197,219,208^332,295,265,160,161,156,157,160,152,154,155,153^198,219,299,270,212,207,205,218,207,216,218,209,219,209,211,211,205,206,201,219,212,201,207,220^198,211,215,216,205,218,223,167,215,167,223,167,207,221,212,204,222,209,201,219,223,209,219,208^223,220,219,221,212,204,209,218,150,146,218,205,217,221,209,218,205,213,205,214,220,219,150,146,203,221,220,220,209,214,207,205,204,207,205,150,146,220,209,220,212,205,150,146,209,214,206,215^198,207,221,212,204,206,209,214,214,219,201,220,220,211,215,216,201,202,209,212,212,209,207,220^213,201,207,205,220,215,223,205,218,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,215,152,197,213^198,207,222,209,201,219,223,209,219,208,206,209,214,214,219^219,299,270,212,207,205,218,141,204,147,211,207,221,212,204,150,146,213,215,202,209,212,205^203,208,205,203,211,150,146,223,215,223,208,221,214,220,141,150,214,205,220^198,219,201,212,205,213,225,220,208,209,203,153,152,211,205,225,206,201,219,220,151,223,213,205,141,150,140^198,207,221,212,204,206,209,214,214,219,216,201,219,223,209,219,208^198,207,221,212,204,141,204,147,211,150,146,211,218,150,146,219,211,225,216,205^204,209,219,203,215,218,204,150,146,204,222,209,214,207,219,221,216,216,215,218,220^217,217,150,146,155,156,157,152,155,156,157^213,215,218,205,209,214,206,215,150,146,203,208,209,205,206,202,215,215,219,220,141,150,167,214,205,220^216,220,151,208,150,146,226,212,219,148,226,206,204,148,217,213,219,150,146,333,260,267,335,241,273,148,337,269,280,333,251,233,333,248,236,335,283,291,334,286,240,336,284,289,148,333,247,270,334,260,241^220,209,220,201,214,209,221,213,202,201,225,150,146,207,215,212,204^209,214,206,215,150,146,223,205,202,219,209,220,205,150,146,210,221,219,220,202,215,215,219,220^333,294,278,332,295,265,150,146,155,157,157,155,155,160,161,159,153^203,215,214,220,201,203,220,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,215,152,197,213^204,222,209,214,207,150,146,216,215,223,205,218,212,205,167,222,205,167,212,150,146,204,222,209,214,207^201,221,220,215,150,146,219,208,201,204,215,223,202,215,215,219,220,141,150,203,215,213^214,215,207,212,205,207,150,146,219,299,270,212,207,205,218,222,209,201,213,215,202,209,212,205,216,201,225^217,217,153,161,159,153,159,152,160,153,155,159,150,146,219,211,225,216,205^223,220,219,150,146,221,212,204,209,218,218,221,214,219,150,146,204,221,214,207,205,215,214,219,218,221,214,219,150,146,220,218,201,204,205,212,215,215,220,201,222,201,209,212,150,146,219,213,215,215,220,208,207,221,209,212,204,218,221,214^219,216,205,212,216,205,214,207,201,218,168,219,223,209,219,208^223,205,202,216,201,207,205,150,146,205,216,209,203,203,201,218,218,225^207,221,212,204,150,146,206,209,214,214,219,201,220,220,211,215,216,201,207,205,214,215,213,219,223,209,219,208^219,208,209,214,205,202,215,215,219,220,160,155,155,152^223,220,219,160,151,160,213,225,220,208,209,203,221,212,204,209,218,150,146,203,215,213,205,207,205,220,150,146,219,216,215,220,212,205,206,220,150,146,205,204,207,205,150,146,219,201,212,205,219,219,216,205,203,209,201,212^198,219,201,212,210,205,218,207,202,209,212,212,209,207,220,222,209,201,219,223,209,219,208^204,209,219,203,215,218,204,216,205,223,216,205,223,157,156,156,160^313,238,205,312,293,195,201,205,197,150,146,212,215,215,220,211,205,205,216,205,218,195,141,150,148,197,203,215,213^334,260,276,334,260,245,150,146,333,247,282,336,279,255,153,153,152,150,146,336,239,274,333,287,281,332,288,242,333,247,287,151,334,255,264,334,242,292,337,239,249,151,332,288,245,333,292,290,333,240,286,334,286,240,336,284,289,334,261,269,335,258,236,334,260,243,333,247,243,213,213,213,213^198,219,220,225,212,205,333,237,276,332,292,258,334,243,259,333,248,236,336,233,244,332,288,258,335,246,273,333,278,286,206,201,218,213,333,247,270,333,268,254,333,237,276,332,292,258,206,201,218,213,208,335,246,243,333,290,271,333,244,237,333,259,266,334,260,241,334,283,253,333,288,240,204,211,337,274,249,335,241,271,334,260,279,333,261,249,213,335,246,243,333,290,271,153,161,334,260,245,333,242,265,333,257,272,159,335,234,289,333,292,232,334,241,251,140^198,207,206,209,214,214,219,222,209,201,219,223,209,219,208^198,213,201,218,209,214,201,336,279,258,334,246,269,334,255,269^219,205,218,222,209,203,205,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,215,152,197,213^220,209,220,201,214,209,221,213,202,201,225,150,146,205,224,220,218,201^198,208,205,212,216,223,209,220,208,213,225,220,208,209,203,153,152,211,205,225,150,146,219,205,212,206,216,212,201,225,151,219,208,201,218,205,150,146,203,208,205,219,220,218,221,214,150,146,216,213,206,215,218,209,214,206,215^333,288,233,150,146,333,294,278,332,295,265,219,220,225,225,212,205,205^217,217,150,146,155,157,160,154,154,152,152,158,158^332,295,265,215,211,156,207,215,212,204^209,214,206,215,150,146,202,195,215,152,197,195,215,152,197,213,202,195,215,152,197,195,215,152,197,219,220,148,203,195,215,152,197,213^214,215,207,212,205,207,150,146,219,299,270,212,207,205,218,215,222,205,218,213,215,202,209,212,205,216,201,225^222,209,219,209,220,150,146,203,201,218,218,225,202,215,215,213,195,141,150,148,197,203,215,213^218,201,220,209,214,207,219,150,146,203,215,201,203,208,209,214,207,150,146,212,205,207,205,214,204,201,218,225,150,146,216,218,209,226,205,219,150,146,207,215,212,204,150,146,209,214,206,215^213,201,214,207,212,205,218,204,221,207,215,212,204,150,146,211,218,215,214,205,218,150,146,213,215,202,209,212,205,216,201,225^217,217,150,146,154,154,159,160,152,156,160,153,159,161^198,219,299,270,212,207,205,218,207,221,212,204,150,146,141,204,147,211,206,215,218,141,204,147,211,218^219,211,225,216,205,150,146,208,205,212,213,209,218,159,157,159,160^223,220,219,206,221,212,212,221,212,204,209,218,150,146,203,215,213,205,207,205,220,201,212,212,155,159,152,155,160,157,209,220,205,213,219,150,146,205,204,207,205,150,146,207,208,221,221,214,150,146,204,205,220,201,209,212,219^223,220,219,208,203,207,208,221,221,214,150,146,219,213,215,215,220,208,201,214,204,206,201,219,220,150,146,203,215,213,205,201,214,204,207,205,220,150,146,203,221,218,222,205,201,203,208,209,205,167,222,220,215,204,201,225,150,146,209,214,206,215^198,219,299,270,212,207,205,218,213,215,214,220,205,218,150,146,209,214,206,215,150,146,205,206,206,205,211,220,209,222^205,216,209,203,203,201,218,218,225,141,150,214,205,220,150,146,222,209,219,209,220^222,224,204,201,209,223,215,223,160,160,160^218,213,202,150,146,334,240,256,335,293,249,216,218,205,220,220,225,205,212,205,214,201^198,223,220,219,141,204,147,211,207,221,212,204,206,215,218,219,223,209,219,208^335,291,235,335,290,271,150,146,202,205,201,218,223,215,223,195,148,150,197,203,215,213^220,215,216,207,221,209,212,204,150,146,219,205,212,212,209,214,207,150,146,207,208,221,221,214,211,209,212,212,219,150,146,203,221,218,222,205,220,215,204,201,225,150,146,201,212,219,215,204,215,209,214,207,213,225,220,208,209,203,218,221,214,219^223,220,219,153,152,213,225,220,208,209,203,204,221,214,207,205,215,214,219,206,215,218,223,205,205,211,212,225,203,208,205,219,220,209,220,205,213,150,146,221,212,204,209,218,208,203,150,146,207,208,221,221,214,208,203^198,207,206,209,214,214,219,201,220,220,167,211,215,216,201^223,205,202,219,209,220,205,150,146,205,202,201,225,207,215,212,204,219,141,150,203,215,213^217,217,150,146,156,158,161,160,158,157,156,160,157^219,201,212,210,205,218,207,221,212,204,150,146,204,205,220,201,209,212,150,146,219,220,215,203,211^333,294,278,334,240,249,153,157,157,159,156,160,156,155,158,152,160^333,259,266,150,146,153,154,161,154,159,152,158,153,155,156^198,223,220,202,207,195,215,221,197,212,204,222,209,201,219,223,209,219,208^215,206,206,205,218,209,214,207,221,212,204,209,218,150,146,207,218,205,201,220,223,201,225,220,215,207,205,220,202,209,219,207,205,201,218,150,146,205,222,205,218,225,220,223,215,208,215,221,218,219,150,146,210,215,209,214,221,219,201,220,201,214,225^223,215,223,208,221,214,220,141,150,203,215,213,150,146,204,205,220,201,209,212,219^202,201,212,215,202,209,214,204,168,215,221,220,212,215,215,211,141,150,203,215,213^198,219,201,212,210,205,218,202,209,212,212,209,207,220,167,207,221,212,204,195,213,222,197,195,205,209,197,195,204,201,197,219,223,209,219,208^198,203,215,207,333,237,276,332,292,258,336,248,272,333,266,251^204,209,219,203,215,218,204,150,146,216,201,156,161,156,160^223,220,219,150,146,221,212,204,209,218,203,212,205,201,218,219,150,146,218,221,214,219,201,218,205,207,215,209,214,207,214,215,223,150,146,219,201,212,205,219,219,216,205,203,209,201,212,150,146,205,204,207,205^332,295,265,219,205,219,205,207,215,212,204^223,220,219,221,212,204,209,218,208,205,218,215,209,203,150,146,213,225,220,208,209,203,150,146,213,204,221,214,207,205,215,214,219,150,146,209,214,220,209,213,205,223,209,220,208,212,215,215,220,150,146,216,215,223,205,218,212,205,167,222,205,167,212^198,219,205,209,207,205,218,207,221,209,209,222,209,201,222,209,216,216,219^219,299,270,212,207,205,218,207,221,212,204,150,146,216,218,209,219,205,218^198,204,201,214,219,211,207,221,212,204,150,146,212,205,222,205,218,209,214,207,150,146,141,204,147,211^198,219,205,212,212,209,214,207,221,212,204,209,218,208,205,218,215,209,203,206,221,212,212,203,212,205,201,218,206,215,218,141,204,141,204,141,204,211,207,215,212,204,150,146,201,212,219,215,219,205,212,212,209,214,207,207,208,221,221,214,150,146,205,224,216,205,218,209,205,214,203,205,204,207,218,215,221,216,150,146,209,214,206,215^198,312,295,215,213,215,218,225,203,213,312,288,313,236,312,288,211,153,152,312,282,220,201,312,289,213,205,216,312,291,225,220,155,159,152,148,312,282,223,209,219,216,213,205,150,140^333,294,278,332,295,265,153,157,157,159,156,160,156,155,158,152,160^198,219,201,195,212,209,197,210,205,218,207,221,195,209,212,197,204,216,201,195,219,140,197,223,195,209,212,197,219,208^220,209,220,201,214,209,221,213,202,201,225,150,146,213,209,214,221,220,195,205,215,197^221,212,204,209,218,206,221,212,212,203,212,205,201,218,150,146,207,205,220,201,212,212,225,215,221,218,155,159,152,212,215,215,220,150,146,203,221,218,222,205,150,146,207,208,221,221,214,202,205,219,220,216,218,209,203,205^217,217,150,146,153,157,153,155,161,156,153,160,153,156^332,295,265,207,215,212,204,223,215,223^207,221,209,212,204,209,219,219,205,212,209,209,214,207,150,146,207,208,221,214,214,218,221,214,219,150,146,204,221,214,207,205,215,214,211,205,225,219,150,146,218,205,217,221,209,218,205,167,213,205,214,220,219,150,146,215,206,206,204,205,201,212^222,224,210,209,214,207,224,221,201,214,155,155,156,156,157,154,153^203,212,201,219,219,150,146,206,202,213,220,205,201,213,141,150,203,215,213^211,215,216,201,207,221,212,204,219,201,212,210,205,218,210,201,207,221,220,213,209,220,220^223,220,219,150,146,221,212,204,209,218,218,221,214,219,150,146,219,213,215,215,220,208,201,214,204,205,201,219,225,150,146,204,215,209,214,207,213,225,220,208,209,203,203,201,218,218,209,205,219^222,209,219,209,220,206,201,219,220,218,221,214,195,141,150,148,197,209,214,206,215^198,214,201,207,215,214,219,215,213,202,205,208,215,222,205,218,211,215,216,201,207,221,195,212,209,197,204^217,217,150,146,155,153,161,156,157,154,153,160,156,160^153,333,247,287,337,261,266,333,241,245,336,243,281,337,259,236,335,239,235,333,290,271,153,153,153,150,146,202,215,219,219,150,146,336,295,256,334,260,241,333,248,236,335,271,245,332,292,256,334,235,264,150,146,153,153,153,333,237,272,337,232,258,333,259,266^204,209,219,203,215,218,204,150,146,218,205,225,222,209,214,211,153,157,160,158^223,220,219,222,209,203,209,215,221,219,150,146,212,205,207,201,203,225,216,222,216,213,215,221,214,220,219,150,146,201,203,208,209,205,222,150,146,215,216,220,209,215,214,201,212^217,148,167,217,153,152,155,160,157,161^202,215,215,219,220,216,222,216,150,146,218,221,214,221,212,204,209,218,150,146,219,205,212,206,216,212,201,225,150,146,206,205,205,204,202,201,203,211^222,209,219,209,220,150,146,204,222,209,214,207,204,215,220,214,205,220^206,202,213,220,205,201,213,141,150,203,215,213,150,146,207,201,213,205^333,294,278,332,295,265,150,146,154,158,158,154,159,161,161,153,155,156^332,295,265,213,219,219,210,206,223^213,213,215,216,218,215,206,150,146,212,215,215,220,150,146,207,215,212,204^219,205,212,212,209,214,207,206,221,212,212,221,212,204,209,218,150,146,202,215,219,219,205,219,203,212,205,201,218,213,209,214,209,213,221,213,150,146,209,220,205,213,219,207,221,201,218,201,214,220,205,205,204,150,146,216,215,223,205,218,150,146,219,208,209,214,225,220,209,220,212,205^207,215,215,207,212,205,150,146,205,216,209,203,203,201,218,218,225^332,295,265,155,161,161,153,154,160,157,156,160^198,213,201,218,209,214,201,335,275,262,334,242,232,333,260,290^198,211,215,216,205,218,207,221,212,204,140^198,219,215,211,205,218,141,204,147,211,222,209,201,219,223,209,219,208^223,220,219,203,218,201,226,225,203,208,205,201,216,206,201,219,220,213,225,220,208,209,203,153,152,153,157,223,205,205,211,212,225,150,146,225,215,221,203,201,214,203,208,215,215,219,205,201,214,225,204,221,214,207,205,215,214,150,146,209,214,206,215^219,211,225,216,205,150,146,202,205,212,211,215,218,211,168,207,213,201,209,212,141,150,203,215,213^198,219,201,212,210,205,218,207,148,150,146,219,211,218,209,222^312,293,312,288,312,287,211,312,288,205,313,238,205,312,293,313,243,150,146,207,205,220,212,215,215,220,195,141,150,148,197,218,221^211,212,226,150,146,334,241,267,153,156,160,156,156,159,153,154,154,156^222,209,219,209,220,207,216,212,201,225,141,150,216,218,215^222,209,219,209,220,216,205,223,216,205,223,219,208,215,216^215,206,206,205,218,150,146,205,216,209,203,203,201,218,218,225,195,148,141,150,197,203,215,213^223,220,219,150,146,153,152,152,153,153,152,150,146,201,203,203,219,208,201,218,205,150,146,202,215,216,213,215,221,214,220,150,146,220,212,216,204^219,216,205,212,216,205,214,207,201,218,206,209,214,214,219,220,209,212,212,207,201,214,207,212,209,207,220,222,209,201,219,223,209,219,208^332,295,265,154,156,157,157,157,158,154,153,157^219,299,270,212,207,205,218,207,221,212,204,222,209,201,213,215,202,209,212,205,167,216,201,225^217,217,150,146,153,156,155,155,157,155,157,158,154,160^207,215,212,204,156,215,211,195,141,150,148,197,203,215,213,150,146,219,215,220,203,211^333,294,278,332,295,265,150,146,219,205,219,205,207,215,212,204^223,205,203,208,201,220,150,146,223,220,223,220,209,201,214,155,154,153^312,295,312,282,205,150,146,203,211,201,312,289,312,295,205,211,215,219,220,201,223,215,223^198,223,220,219,221,212,204,209,218,150,146,213,225,220,208,209,203,204,221,214,207,205,215,214,219,150,146,212,205,222,205,212,212,167,209,214,207,153,153,152,153,154,152^198,219,201,212,210,205,218,223,215,223,207,221,212,204,207,205,214,215,213,219,223,209,219,208^198,195,222,223,197,209,212,212,211,215,216,195,201,219,197,207,221,212,204,150,146,219,223,209,219,208^198,202,209,212,212,209,207,220,207,221,212,204,220,209,212,219,201,212,207^198,208,201,218,207,221,212,204,150,146,219,223,209,219,208,202,209,212,212,209,207,220^333,278,241,334,241,256,337,282,233,334,254,279,148,335,239,235,335,235,271,335,246,243,333,290,271,150,146,333,292,290,333,242,259,333,259,266,337,256,263,148,334,246,241,336,248,293,161,156,157,161,160,157,336,267,237,333,268,239,334,260,241,333,269,255,336,267,237,151,337,269,280,333,251,233,151,333,260,267,335,241,273,333,237,272,335,272,243,335,259,284,334,250,277,148,333,279,238,334,240,249,336,295,259,333,259,266^219,205,212,212,209,214,207,150,146,223,201,218,203,218,201,206,220,150,146,206,221,212,212,207,205,201,218,202,215,215,219,220,150,146,225,215,221,223,209,212,212,207,205,220,150,146,218,205,212,209,203,219,150,146,219,216,215,220,219^198,213,201,218,209,214,201,332,288,251,332,288,258,335,258,236,334,242,268,335,248,238,332,288,251,333,278,286^198,219,299,270,212,207,205,218,207,195,215,221,197,212,204,150,146,213,215,202,209,212,205,216,201,225^203,218,221,219,201,204,205,218,150,146,334,279,253,332,288,258,150,146,211,212,226,150,146,333,272,233,334,260,259,150,146,334,273,257^198,214,201,207,215,214,219,215,213,219,215,211,205,218,207,221,212,204,201,220,220,211,215,216,201^223,201,212,212,207,201,213,209,214,207,150,146,212,215,215,220,150,146,211,205,225,219,220,215,214,205^198,219,201,212,210,205,218,207,221,212,204,151,223,140^224,209,214,202,201,202,205,225,153,153,154,155^223,220,219,221,212,204,209,218,215,214,201,214,225,212,222,212,223,209,220,208,220,218,201,204,205,150,146,213,225,220,208,209,203,204,221,214,207,205,215,214,219,206,215,218,223,205,205,211,212,225,218,205,223,201,218,204^198,223,220,219,213,225,220,208,209,203,150,146,223,205,205,211,212,225,212,215,215,220,150,146,208,205,212,216,225,215,221,220,215,203,212,205,201,218,150,146,212,205,220,221,219,208,201,214,204,212,205,220,208,205,202,215,218,209,214,207,216,201,218,220,219^312,295,215,213,215,312,286,205,213,150,146,214,209,207,208,220,213,215,214,205,225,195,141,150,148,197,218,221^198,207,222,209,201,219,223,209,219,208,150,146,219,211,225,216,205^219,211,225,216,205,150,146,210,201,214,205,202,215,215,219,220^213,215,221,214,220,150,146,215,216,207,201,213,205,207,215,212,204,195,141,150,148,197,203,215,213^223,220,219,222,209,203,209,215,221,219,150,146,215,220,208,205,218,216,222,216,213,215,221,214,220,219,150,146,203,215,213,216,212,205,220,209,215,214,150,146,208,221,214,204,218,205,204,150,146,206,209,219,208,225^208,141,204,147,211,150,146,223,195,219,140,197,223,209,219,208,150,146,202,209,212,212,209,207,220^198,207,221,212,204,222,209,201,219,223,209,219,208^333,237,272,335,294,246,337,270,254,334,261,232,333,237,276,332,292,258,150,146,212,209,213,209,220,150,146,333,239,290,333,252,278,333,247,282,336,279,255,150,146,333,247,268,333,280,252,332,288,289,333,261,248,337,274,249^198,206,209,214,214,219,207,222,209,201,219,223,209,219,208^333,247,287,333,241,245,148,336,243,281,337,259,236,150,146,332,288,245,333,292,290,333,240,286,334,286,240,336,284,289,148,332,288,245,334,252,286,334,242,292,337,239,249,150,146,332,288,232,333,279,289,332,288,232,336,284,284,333,295,235,334,260,245,333,242,265,334,261,269,337,260,232,333,269,255,336,267,237,337,269,280,333,251,233,333,260,267,335,241,273,334,253,267,332,291,286^198,223,220,219,220,203,207,213,215,221,214,220,150,146,203,208,205,201,216,207,150,146,219,220,215,203,211,150,146,219,201,222,205^214,215,207,205,214,150,146,219,211,201,212,211,215,202,205,207,150,146,209,214,206,215^219,211,225,216,205,150,146,203,201,212,222,209,214,141,150,206,218,205,205,226,205^204,209,219,203,215,218,204,150,146,219,221,214,214,225,156,153,157,153^312,295,216,215,312,284,201,312,286,201,150,146,203,215,209,214,219,219,220,215,218,205,195,141,150,148,197,218,221^336,242,279,210,209,214,207,224,221,201,214,155,155,156,156,157,154,153^198,202,209,212,212,209,207,220,207,221,212,204,222,209,201,219,223,209,219,208^198,219,215,207,205,218,205,214,204,201,214,219,211,207,215,212,204,219,299,270,212,207,205,218^198,219,299,270,212,207,205,218,207,221,212,204,222,209,201,219,223,209,216,216^223,220,219,213,225,220,208,209,203,153,141,204,219,220,201,218,220,209,214,207,214,215,223,150,146,219,213,215,215,220,208,218,221,214,219,150,146,205,224,216,205,218,209,205,214,203,205,150,146,205,212,209,220,205,216,212,201,225,205,218,219,150,146,202,205,219,220,216,218,209,203,205,219,150,146,201,212,219,215,219,205,212,212,209,214,207,150,146,207,215,212,204,215,214,212,225^203,215,214,220,201,203,220,150,146,205,216,209,203,203,201,218,218,225,195,141,150,148,197,214,205,220^223,220,219,206,221,212,212,203,212,205,201,218,221,212,204,209,218,150,146,207,205,220,225,215,221,218,201,212,212,150,146,207,208,221,221,214,150,146,202,205,219,220,216,218,209,203,205^213,225,220,208,209,203,150,146,211,205,225,150,146,221,216,207,218,201,204,205,150,146,213,201,219,220,205,218,150,146,201,203,208,209,205,222,150,146,219,211,209,214,150,146,223,205,205,211,212,225^219,211,225,216,205,150,146,215,226,225,202,215,215,219,220^198,213,201,218,209,214,201,333,248,236,335,271,245,335,258,278,336,234,268^216,222,216,150,146,153,153,152,153,154,152,150,146,337,239,249,333,288,233,335,277,241^198,214,201,207,215,214,219,215,213,219,201,212,210,205,218,207,221,167,212,167,204,167,222,209,201,219,223,209,219,208^221,219,204,150,146,223,220,220,207,215,212,204,195,141,150,148,197,203,215,213^219,211,225,216,205,150,146,201,216,216,215,212,201,224,155,152,160,157^204,209,219,203,215,218,204,213,205,212,215,218,209,224,224,156,153,157,153^218,215,312,291,312,284,201,195,141,150,148,197,216,313,236,150,146,222,209,219,201^332,295,265,150,146,159,159,160,157,160,159,155,153,158^217,217,154,159,161,153,154,156,158,155,153^204,209,219,203,215,218,204,220,202,159,152,152,152^219,222,205,214,150,146,206,209,214,214,219,150,146,219,220,215,203,211,150,146,219,211,225,216,205^219,211,225,216,205,150,146,216,222,205,219,208,215,216^223,215,223,213,201,218,220,195,141,150,148,197,218,221,150,146,312,287,215,312,291,215,220,215^223,220,219,221,212,204,209,218,208,205,218,215,209,203,206,221,212,212,207,205,201,218,150,146,153,152,216,215,221,218,218,205,203,215,213,216,205,214,219,205,208,205,202,204,215,213,201,204,201,209,218,205,140^202,221,225,219,201,206,205,221,212,204,209,218,150,146,201,214,225,203,208,201,218,201,203,220,205,218,209,219,223,205,212,203,215,213,205,150,146,207,205,220,203,208,205,201,216,150,146,203,221,218,222,205^198,211,215,216,205,218,207,222,209,201,219,223,209,219,208^206,221,212,212,218,221,214,150,146,207,221,201,218,201,214,220,205,205,210,221,219,220,206,215,218,141,204,141,204,147,205,221,218,150,146,220,215,214,209,207,208,220^202,215,215,219,220,209,214,207,195,141,150,148,197,216,218,215,150,146,212,215,215,220^333,268,271,335,281,283,150,146,155,159,152,155,160,157,150,146,153,153,152,153,154,152,337,239,249,333,288,233^333,294,278,332,295,265,150,146,153,157,160,157,159,158,154,157,152,152,158^198,207,206,209,214,214,219,202,209,212,212,209,207,220,140^198,207,221,167,212,167,204,167,206,209,214,214,219,168,219,223,209,219,208^198,213,201,218,209,214,201,334,255,271,332,288,254,335,253,244^198,219,201,212,210,205,218,202,209,212,212,209,207,220,207,221,212,204,140^219,208,201,204,215,223,202,215,215,219,220,141,150,203,215,213,150,146,207,221,209,212,204^204,205,220,201,209,212,219,150,146,215,226,225,207,218,215,221,216,141,150,203,215,213^220,209,220,201,214,209,221,213,202,201,225,150,146,212,209,222,218,201,209,219,215,214^209,215,223,150,146,218,213,202,150,146,215,211,156,207,215,212,204^207,221,209,212,204,150,146,219,208,201,204,215,223,202,215,215,219,220,141,150,203,215,213^333,237,272,334,260,245,334,260,232,332,293,246,332,291,287,150,146,216,222,216,153,160,152,152,150,146,153,153,152,153,154,152,150,146,337,239,249,333,288,233^209,214,206,215,150,146,205,216,209,203,203,201,218,218,225,195,141,150,148,197,203,215,213^198,219,299,270,212,207,205,218,207,221,212,204,150,146,223,208,209,219,216^217,217,150,146,153,157,155,160,159,156,152,158,161^203,215,214,220,201,203,220,150,146,205,216,209,203,203,201,218,218,225,195,141,150,148,197,203,215,213^332,295,265,204,201,209,223,215,223,160,160,160^223,220,219,206,221,212,212,203,212,205,201,218,150,146,207,205,220,225,215,221,218,201,212,212,212,215,215,220,150,146,203,221,218,222,205,150,146,207,208,221,221,214,202,205,219,220,216,218,209,203,205^207,208,221,221,214,209,219,201,213,201,207,207,215,220,150,146,220,215,204,201,225,150,146,207,205,201,218,150,146,203,221,218,222,205,150,146,203,208,205,201,216,150,146,219,201,206,205,150,146,214,215,223^198,202,209,212,212,209,207,220,207,221,167,212,167,204,167,206,209,214,214,219,150,146,219,223,209,219,208^222,209,219,209,220,210,202,219,220,141,150,216,218,215^223,220,219,150,146,205,141,150,146,216,141,150,146,209,141,150,146,203,141,150,146,203,141,150,146,201,141,150,146,218,141,150,146,218,141,150,146,225,141,150,146,203,141,150,146,215,141,150,146,213^198,219,201,212,210,205,218,207,141,150,167,140^207,221,212,204,219,201,212,210,205,195,218,219,197,222,209,201,219,223,209,219,208^198,207,221,212,204,209,214,214,205,150,146,202,205,220,201,212,214,209,214,207,222,209,201,219,223,209,219,208^198,208,201,218,141,204,147,211,220,209,212,212,219,201,212,221,222,209,201,219,223,209,219,208^198,219,201,212,210,205,218,207,221,212,204,222,209,201,219,223,209,219,208^219,209,220,205,150,146,213,213,195,215,152,197,212,222,212,141,150,203,195,215,152,197,213^213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,215,152,197,213,150,146,203,215,214,220,201,203,220^215,206,206,205,218,219,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,215,152,197,213^219,220,215,218,213,201,214,207,204,207,221,212,204,209,214,214,205,150,146,206,209,214,214,219,202,209,212,212,209,207,220^220,209,220,201,214,209,221,213,202,201,225,150,146,215,202,220,205,214,205,226^223,220,219,213,225,220,208,209,203,204,221,214,207,205,215,214,219,154,153,152,212,222,212,150,146,221,212,204,209,218,150,146,212,215,215,220^219,205,212,212,209,214,207,221,212,204,209,218,160,151,160,213,225,220,208,209,203,202,215,215,219,220,207,205,220,201,212,212,155,141,204,141,204,212,215,215,220,202,205,219,220,216,218,209,203,205,151,223,213,205^223,220,219,222,209,203,209,215,221,219,150,146,203,201,218,218,225,225,215,221,218,205,207,201,218,204,150,146,219,205,212,206,216,212,201,225,150,146,218,205,212,201,220,205,204,219,220,221,206,206^333,294,278,332,295,265,150,146,153,157,152,157,155,160,153,161,152,159^223,220,219,205,224,220,218,205,213,205,212,225,203,208,205,201,216,221,212,204,209,218,150,146,219,209,214,207,212,205,221,212,204,209,218,213,225,220,208,209,203,202,215,219,219,205,219,223,209,220,208,212,215,215,220,150,146,214,215,218,205,217,221,209,218,205,213,205,214,220,219,150,146,209,214,206,215^332,295,265,153,160,153,159,157,153,155,158,158,152,154^198,219,205,212,207,205,218,202,209,212,212,209,207,207,221,212,212,150,146,219,211,225,216,205^223,215,223,208,221,214,220,202,215,215,219,220,209,214,207,219,205,218,222,209,203,205^207,221,209,212,204,209,219,219,205,212,212,209,214,207,221,212,204,209,218,218,221,214,219,150,146,207,205,220,225,215,221,218,201,208,205,201,204,150,146,203,221,218,222,205,220,215,204,201,225,150,146,201,212,219,215,204,215,209,214,207,206,201,219,220,213,225,220,208,209,203,218,221,214,219^198,219,201,214,201,207,215,214,150,146,211,215,216,201,207,221,212,204,140^223,220,219,221,212,204,209,218,208,203,151,214,213,150,146,202,215,215,219,220,204,205,219,209,213,216,212,205,219,204,215,214,210,215,214,219,150,146,213,201,220,205,213,216,219,216,215,221,218,212,201,203,215,206,206,218,205,208,205,202,204,215,213,201,204,201,209,218,205,140^161,158,152,161,160,157,202,215,219,219,150,146,218,215,212,212,333,288,233,333,237,245,336,284,289,150,146,333,244,237,336,293,276,334,260,245,334,260,290,335,269,272^198,206,209,214,214,219,207,221,212,204,150,146,219,223,209,219,208,150,146,223,213,209,207^219,211,225,216,205,150,146,203,208,209,205,206,202,215,215,219,220^223,220,219,213,225,220,208,209,203,150,146,219,220,201,218,220,209,214,207,214,215,223,150,146,219,213,215,215,220,208,218,221,214,219,204,215,214,205,202,225,150,146,205,212,209,220,205,216,212,201,225,205,218,219,150,146,202,205,219,220,216,218,209,203,205,219,150,146,223,205,201,212,219,215,219,208,201,218,205^222,209,219,209,220,150,146,213,213,195,215,152,197,212,222,212,195,141,150,148,197,203,195,152,215,197,213^214,215,207,205,214,204,205,218,219,211,201,212,211,215,202,205,213,215,214,220,150,146,209,214,206,215^332,295,265,150,146,153,159,159,160,160,161,157,157,155,156,153^222,209,219,209,220,150,146,223,215,223,208,221,214,220,141,150,214,205,220^217,335,294,268,150,146,153,154,154,160,159,153,158,159,153^198,223,220,219,221,212,204,209,218,150,146,154,153,152,213,225,220,208,209,203,204,221,214,207,205,215,214,219,150,146,206,221,212,212,207,205,201,218^198,213,201,218,209,214,201,337,256,295,334,259,292,336,243,247,335,258,236,337,266,236,336,271,233^207,221,212,204,211,222,201,218,150,146,222,209,201,219,223,209,219,208^141,204,141,204,141,204,211,207,215,212,204,150,146,219,220,201,218,220,214,215,223,150,146,203,221,218,222,205,150,146,212,215,215,220,201,218,205,219,208,201,218,205,204,150,146,206,221,212,212,207,221,209,212,204,150,146,204,209,219,203,215,218,204^203,201,312,289,220,150,146,211,209,214,207,207,215,212,204,195,141,150,148,197,218,221^222,209,219,209,220,150,146,204,222,209,214,207,141,150,214,205,220^219,211,225,216,205,150,146,210,201,219,213,209,214,205,202,201,202,225,152,156,152,160^333,254,242,153,333,247,287,337,261,266,333,241,245,208,335,246,243,333,290,271,153,153,153,333,237,272,337,232,258,334,291,265,212,212,215,333,245,283,333,247,279,333,269,255,336,267,237,151,337,269,280,333,251,233,151,333,260,267,335,241,273,334,244,249,334,234,272,333,254,260,334,276,266,335,258,236,334,243,295,333,239,290,332,288,232,332,291,286,332,291,256,332,288,232,332,291,286^218,213,202,150,146,333,269,269,336,295,274,333,280,252,336,267,237,333,268,239,333,245,253,333,245,254,150,146,216,222,216,150,146,209,215,223^223,220,219,150,146,216,209,203,211,150,146,223,205,205,211,212,225,203,208,205,219,220,219,206,215,218,203,208,205,201,216,216,218,209,203,205,150,146,219,220,201,203,211,201,218,213,215,218,150,146,203,208,205,201,216,205,218,216,218,209,203,205^202,201,220,220,212,205,220,201,207,150,146,207,208,215,219,220,204,215,207,154,153,155,156,156,152^219,205,212,212,209,214,207,206,221,212,212,203,212,205,201,218,221,212,204,209,218,150,146,207,205,220,201,212,212,155,159,152,155,160,157,150,146,212,215,215,220,150,146,205,204,207,205,150,146,207,208,221,221,214,150,146,202,205,219,220,216,218,209,203,205,150,146,216,219,220^333,294,278,332,295,265,150,146,207,215,212,204,206,215,218,219^333,244,237,333,259,266,150,146,157,154,159,155,155,160,161,155,156^198,219,205,212,207,205,218,207,221,212,212,222,209,201,222,209,216,216,219^333,294,278,332,295,265,150,146,154,154,156,159,158,160,154,157,153,154^332,295,265,157,156,161,161,158,157,160,155,160^333,294,278,332,295,265,207,208,205,219,220,212,221,215,202,215^204,209,219,203,215,218,204,221,216,155,161,152,155^198,219,201,212,210,205,218,207,221,212,204,150,146,219,211,225,216,205^217,217,154,157,153,153,155,152,156,161,155^219,205,212,212,209,214,207,150,146,220,209,213,205,218,150,146,219,205,212,206,216,212,201,225,150,146,206,201,219,220,150,146,220,215,216,207,205,201,218,150,146,209,214,206,215^223,220,219,150,146,213,225,220,208,209,203,150,146,201,218,220,209,206,201,203,220,216,215,223,205,218,150,146,216,218,205,219,220,209,207,205,150,146,212,205,222,205,212,209,214,207^223,220,219,209,220,205,213,219,205,220,202,215,215,219,220,150,146,221,212,204,209,218,150,146,213,204,221,214,207,205,215,214,219,154,153,152^198,219,299,270,212,207,205,218,207,221,212,204,220,209,212,204,201,214,219,211,205,218,205^198,336,232,233,335,241,244,335,294,246,334,260,245,203,215,207^223,220,219,150,146,220,203,207,213,215,221,214,220,219,150,146,207,195,215,152,197,212,204,150,146,219,201,212,205^201,220,220,205,214,220,209,215,214,150,146,205,216,209,167,203,203,201,218,218,225,141,150,203,215,213^198,219,201,212,210,205,218,207,221,212,204,216,201,219,223,209,219,208^198,213,201,218,209,214,201,216,222,216,335,282,294,337,252,248,335,258,278,336,234,268^219,299,270,212,207,205,218,207,221,212,204,150,146,209,214,206,215^333,247,287,337,261,266,333,241,245,331,232,233,336,243,281,337,259,236,333,237,272,337,232,258,333,278,241,334,241,256,337,282,233,334,254,279,148,335,239,235,335,235,271,335,246,243,333,290,271,207,333,259,266,148,220,154,153,333,269,255,336,267,237,150,146,335,266,294,333,246,243,333,259,266,337,256,263,333,247,270,334,260,241,333,248,236,333,268,271,334,260,245,333,247,282,336,279,255,335,246,243,333,290,271,153,153,152,337,256,295,334,264,292,334,243,241,335,246,259,333,247,282,336,279,255,337,258,294,333,290,270","218,222,202,213,210,221,226^206,225,217,206,219,210,206,215,204,206^205,206,213,210,223,206,219,226^202,204,204,220,209,202,219,196,206,210,198^207,202,220,221^335,255,281,336,272,246,335,256,248,334,290,292,334,245,255,337,272,268,338,253,234^208,222,202,219,202,215,221,206,206^213,210,206,207,206,219,222,215,208^217,202,226,217,202,213^204,216,205,206^219,202,221,210,215,208^202,204,204,216,222,215,221^338,268,263,337,266,245,337,272,268,338,253,234^217,219,210,204,206^220,206,204,222,219,206^220,206,213,207,217,213,202,226^204,216,222,217,216,215^337,242,291,335,242,244,333,292,268,335,242,252^338,257,296,334,248,269,335,255,280,335,241,249,334,281,282^213,210,223,206,204,209,202,221^222,215,213,216,204,212^220,206,202,220,216,215^337,234,245,333,289,259,334,262,249,338,275,250^220,212,226,217,206^337,285,293,335,284,254,334,295,288^202,219,206,215,202^205,210,220,204,216,222,215,221^338,268,263,337,266,245,335,241,249,334,281,282^335,255,281,336,272,246,335,256,248,337,272,268,338,253,234^217,219,216,207,207,168,206,220,220,168,210,216,215,202,213^224,206,203,204,209,202,221^220,222,217,217,216,219,221^334,241,288,335,274,258^203,196,216,153,198,196,216,153,198,220,221^217,210,213,196,216,153,198,221,206,205^208,213,202,205,210,202,221,216,219^204,216,214,217,206,221,210,221,210,216,215^220,221,216,219,206^204,209,206,202,217^223,210,220,210,221,151,147,224,206,203,220,210,221,206^213,206,223,206,213,210,215,208^220,206,219,223,210,204,206^220,202,207,206^221,219,222,220,221,217,210,213,216,221^337,272,268,338,253,234,338,268,263,337,266,245^336,292,236,336,291,272^213,206,208,202,213^333,292,288^214,196,216,153,198,222,215,221^204,216,202,204,209,210,215,208^204,222,220,221,216,214,206,219^218,222,202,215,221,210,221,226^217,202,204,212,202,208,206^337,234,245,333,289,259,334,260,267,338,257,264^338,275,250,333,289,259,334,243,266^334,262,249,338,275,250^219,203,208^220,202,213,206","338,286,272,335,249,289,337,293,286,336,244,270^336,262,247,335,244,267,335,259,274,143,206,143,206,169,337,236,291,335,294,234,336,243,253^336,285,255,335,290,242,335,267,254^339,275,278,334,290,244,336,243,253,336,285,255","219,221,212,206,208,144,207,150,214^218,226,217,158,207,144,153,223,225^144,207,150,214,198,154,199,200,170,207,224,217,210,208,218,217^210,224,212,215,207,215,204,224,217,206,211,144,153,206,218,216^144,153,205,204,223,223,215,208,144,153,217,208,223,154^226,218,226,222,223,208,204,207,144,153,206,218,216^221,208,206,221,224,212,170,223^210,218,215,207,219,221,212,206,208,222^209,218,221,210,218,215,207^210,204,216,208,221,215,204,224,217,206,211,144,153,206,218,216^222,208,221,225,208,221,223,212,216,208^224,222,223,221,208,204,216,144,153,223,225^210,224,212,215,207,219,218,221,223,204,215,144,153,206,218,216^210,218,215,207,218,217,215,228^226,208,208,205,215,228,144,153,206,218,216^208,217,223,221,204,217,206,208^210,221,208,208,217,222^207,208,219,208,217,207^204,219,219,215,198,212,228,200^210,224,212,215,207,218,216,204,223,212,206,144,153,206,218,216^210,224,212,215,207,226,218,221,214,153,206,218,216^210,204,216,212,217,210^210,224,212,215,207,211,218,222,223,212,217,210,153,218,221,210^222,218,206,212,204,215^226,218,226,211,218,221,207,208,222,144,153,206,218,216^210,224,212,215,207^206,211,208,204,219,208,221,223,211,204,217,204,211^144,207,150,214,219,208,221,207,224,217,210,208,218,217^208,217,213,212,217,144,153,206,218,216^144,207,150,214,219,208,221,221,224,217^223,226,212,223,206,211,144,153,223,225^210,204,216,208,223,212,216,208^218,217,215,228,204,206,206,208,219,223,212,170,217,170,210,170,210,218,215,207^144,207,150,214,198,154,199,200,170,208,204,206,211^222,211,212,225,223,221,144,153,206,218,216^226,218,226,215,204,224,217,206,211,144,153,206,218,216^216,208,216,205,208,221,222^144,153,226,212,227,144,153,206,218,216^206,218,221,219,215,204,224,217,206,211,144,153,206,218,216","211,205,217,209,223,205,216,209,223,199,145,154,152,201,220,222,219^211,205,217,209,205,225,207,145,154,207,219,217^209,216,213,224,213,223,224,211,205,217,213,218,211,199,145,154,152,201,207,219,217^227,219,227,207,208,215,145,154,207,219,217^206,219,219,223,224,219,222,209,199,145,154,152,201,218,209,224^212,219,223,224,211,219,216,208,223,145,154,207,219,217^210,219,228,223,224,219,222,209,145,154,220,222,219^219,230,229,206,219,219,223,224,145,154,207,219,217^227,219,227,212,225,218,224,145,154,207,219,217^206,205,218,215,160,208,212,199,145,154,152,201,171,207,219,217^208,226,213,218,211,199,145,154,152,201,218,209,224^205,230,209,222,213,223,209,145,154,207,219,217^207,222,205,230,229,209,224,213,145,154,207,219,217^224,219,220,206,219,219,223,224,199,145,154,152,201,220,222,199,219,156,201^217,217,219,216,226,216,199,145,154,152,201,207,199,156,219,201,217^211,160,211,205,217,209,199,145,154,152,201,207,199,219,156,201,217^207,205,222,222,229,206,219,219,217,145,154,218,209,224^217,217,219,207,209,219,145,154,207,219,217^220,222,209,223,224,213,211,209,227,219,227,145,154,207,219,217^221,225,213,207,215,205,218,208,223,217,219,219,224,212,145,154,207,219,217^227,219,227,226,209,218,208,219,222,145,154,207,219,217^227,227,227,145,154,211,205,217,209,222,209,205,223,229,145,154,207,219,217^210,206,217,224,209,205,217,145,154,220,222,219^206,199,156,219,201,199,156,219,201,223,224,217,205,218,199,145,154,152,201,213,218,210,219^210,206,217,224,209,205,217,199,145,154,152,201,207,219,217^219,230,229,211,222,219,225,220,145,154,207,219,217^216,219,219,224,226,205,225,216,224,145,154,218,209,224^223,212,205,208,219,227,206,219,219,223,224,145,154,207,219,217^220,226,220,219,215,199,145,154,152,201,207,199,156,219,201,217^207,205,222,222,229,206,219,219,217,145,154,207,219,217^206,219,219,223,224,160,211,205,217,209,199,145,154,152,201,207,219,217^209,220,213,207,207,205,222,222,229,199,145,154,152,201,207,219,217^209,216,213,224,209,211,205,217,209,222,206,219,219,223,224,213,218,211,199,145,154,152,201,218,209,224^220,226,209,223,212,219,220,145,154,220,222,219^216,219,219,224,207,216,219,225,208,208,219,224,207,219,217^211,219,216,208,160,220,226,209,145,154,207,219,217^206,219,219,223,224,158,218,213,211,212,224,145,154,207,219,217^227,219,227,220,222,209,223,224,213,211,209,145,154,210,222^222,205,208,213,205,218,224,222,205,213,208,145,154,207,219,217^210,205,222,217,160,211,219,216,208,199,145,154,152,201,207,219,217^206,219,209,211,205,217,209,223,145,154,207,219,217^206,219,219,223,224,212,213,226,209,199,145,154,152,201,209,225^220,209,222,210,209,207,224,227,205,229,199,145,154,152,201,219,218,209^206,209,223,224,206,219,219,223,224,199,145,154,152,201,207,219,217^206,219,219,223,224,213,216,205,199,145,154,152,201,207,219,217^227,219,227,220,222,209,223,224,213,211,209,145,154,207,219,217^216,209,220,222,209,223,224,219,222,209,145,154,219,222,211^220,226,209,211,205,217,209,222,223,145,154,207,219,217^217,217,219,211,219,216,208,206,205,229,199,145,154,152,201,218,209,224^206,219,219,223,224,213,218,211,216,213,226,209,199,145,154,152,201,207,219,217^217,205,228,145,154,222,219,207,215,209,224,211,205,217,213,218,211,145,154,209,225^213,218,211,205,217,209,217,205,222,224,145,154,207,219,217^210,205,218,216,219,211,205,217,209,145,154,207,219,217^207,212,222,213,223,224,219,220,212,145,154,222,219,207,215,209,224,211,205,217,213,218,211^211,219,216,208,208,209,205,216,199,145,154,152,201,222,225^227,219,222,216,208,219,210,206,219,219,223,224,199,145,154,152,201,207,219,217^213,222,205,218,206,216,213,230,230,205,222,208,145,154,207,219,217^206,199,156,219,201,199,156,219,201,223,224,217,205,218,199,145,154,152,201,219,218,216,213,218,209^223,213,217,220,216,209,207,205,222,222,229,145,154,207,219,217^210,206,217,224,209,205,217,145,154,218,209,224^209,206,205,229,211,219,216,208,223,145,154,207,219,217^209,220,213,207,207,205,222,222,229,199,145,154,152,201,218,209,224^206,222,206,158,211,205,217,209,199,145,154,152,201,207,219,217^223,212,205,208,219,227,206,219,219,223,224,145,154,217,216^224,219,220,206,219,219,223,224,145,154,213,218,210,219^214,225,223,224,206,219,219,223,224,145,154,219,222,211^206,209,223,224,206,219,219,223,224,199,145,154,152,201,207,216,225,206^207,219,218,221,225,209,223,224,207,205,220,220,209,208,199,145,154,152,201,207,219,217^205,212,211,219,216,208,223,145,154,207,219,217^206,199,156,219,201,199,156,219,201,223,224,217,205,218,199,145,154,152,201,223,213,224,209^227,219,227,226,209,218,208,219,222,145,154,218,209,224^220,226,209,211,205,217,209,222,223,145,154,218,209,224^211,219,211,219,206,219,219,223,224,145,154,207,199,219,156,201,217^220,222,219,214,209,207,224,207,205,222,222,229,145,154,207,219,217^216,209,220,222,209,223,224,219,222,209,145,154,218,209,224^227,219,227,206,219,220,145,154,207,219,217^220,222,209,223,224,213,211,209,227,219,227,145,154,210,222^216,209,211,213,219,218,210,205,222,217,145,154,207,219,217^220,209,227,220,209,227,223,212,219,220,199,145,154,152,201,220,222,219^206,219,228,216,209,211,213,224,145,154,207,219,217^216,219,219,224,207,216,219,225,208,199,145,154,152,201,207,219,217^217,229,224,212,213,207,223,224,219,222,209,199,145,154,152,201,207,219,217^224,213,224,205,218,213,225,217,206,205,229,145,154,207,219,217^206,199,156,219,201,199,156,219,201,223,224,217,205,218,157,171,199,145,154,152,201,220,222,199,156,219,201^214,225,223,224,206,219,219,223,224,199,145,154,152,201,218,209,224^224,220,211,219,216,208,223,199,145,154,152,201,207,219,217^205,218,224,219,222,225,223,208,209,205,216,223,145,154,207,219,217^227,223,211,206,219,219,223,224,145,154,207,219,217^219,215,160,211,219,216,208,199,145,154,152,201,207,219,217^212,219,222,208,209,206,205,218,215,199,145,154,152,201,207,219,217^206,199,219,156,201,199,219,156,201,223,224,217,205,218,199,145,154,152,201,218,209,224^229,219,225,222,223,220,225,222,209,211,205,217,209,199,145,154,152,201,207,219,217^227,219,227,212,225,218,224,145,154,218,209,224^206,219,219,223,224,217,209,220,216,230,145,154,207,219,217^213,211,228,209,145,154,207,219,217^227,219,227,158,156,156,161,199,145,154,152,201,207,219,217^217,229,224,212,213,207,223,224,219,222,209,199,145,154,152,201,218,209,224^216,209,220,222,209,223,224,219,222,209,145,154,207,219,217^227,219,227,226,209,218,208,219,222,145,154,219,222,211^206,222,219,206,219,219,223,224,145,154,207,219,217^212,225,223,215,229,206,199,219,156,201,199,219,156,201,223,224,145,154,207,199,219,156,201,217^209,220,213,207,207,205,222,222,229,199,145,154,152,201,219,222,211^206,199,156,219,201,199,156,219,201,223,224,217,205,218,208,219,224,223,213,224,209","217,210,221,223,210,224,225,220,223,210,146,155,220,223,212^217,210,221,223,210,224,225,220,223,210,146,155,219,210,225^221,227,210,212,206,218,210,223,224,146,155,219,210,225^217,210,221,223,210,224,225,220,223,210,146,155,208,220,218")

local repTbl = {
	--Symbol & space removal
	["[%*%-<>%(%)\"!%?=`'_%+#%%%^&;:~{}%[%] ]"]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", ["|"]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",

	--This is the replacement table. It serves to deobfuscate words by replacing letters with their English "equivalents".
	[""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", -- First letter is Russian "\208\176". Convert > \97.
	[""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", -- Convert > \97. Note: , ,  fail with strlower, include both.
	[""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", --First letter is Russian "\209\129". Convert > \99. Note: , , ,  fail with strlower, include both.
	[""]="d", [""]="d", [""]="d", [""]="d", --Convert > \100. Note: ,  fail with strlower, include both.
	[""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", --First letter is Russian "\208\181". Convert > \101. 
	[""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", --Note: , , , , , ,  fail with strlower, include both.
	[""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", -- Convert > \103. Note: , , ,  fail with strlower, include both.
	[""]="h", [""]="h", -- Convert > \104. Note:  fail with strlower, include both.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", -- Convert > \105.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", --Convert > \105. -- Note: , , , ,  fail with strlower, include both.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", --Convert > \105. -- Note: , , ,  fail with strlower, include both.
	[""]="j", [""]="j", -- Convert > \106. -- Note:  fail with strlower, include both.
	[""]="k", [""]="k", [""]="k", -- First letter is Russian "\208\186". Convert > \107. -- Note:  fail with strlower, include both.
	[""]="l", [""]="l", [""]="l", [""]="l", [""]="l", [""]="l", -- Convert > \107. -- Note: , ,  fail with strlower, include both.
	[""]="m", [""]="m", -- First letter is capital Greek  "\206\156". Convert > \109
	[""]="n", [""]="n", [""]="n", [""]="n", -- First letter is small Greek eta  "\206\183". Convert > \110. 
	[""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", --Convert > \110. Note: , , ,  fail with strlower, include both.
	[""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", --First letter is Russian "\208\190". Convert > \111.
	[""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", --Note: , , , , ,  fail with strlower, include both.
	[""]="p", [""]="p", [""]="p", [""]="p", [""]="p", --First letter is Russian "\209\128". Convert > \112. --Note:  fail with strlower, include both.
	[""]="q", [""]="q", --Note:  fail with strlower, include both.
	[""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", --Convert > \114. -- Note: , ,  fail with strlower, include both.
	[""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", --Convert > \115. -- Note: , , , ,  fail with strlower, include both.
	[""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", --Convert > \116. -- Note: , , ,  fail with strlower, include both.
	[""]="u", [""]="u", [""]="u", [""]="u", --Convert > \117.
	[""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", --Convert > \117. -- Note: , , , ,  fail with strlower, include both.
	[""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", -- First letter is small Greek omega  "\207\142". Convert > \119. -- Note: , , , ,  fail with strlower, include both.
	[""]="y", [""]="y", [""]="y", [""]="y", -- First letter is Russian "\209\131". Convert > \121. -- Note:  fail with strlower, include both.
	[""]="0", [""]="1", [""]="2", [""]="3", [""]="4", [""]="5", [""]="6", [""]="7", [""]="8", [""]="9",
	[""]=".", [""]=".", [""]=",", [""]="o", [""]="r", [""]="o", [""]="t",
}

--[[ Chat Scanning ]]--
local Ambiguate, BNGetGameAccountInfoByGUID, gsub, lower, next, type, tremove = Ambiguate, BNGetGameAccountInfoByGUID, gsub, string.lower, next, type, tremove
local IsFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar = C_FriendList.IsFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar
local CanReportPlayer, ReportPlayer, PlayerLocation = C_ReportSystem.CanReportPlayer, C_ReportSystem.ReportPlayer, PlayerLocation
local spamCollector, backupCollector, spamLogger, prevShow, enableBubble = {}, {}, {}, 0, false
local blockedLineId, et, chatLines, chatPlayers = 0, 7, {}, {}
local btn, reportFrame
local function IsFriendly(name, flag, _, guid)
	if not guid then return true end -- LocalDefense automated prints
	if not guid:find("^Player") then -- Bad addons
		local msg = "BadBoy: Unexpected GUID requested by an addon: ".. guid
		print(msg)
		geterrorhandler()(msg)
		return true
	end
	local _, characterName = BNGetGameAccountInfoByGUID(guid)
	if characterName or IsGuildMember(guid) or IsFriend(guid) or UnitInRaid(name) or UnitInParty(name) or flag == "GM" or flag == "DEV" then
		return true
	end
end
local function Cleanse(msg)
	msg = gsub(msg, "|c[^%[]+%[([^%]]+)%]|h|r", "%1") -- Speed up processing messages with links by removing them
	msg = lower(msg) --Lower all text, remove capitals
	for k,v in next, repTbl do
		msg = gsub(msg, k, v)
	end
	return msg
end
local eventFunc = function(_, event, msg, player, _, _, _, flag, channelId, channelNum, _, _, lineId, guid)
	-- Re-enable chat bubbles if they were disabled in the previous event.
	if enableBubble then
		enableBubble = false
		SetCVar("chatBubbles", 1)
	end

	blockedLineId = 0
	if event == "CHAT_MSG_CHANNEL" and (channelId == 0 or type(channelId) ~= "number") then return end --Only scan official custom channels (gen/trade)

	local trimmedPlayer = Ambiguate(player, "none")
	if IsFriendly(trimmedPlayer, flag, nil, guid) then return end

	local debug = msg --Save original message format
	msg = Cleanse(msg)

	--20 line text buffer, this checks the current line, and blocks it if it's the same as one of the previous 20
	if event == "CHAT_MSG_CHANNEL" then
		local cleanestMsg = gsub(msg, "[@,./\\=]", "") -- Anything purposely not removed by Cleanse()
		for i=1, #chatLines do
			if chatLines[i] == cleanestMsg and chatPlayers[i] == guid then --If message same as one in previous 20 and from the same person...
				blockedLineId = lineId
				-- Reduce the chances of a spam report expiring (line id is too old) by refreshing it
				if spamCollector[guid] and S.is(msg) then
					local loc = PlayerLocation:CreateFromChatLineID(lineId)
					spamCollector[guid] = loc
					if BADBOY_OPTIONS.tipSpam then
						spamLogger[guid] = debug
					end
				elseif backupCollector[guid] and next(spamCollector) and S.is(msg) then
					local loc = PlayerLocation:CreateFromChatLineID(lineId)
					backupCollector[guid] = loc
				end
				--
				return
			end
			if i == 20 then tremove(chatLines, 1) tremove(chatPlayers, 1) end --Don't let the DB grow larger than 20
		end
		chatLines[#chatLines+1] = cleanestMsg
		chatPlayers[#chatPlayers+1] = guid
	end
	--End text buffer

	if S.is(msg) then
		if event == "CHAT_MSG_SAY" or event == "CHAT_MSG_YELL" then
			-- Awful way of disabling chat bubbles when spam is detected.
			-- Chat bubbles are processed internally by the game client AFTER all the addon event handlers are fired.
			if GetCVarBool("chatBubbles") then
				enableBubble = true
				SetCVar("chatBubbles", 0)
			end
		end
		if not BADBOY_OPTIONS.freqButton then
			for i = 1, #S[et] do
				if strfind(msg, S[et][i]) then
					blockedLineId = lineId
					return
				end
			end
		end
		if BadBoyLog then
			BadBoyLog("BadBoy", event, trimmedPlayer, debug)
		end
		if not BADBOY_BLACKLIST[guid] and not IsEncounterInProgress() then
			local loc = PlayerLocation:CreateFromChatLineID(lineId)
			spamCollector[guid] = loc
			if BADBOY_OPTIONS.tipSpam then
				spamLogger[guid] = debug
				if btn:IsShown() and reportFrame:IsMouseOver() then
					GameTooltip_Hide()
					reportFrame:GetScript("OnEnter")(reportFrame) -- Add more spam to tooltip if shown
				end
			end

			local t = GetTime()
			if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
				if prevShow == 0 then
					prevShow = t+25
					-- Delay the first one to grab more spam on really bad realms
					C_Timer.After(25, function() btn:Show() end)
				else
					prevShow = t
					btn:Show()
				end
			end
		end

		if BADBOY_BLACKLIST[guid] then
			-- We have already reported this person today. We won't show the button again, but add them to the backup table to report them
			-- again only if we click the button for other spam, to completely eliminate processing their chat, improving performance.
			local loc = PlayerLocation:CreateFromChatLineID(lineId)
			backupCollector[guid] = loc
		end

		blockedLineId = lineId
		return
	elseif next(spamCollector) then
		local t = GetTime()
		if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
			prevShow = t
			btn:Show()
		end
	end
end
local filterFunc = function(_, _, _, _, _, _, _, _, _, _, _, _, lineId)
	if blockedLineId == lineId then
		return true
	end
end

do
	btn = CreateFrame("Frame", nil, ChatFrame1)
	btn:SetWidth(50)
	btn:SetHeight(50)
	btn:SetPoint("BOTTOMRIGHT", 18, -20)
	btn:SetFrameStrata("DIALOG")
	local tx = btn:CreateTexture()
	tx:SetAllPoints(btn)
	tx:SetMask("Interface\\CharacterFrame\\TempPortraitAlphaMask")
	tx:SetTexture(132360) -- Interface/Icons/Ability_Warrior_ShieldMastery
	local animGroup = btn:CreateAnimationGroup()
	animGroup:SetLooping("REPEAT")
	local scale = animGroup:CreateAnimation("Scale")
	scale:SetOrder(1)
	scale:SetFromScale(0.25,0.25)
	scale:SetToScale(1,1)
	scale:SetDuration(0.4)
	local scale2 = animGroup:CreateAnimation("Scale")
	scale2:SetOrder(2)
	scale2:SetFromScale(1,1)
	scale2:SetToScale(0.25,0.25)
	scale2:SetDuration(0.4)
	scale2:SetEndDelay(8)
	animGroup:Play()
	btn:Hide()

	reportFrame = CreateFrame("Button", nil, btn)
	reportFrame:SetAllPoints(ChatFrame1)
	reportFrame:SetFrameStrata("DIALOG")
	local ticker = nil
	local tickerFunc = function()
		local canReport = false
		for k, v in next, spamCollector do
			if CanReportPlayer(v) then
				canReport = true
			else
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		end
		for k, v in next, backupCollector do
			if not CanReportPlayer(v) then
				backupCollector[k] = nil
			end
		end
		if not canReport then
			btn:Hide()
		end
	end
	btn:SetScript("OnShow", function()
		if ticker then ticker:Cancel() end
		ticker = C_Timer.NewTicker(5, tickerFunc)
		tickerFunc()
		-- Don't animate if the feature is disabled
		if animGroup:IsPlaying() and BADBOY_OPTIONS.noAnim then
			btn:SetWidth(12)
			btn:SetHeight(12)
			animGroup:Stop()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 0, -5)
		elseif not animGroup:IsPlaying() and not BADBOY_OPTIONS.noAnim then
			btn:SetWidth(46)
			btn:SetHeight(46)
			animGroup:Play()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 18, -20)
		end
	end)
	btn:SetScript("OnHide", function()
		if ticker then
			ticker:Cancel()
			ticker = nil
		end
	end)
	reportFrame:SetScript("OnClick", function(self, btn)
		if IsAltKeyDown() then -- Dismiss
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()
			for k in next, spamCollector do
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		else -- Report
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()

			local systemMsg = {GetFramesRegisteredForEvent("REPORT_PLAYER_RESULT")} -- Don't show the "Complaint Registered" message
			local calendarError = {GetFramesRegisteredForEvent("CALENDAR_UPDATE_ERROR")} -- Remove calendar error popup (Blizz bug)
			for i = 1, #systemMsg do
				systemMsg[i]:UnregisterEvent("REPORT_PLAYER_RESULT")
			end
			for i = 1, #calendarError do
				calendarError[i]:UnregisterEvent("CALENDAR_UPDATE_ERROR")
			end

			for k, v in next, spamCollector do
				if CanReportPlayer(v) then
					BADBOY_BLACKLIST[k] = true
					ReportPlayer("spam", v, "Reported by the BadBoy addon. If this seems wrong, tell the author @funkbw on Twitter.")
				end
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
			for k, v in next, backupCollector do
				if CanReportPlayer(v) then
					ReportPlayer("spam", v, "Reported by the BadBoy addon. If this seems wrong, tell the author @funkbw on Twitter.")
				end
				backupCollector[k] = nil
			end

			for i = 1, #systemMsg do
				systemMsg[i]:RegisterEvent("REPORT_PLAYER_RESULT")
			end
			for i = 1, #calendarError do
				-- There's a delay before the event fires
				C_Timer.After(5, function() calendarError[i]:RegisterEvent("CALENDAR_UPDATE_ERROR") end)
			end
		end
	end)
	reportFrame:SetScript("OnEnter", function(self)
		GameTooltip:SetOwner(self, "ANCHOR_CURSOR")
		GameTooltip:AddLine(S.spamBlocked, 1, 1, 1)
		GameTooltip:AddLine(S.clickToReport, 1, 1, 1)
		if next(spamLogger) then
			GameTooltip:AddLine(" ", 0.5, 0.5, 1)
			for k, v in next, spamLogger do
				GameTooltip:AddLine(v, 0.2, 1, 0)
			end
		end
		GameTooltip:Show()
	end)
	reportFrame:SetScript("OnLeave", GameTooltip_Hide)
end

--[[ Add Filters ]]--
do
	local f = CreateFrame("Frame")
	f:SetScript("OnEvent", eventFunc)
	local tbl = {
		"CHAT_MSG_CHANNEL",
		"CHAT_MSG_YELL",
		"CHAT_MSG_SAY",
		"CHAT_MSG_WHISPER",
		"CHAT_MSG_EMOTE",
		"CHAT_MSG_DND",
		"CHAT_MSG_AFK",
	}
	for i = 1, #tbl do
		local event = tbl[i]
		local frames = {GetFramesRegisteredForEvent(event)}
		f:RegisterEvent(event)
		ChatFrame_AddMessageEventFilter(event, filterFunc)
		for i = 1, #frames do
			local frame = frames[i]
			frame:UnregisterEvent(event)
			frame:RegisterEvent(event)
		end
	end
end

--[[ Blacklist ]]--
do
	local f = CreateFrame("Frame")
	f:RegisterEvent("ADDON_LOADED")
	f:RegisterEvent("PLAYER_LOGIN")
	f:SetScript("OnEvent", function(frame, event, addon)
		if addon == "BadBoy" then
			if type(BADBOY_OPTIONS) ~= "table" then BADBOY_OPTIONS = {} end
			if type(BADBOY_BLACKLIST) ~= "table" then BADBOY_BLACKLIST = {} end
			frame:UnregisterEvent(event)
		elseif event == "PLAYER_LOGIN" then
			-- Blacklist DB setup, needed since Blizz nerfed ReportPlayer so hard the block sometimes only lasts a few minutes.
			local dateTbl = C_DateAndTime.GetCurrentCalendarTime()
			local day = dateTbl.monthDay
			if BADBOY_BLACKLIST.dayFromCal ~= day then
				BADBOY_BLACKLIST = {dayFromCal = day} -- Can't use ADDON_LOADED as date function isn't always ready on very first login.
			end
			SetCVar("spamFilter", 1)
			frame:UnregisterEvent(event)
			BADBOY_OPTIONS.tmp = nil
			BADBOY_OPTIONS.tmpm = nil
			BADBOY_OPTIONS.tmpl = nil
			BADBOY_OPTIONS.freqButton = nil

			-- Chat bubble restore
			frame:SetScript("OnEvent", function()
				if enableBubble then
					enableBubble = false
					SetCVar("chatBubbles", 1)
				end
			end)
			-- Hopefully we never end up in a situation where we've permanently disabled chat bubbles for the user.
			frame:RegisterEvent("PLAYER_LOGOUT")
			frame:RegisterEvent("CHAT_MSG_MONSTER_SAY")
			frame:RegisterEvent("CHAT_MSG_MONSTER_YELL")
		end
	end)
end

_G.BadBoyIsFriendly = IsFriendly
_G.BadBoyCleanse = Cleanse
