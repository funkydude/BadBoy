
-- GLOBALS: BADBOY_BLACKLIST, BADBOY_OPTIONS, BadBoyLog, ChatFrame1, GetTime, print, CalendarGetDate
-- GLOBALS: GameTooltip, C_Timer, IsEncounterInProgress, GameTooltip_Hide
local _, S = ...
S.gnt(157,"214,233,237,221,226,219,179,230,233,226,217,231,215,213,228,217,207,213,219,209^210,235,232,207,214,231,232,209,225,237,235,227,235,219,227,224,216,162,158,215,231,219,227,231,223,221,226^210,214,233,237,221,226,219,215,231,219,227,223,217,237^217,236,215,220,213,226,219,221,226,219,230,231,219,227,224,216^210,231,217,224,224,221,226,219,231,227,225,217,215,231,219,227,215,213,231,217^235,232,207,214,231,209,230,233,226,217,231,215,213,228,217,213,215,215,227,233,226,232^210,214,233,237,221,226,219,227,231,230,231,219,227,224,216,235,221,232,220,235,227,235,219,227,224,216^210,214,233,237,221,226,219,215,231,219,227,223,226,221,207,218,234,209,217^210,235,232,207,231,232,209,213,215,215,227,233,226,232,235,221,232,220^230,233,226,217,231,215,213,228,217,219,227,224,216,218,227,230,235,227,235,219,227,224,216^210,235,232,214,230,231,219,228,152^215,213,231,221,226,227,162,158,153,216,159,236,166,162,158,153,216,159,236,167^210,235,232,207,214,231,209,153,216,159,216,213,237,162,158,219,213,225,217,215,213,230,216^216,227,233,214,224,217,162,158,232,230,221,228,228,179,224,217,162,158,215,213,231,221,226,227^210,214,233,237,221,226,219,215,220,217,213,228,215,231,219,227,231,223,221,226^235,213,226,232,232,227,231,217,224,224,207,163,208,209,214,233,237,215,231,219,227,221,232,217,225^215,213,231,221,226,227,162,158,216,221,215,217,162,158,153,216,159,162,158,232,230,221,228,224,217^219,227,224,216,162,158,232,230,221,228,228,179,224,217,162,158,215,213,231,221,226,227^210,235,232,207,214,231,232,209,231,227,225,217,215,231,219,227,231,223,221,226^235,232,231,235,227,235,213,215,215,227,233,226,232,162,158,217,228,221,215^210,235,232,231,215,220,217,213,228,213,226,216,218,213,231,232,219,227,224,216^210,235,232,214,219,227,224,216,162,158,225,227,233,226,232^210,235,232,207,214,231,209,219,213,225,217,215,213,230,216^210,214,233,237,221,226,219,215,231,153,162,179,219,207,164,227,209,231,223,221,226^210,219,227,232,213,226,237,230,233,226,217,231,215,213,228,217,219,227,224,216,163,235,225,217^210,235,232,207,214,231,232,209,230,231,164,171,219,227,224,216^210,235,232,207,214,231,232,209,215,231,219,227,223,226,221,207,218,234,209,217^230,227,224,224,219,213,225,214,224,217,162,158,153,216,159,162,158,224,227,231,217,153,216,159,162,158,235,221,226,162,158,153,216,159^235,232,207,214,231,232,209,230,231,167,179,219,227,224,216,162,158,235,227,235,219,227,224,216^210,235,232,207,214,231,209,153,216,159,225,227,226,232,220,162,158,219,213,225,217,232,221,225,217^210,235,232,207,214,231,209,228,230,217,228,213,221,216,219,213,225,217,215,213,230,216^210,231,217,224,224,221,226,219,215,231,219,227,231,223,221,226^219,213,225,214,224,217,162,158,230,227,224,224,162,158,236,166,162,158,230,227,224,224,162,158,236,169^210,235,232,207,214,231,232,209,215,231,219,227,215,213,231,217^210,235,232,207,214,231,232,209,215,231,219,227,223,217,237^210,235,232,214,227,231,230,231,219,228^210,235,232,207,214,231,232,209,215,231,219,227,231,232,217,213,225,219,221,218,232^224,233,215,223,162,158,230,227,224,224,162,158,153,216,159,223,162,158,225,221,226,233,232,217,231,162,158,228,231,232^215,213,231,221,226,227,162,158,224,217,219,221,232,162,158,231,213,218,217,162,158,215,213,231,221,226,227^210,232,230,213,216,221,226,219,235,227,235,219,227,224,216,218,227,230,227,179,231,179,230,231,219,227,224,216^210,235,232,207,214,231,232,209,215,231,219,227,221,232,217,225^210,235,232,207,214,231,209,213,179,226,179,213,235,217,231,227,225,217,230,231,213,215,215,227,233,226,232^235,232,207,214,231,209,235,227,235,219,227,224,216,162,158,230,231,219,227,224,216^210,235,232,207,214,231,209,219,227,231,223,221,226,231^210,235,232,207,214,231,209,219,213,225,217,215,227,216,217^210,235,232,207,214,231,209,207,167,170,209,164,216,213,237,231,179,228,230,217,228,213,221,216,219,213,225,217,232,221,225,217^230,227,224,224,162,158,153,216,159,162,158,230,227,224,224,162,158,153,216,159,162,158,214,217,232^215,213,231,221,226,227,162,158,230,227,224,224,162,158,153,216,159,162,158,230,227,224,224,162,158,153,216,159^235,227,235,219,227,224,216,218,227,230,215,231,219,227,223,217,237^210,231,217,224,224,221,226,219,215,231,219,227,215,213,231,217^230,227,224,224,162,158,235,221,226,162,158,216,227,233,214,224,217,162,158,225,221,226,162,158,225,213,236^235,232,207,214,231,209,162,158,230,233,226,217,231,215,213,228,217,225,227,226,217,237,162,158,153,216,159,223^210,235,232,207,214,231,232,209,215,231,219,227,215,216,223,217,217,179,237^210,235,232,207,214,231,209,230,231,213,215,215,227,233,226,232^210,235,232,207,214,231,209,153,216,159,230,231,213,215,215,227,233,226,232^210,219,227,232,231,227,225,217,230,231,164,171,163,179,230,179,231,179,167,179,219,227,224,216,224,213,237,221,226,219,213,230,227,233,226,216,162,158,225,217^235,232,207,214,231,209,235,227,235,219,227,224,216,162,158,230,231,215,227,221,226,232,179,231^210,235,232,207,214,231,209,228,230,217,228,213,221,216,215,213,230,216^210,235,232,232,235,227,235,219,218,227,230,230,231,164,171,219^215,213,231,221,226,227,162,158,214,217,232,162,158,153,216,159^210,235,232,207,214,231,232,209,213,226,237,215,231,219,227,231,223,221,226^210,235,232,231,215,220,217,213,228,219,227,224,216^216,221,215,217,162,158,236,166,162,158,236,167,162,158,214,217,232,231^215,231,219,227,231,223,221,226,231,162,158,219,227,224,216,162,158,231,220,227,228,162,158,225,227,233,226,232,231^210,235,232,207,214,231,232,209,215,220,217,213,228,215,231,219,227,231,223,221,226^215,213,231,221,226,227,162,158,235,220,221,231,228,217,230,162,158,221,226,218,227^210,235,232,231,153,216,159,216,213,237,231,179,219,213,225,217,232,221,225,217^214,217,232,162,158,230,227,224,224,162,158,236,166,162,158,236,167,162,158,225,221,226,162,158,225,213,236^230,227,224,224,162,158,219,213,225,217,162,158,219,227,224,216,162,158,235,221,226,162,158,224,227,235,217,230^224,233,215,223,162,158,230,227,224,224,162,158,216,227,233,214,224,217,162,158,219,227,224,216^210,235,232,231,153,216,159,216,213,237,231,179,219,213,225,217,215,213,230,216^210,235,232,207,214,231,232,209,215,231,219,227,213,215,215^153,216,159,162,158,216,207,227,233,209,207,233,214,209,214,224,217,162,158,153,216,159,162,158,232,230,221,228^210,232,230,213,216,221,226,219,215,231,219,227,162,158,219,227,224,216^215,213,231,221,226,227,162,158,163,235,162,158,153,216,159,162,158,230,227,224,224^210,235,232,207,214,231,232,209,223,217,237,231,221,226,215,231,219,227^210,235,232,232,235,227,235,219,218,227,230,227,231,230,231,219^210,235,232,232,235,227,235,219,227,224,216,218,227,230,227,231,230,231^210,235,232,207,214,231,232,209,215,231,231,223,221,226,231^210,235,232,207,231,214,232,209,235,227,235,219,227,224,216,218,227,230,215,231,219,227,231,223,221,226^230,227,233,224,217,232,232,217,162,158,230,227,224,224,162,158,166,236,162,158,167,236^210,235,232,207,214,231,232,209,225,237,219,227,224,216,218,227,230,215,231,219,227,231,223,221,226^210,219,227,232,213,226,237,230,231,164,179,167,163,230,231,164,179,171,219,227,224,216,224,213,237,221,226,219,213,230,227,233,226,216,162,158,219,227,227,216,227,218,218,217,230^210,235,232,207,214,231,232,209,215,231,153,162,179,219,227,231,223,221,226^210,235,232,207,214,231,209,219,213,225,217,232,221,225,217^210,235,232,231,153,216,159,223,218,227,230,153,216,159,217,233^210,235,232,207,231,232,209,235,227,235,213,215,215,227,233,226,232^210,235,232,232,235,227,235,219,227,224,216,218,227,230,227,224,216,231,215,220,227,227,224,230,231,219,227,224,216^210,235,232,207,214,231,232,209,215,231,219,227,215,220,217,213,228^210,231,217,224,224,221,226,219,219,227,224,216,231,179,218,227,230,215,231,219,227^235,232,207,214,231,209,230,233,226,217,231,215,213,228,217,219,227,224,216^210,235,232,207,214,231,209,214,213,224,213,226,215,217,228,213,237,228,213,224,214,237,219,227,224,216^210,235,232,207,214,231,232,209,224,217,219,221,227,226,215,179,216,179,223,217,237^235,213,226,232,232,227,214,233,237,207,163,208,209,231,217,224,224,215,231,219,227,221,232,217,225^210,235,232,207,214,231,232,209,219,227,224,216,218,227,230,215,231,219,227^215,213,231,221,226,227,162,158,230,227,224,224,162,158,216,227,233,214,224,217^232,230,213,216,221,226,219,225,237,235,227,230,224,216,227,218,235,213,230,215,230,213,218,232,219,227,224,216,218,227,230,162,158,230,233,226,217,231,215,213,228,217,219,227,224,216^235,232,207,214,231,209,230,233,226,217,231,215,213,228,217,228,233,230,217^210,235,232,214,153,216,159,225,164,171,219,228^210,214,233,237,221,226,219,230,231,167,231,232,233,218,218^210,235,232,207,214,231,232,209,215,231,219,227,215,213,225,227^210,235,232,214,219,227,224,216,162,158,219,213,225,217,232,221,225,217^219,227,224,216,218,227,230,230,233,226,217,231,215,213,228,217,219,227,224,216^215,213,231,221,226,227,162,158,153,216,159,162,158,216,227,233,214,224,217,162,158,153,216,159,162,158,232,230,221,228,228,179,224,217^216,207,227,233,209,207,233,214,209,214,224,217,162,158,153,216,159,162,158,232,230,221,228,228,179,224,217^210,231,217,224,224,221,226,219,215,231,219,227,221,232,217,225","211,346,307,291,348,289,262,161,350,247,291,345,304,299,221,348,259,256,346,303,284,166,346,254,258,166,221,166,166,347,266,280,220,350,245,276,347,274,282,226,226,347,274,282,153^233,222,233,214,227,222,234,226,215,214,238,163,159,228,215,233,218,227,218,239^211,233,228,217,214,238,233,228,232,174,164,174,163,159,220,234,214,231,214,227,233,218,218,163,159,232,218,233,232,163,159,220,218,233,226,228,234,227,233,163,159,217,218,233,214,222,225,232^216,221,218,216,224,163,159,236,228,236,221,234,227,233,154,163,227,218,233^222,227,219,228,163,159,236,218,215,232,222,233,218,163,159,223,234,232,233,215,228,228,232,233^226,238,233,221,222,216,163,159,224,218,238,163,159,234,229,220,231,214,217,218,163,159,226,214,232,233,218,231,163,159,214,216,221,222,218,235,163,159,232,224,222,227,163,159,236,218,218,224,225,238^236,233,232,163,159,232,224,238,229,218,163,159,215,228,228,232,233,222,227,220,221,218,225,229^211,232,218,225,220,218,231,215,222,225,225,222,220,220,234,225,225,163,159,232,224,238,229,218^211,232,312,283,225,220,218,231,220,234,225,217,163,159,236,221,222,232,229^348,252,248,348,248,284,348,259,256,346,303,284,166,166,166,346,250,285,350,245,271,346,272,279,163,159,347,268,277,347,255,305,345,301,258,346,305,303,346,253,299,346,250,285,348,285,256,347,267,268,238,234,345,301,299,348,251,255,226,214,228,348,272,297,215,228^174,171,165,174,173,170,215,228,232,232,163,159,231,228,225,225,346,301,246,346,250,258,349,297,302,163,159,346,257,250,349,306,289,347,273,258,347,273,303,348,282,285^211,232,228,224,218,231,154,217,160,224,235,222,214,232,236,222,232,221^219,214,216,218,215,228,228,224,154,163,216,228,226,164,232,229,231,239,218,217,214,223,224,228,227,233,228,229,225^346,307,291,345,308,278,163,159,166,173,165,170,174,168,174,172,170,171,165^211,232,312,283,225,220,218,231,220,208,228,234,210,225,217,163,159,226,228,215,222,225,218,229,214,238^346,281,284,346,302,306,348,246,298,349,270,259,171,170,165,346,253,245,161,348,259,293,349,297,284,348,284,263,346,260,262,161,346,250,289,350,301,278,161,350,290,265,350,307,270,346,261,249,348,284,258,233,216,220,348,259,293,349,297,284,233,168,346,282,268,349,280,250^211,236,233,232,226,228,234,227,233,219,231,228,226,220,234,225,217,214,227,226,238,233,221,222,216,163,159,219,214,232,233,216,221,218,214,229^230,230,163,159,166,170,166,168,174,169,166,173,166,169^227,228,220,218,227,217,218,231,232,224,214,225,224,228,215,218,226,228,227,233,163,159,222,227,219,228^211,232,312,283,225,220,218,231,220,234,225,217,219,228,231,154,217,160^345,308,278,166,173,166,172,170,166,168,171,171,165,167^230,230,167,172,174,166,167,169,171,168,166^236,233,232,163,159,166,165,165,166,166,165,163,159,214,216,216,232,221,214,231,218,163,159,215,228,229,226,228,234,227,233,163,159,233,225,229,217^211,236,233,232,220,231,218,214,233,229,231,222,216,218,232,163,159,214,227,233,228,231,234,232,163,159,221,218,231,228,222,216,226,214,232,233,218,231,225,228,228,233,163,159,233,228,217,214,238,154,217,154,217,154,217,154,217,163,159,219,228,231,226,228,231,218,222,227,219,228^211,232,233,238,225,218,346,250,289,345,305,271,347,256,272,346,261,249,349,246,257,345,301,271,348,259,286,346,291,299,219,214,231,226,346,260,283,346,281,267,346,250,289,345,305,271,219,214,231,226,221,348,259,256,346,303,284,346,257,250,346,272,279,347,273,254,347,296,266,346,301,253,217,224,350,287,262,348,254,284,347,273,292,346,274,262,226,348,259,256,346,303,284,166,174,347,273,258,346,255,278,346,270,285,172,348,247,302,346,305,245,347,254,264,153^211,232,312,283,225,220,218,231,220,229,231,222,232,222,224,224,218,219,214,232,225,214,220,233^232,224,238,229,218,163,159,229,235,218,232,221,228,229^211,220,234,225,217,219,222,227,227,232,215,222,225,225,222,220,233,181,232,236,222,232,221^211,220,234,225,217,154,217,160,224,163,159,224,231,163,159,232,224,238,229,218^211,221,348,259,256,346,303,284,346,257,250,346,272,279,350,286,289,345,301,255,346,305,245,347,254,264,226,348,259,256,346,303,284,153^232,312,283,225,220,218,231,220,234,225,217,235,222,214,226,229^325,308,228,226,228,325,299,218,226,163,159,227,222,220,221,233,226,228,227,218,238,208,154,163,161,210,231,234^230,230,163,159,167,173,170,166,172,168,166,173,173,172^211,214,227,233,228,231,234,232,163,159,215,234,231,227,222,227,220,233,221,231,228,227,218,163,159,164,166,166,163,159,236,222,233,221,226,225,163,159,219,214,232,233,216,221,218,214,229,163,159,229,232,233^218,229,222,216,216,214,231,231,238,154,163,227,218,233,163,159,235,222,232,222,233^211,221,348,259,256,346,303,284,346,257,250,346,272,279,350,286,289,345,301,255,347,254,264,226,348,259,256,346,303,284,153^346,250,285,348,307,259,350,283,267,347,274,245,346,250,289,345,305,271,163,159,225,222,226,222,233,163,159,346,252,303,346,265,291,346,260,295,349,292,268,163,159,346,260,281,346,293,265,345,301,302,346,274,261,350,287,262^224,225,239,163,159,347,254,280,166,169,173,169,169,172,166,167,167,169^219,214,232,233,169,220,228,225,217,208,154,163,161,210,216,228,226,163,159,232,228,233,216,224^216,228,227,233,214,216,233,163,159,233,222,233,214,227,222,234,226,215,214,238^346,307,291,345,308,278,163,159,220,228,225,217,219,228,231,232^211,232,228,224,218,231,220,235,222,214,232,236,222,232,221^233,222,233,214,227,222,234,226,215,214,238,163,159,218,237,233,231,214^235,222,232,222,233,163,159,236,228,236,215,228,229,154,163,216,228,226^211,232,312,283,225,220,218,231,220,234,225,217,235,222,214,232,236,222,229,229^211,220,234,225,217,219,222,227,227,232,163,159,224,228,229,214,163,159,232,236,222,232,221,153^211,219,222,227,227,232,154,217,154,217,160,224,161,154,217,154,217,160,224,231,235,222,214,232,236,222,232,221^229,233,164,221,163,159,239,225,232,161,239,219,217,161,230,226,232,163,159,346,273,280,348,254,286,161,350,282,293,346,264,246,346,261,249,348,296,304,347,299,253,349,297,302,161,346,260,283,347,273,254^232,224,238,229,218,163,159,223,214,232,226,222,227,218,215,214,215,238,165,169,165,173^228,219,219,218,231,163,159,218,229,222,216,216,214,231,231,238,208,161,154,163,210,216,228,226^230,230,167,170,166,166,168,165,169,174,168^211,214,227,233,228,231,234,232,163,159,215,234,231,227,222,227,220,233,221,231,228,227,218,163,159,164,166,166,163,159,236,222,233,221,226,225,163,159,219,214,232,233,216,221,218,214,229,163,159,226,218^345,308,278,346,260,300,166,170,168,165,173,169,168,170,171,166,166^216,225,214,232,232,163,159,219,215,226,233,218,214,226,154,163,216,228,226^211,233,228,217,214,238,233,228,232,174,164,174,163,159,219,214,232,233,231,234,227,163,159,220,218,214,231,233,222,218,231,163,159,219,228,231,220,218,233,233,222,233,214,227,232,163,159,222,227,219,228^211,232,214,225,223,218,231,220,222,220,218,227,163,159,232,233,228,216,224,163,159,232,218,224^232,312,283,225,220,218,231,220,234,225,217,163,159,229,231,222,232,218,231^217,222,232,216,228,231,217,233,215,166,165,165,165^235,222,232,222,233,163,159,232,222,226,229,225,218,216,214,231,231,238,154,163,216,228,226^345,308,278,168,174,167,166,167,168,165,170,168^235,237,223,222,227,220,237,234,214,227,168,168,169,169,170,167,166^348,259,256,346,303,284,163,159,347,273,245,349,308,262,346,293,260,346,308,248,345,304,282,345,306,299,346,281,286,350,301,308,346,261,258,345,302,254,346,267,255,348,271,249,350,287,268,346,290,261^235,222,232,222,233,163,159,236,228,236,221,234,227,233,154,163,227,218,233^233,222,233,214,227,222,234,226,215,214,238,163,159,220,231,214,233,222,232^232,224,238,229,218,163,159,221,218,225,226,222,231,172,170,172,173^211,226,214,231,222,227,214,347,268,284,345,301,267,348,266,257^211,232,214,225,223,218,231,220,234,225,217,163,159,232,224,238,229,218^230,230,163,159,167,167,172,173,165,169,173,166,172,174^235,237,217,214,222,236,228,236,173,173,173^345,308,278,217,214,222,236,228,236,173,173,173^232,224,238,229,218,163,159,215,233,214,220,163,159,229,231,218,233,233,238,218,225,218,227,214^325,308,229,228,325,297,214,325,297,325,301,226,231,229,228,325,294,325,306,325,301,326,251,238,163,159,325,308,228,325,297,214,229,228,224,163,159,325,295,325,308,226^346,267,255,166,346,260,300,350,274,279,346,254,258,221,348,259,256,346,303,284,166,166,166,346,250,285,350,245,271,347,304,278,225,225,228,346,258,296,346,260,292,346,282,268,349,280,250,164,350,282,293,346,264,246,164,346,273,280,348,254,286,347,257,262,347,247,285,346,267,273,347,289,279,348,271,249,347,256,308,346,252,303,345,301,245,345,304,299,345,304,269,345,301,245,345,304,299^231,228,325,304,325,297,214,208,154,163,161,210,229,326,249,163,159,235,222,232,214^217,218,214,225,232,163,159,218,229,222,216,216,214,231,231,238,154,163,227,218,233^235,345,308,278,163,159,166,170,165,170,168,173,166,174,165,172^211,236,233,232,163,159,214,233,154,217,154,217,163,159,214,227,233,228,231,234,232,163,159,164,166,166,163,159,226,214,232,233,218,231,163,159,215,218,232,233,229,231,222,216,218^215,228,228,232,233,163,159,218,237,233,231,218,226,218,225,238,163,159,219,214,232,233,163,159,166,165,165,166,166,165^211,220,234,180,225,180,217,180,219,222,227,227,232,181,232,236,222,232,221^235,222,232,222,233,163,159,214,227,233,214,231,218,232,215,228,228,232,233,154,163,216,228,226^232,224,238,229,218,163,159,223,234,232,233,222,227,154,163,229,225,214,216,228,232^226,238,233,221,222,216,163,159,216,228,214,216,221,222,227,220,163,159,226,226,228,229,231,228,219^211,226,214,231,222,227,214,348,288,275,347,255,245,346,273,303^229,231,222,216,218,163,159,232,224,238,229,218,163,159,233,228,232,226,238,233,221,222,216^233,222,225,215,234,217,163,159,232,312,283,225,220,218,231,154,217,160,224,163,159,226,228,215,222,225,218,229,214,238^346,307,291,345,308,278,163,159,232,218,232,218,220,228,225,217^229,235,229,163,159,236,214,225,225,220,214,226,222,227,220,208,154,163,161,210,216,228,226^222,227,219,228,163,159,215,208,228,165,210,208,228,165,210,226,215,208,228,165,210,208,228,165,210,232,233,161,216,208,228,165,210,226^345,308,278,170,169,174,174,171,170,173,168,173^211,236,233,215,220,208,228,234,210,225,217,235,222,214,232,236,222,232,221^221,348,259,256,346,303,284,346,257,250,346,272,279,350,286,289,345,301,255,347,254,264,226,348,259,256,346,303,284,163,159,221,348,259,256,346,303,284,346,257,250,346,272,279,350,286,289,345,301,255,347,254,264,226,348,259,256,346,303,284^220,228,225,217,169,228,224,208,154,163,161,210,216,228,226,163,159,232,228,233,216,224^224,228,215,228,225,217,163,159,232,229,231,239,218,217,214,223,224,228,227,233,228,208,154,163,161,210,229,225^345,308,278,163,159,172,172,173,170,173,172,168,166,171^220,234,222,225,217,163,159,232,221,214,217,228,236,215,228,228,232,233,154,163,216,228,226^211,220,219,222,227,227,232,215,222,225,225,222,220,233,153^230,230,163,159,168,166,174,169,170,167,166,173,169,173^211,348,252,248,348,248,284,348,259,256,346,303,284,349,256,294,350,272,249,346,257,250,346,272,279,163,159,226,348,259,256,346,303,284,346,257,250,346,272,279,345,306,259,345,308,274,346,260,281,346,293,265,345,301,302,346,274,261,350,287,262,163,159,347,267,293,348,284,258,347,268,260,167,228,222,222,228^211,232,214,225,223,218,231,220,234,225,217,232,227,214,215,215,233,235,222,214,232,236,222,232,221^230,230,163,159,169,171,174,173,171,170,169,173,170^219,234,225,225,216,225,218,214,231,163,159,215,208,228,165,210,208,228,165,210,232,233,163,159,220,218,233,215,222,232,220,218,214,231,163,159,221,218,225,225,219,222,231,218,222,227,219,218,231,227,214,225,163,159,226,228,231,218,222,227,219,228^349,308,269,347,273,254,346,253,288,348,271,249,347,254,245,347,273,254,345,301,271,346,255,278,161,180,347,289,279,349,308,259,346,263,285,349,292,279^346,307,291,345,308,278,163,159,167,167,169,172,171,173,167,170,166,167^211,232,214,225,223,218,231,220,234,225,217,164,236,153^349,255,292,223,222,227,220,237,234,214,227,168,168,169,169,170,167,166^211,232,312,283,225,220,218,231,220,234,225,217,163,159,232,224,231,222,235,233,222,225,226,222,220^216,228,227,233,214,216,233,163,159,218,229,222,216,216,214,231,231,238,208,154,163,161,210,216,228,226^236,218,215,232,222,233,218,163,159,218,229,222,216,216,214,231,231,238^346,301,246,163,159,346,307,291,345,308,278,232,233,238,238,225,218,218^232,233,228,231,226,214,227,220,217,220,234,225,217,222,227,227,218,163,159,219,222,227,227,232,215,222,225,225,222,220,233^236,233,232,233,228,226,215,163,159,225,222,226,222,233,218,217,163,159,232,229,218,216,222,219,222,216,163,159,223,234,232,233,219,228,231,238,228,234,163,159,220,218,214,231^211,221,214,231,220,234,225,217,163,159,232,236,222,232,221,215,222,225,225,222,220,233^236,228,236,221,234,227,233,154,163,216,228,226,163,159,217,218,233,214,222,225,232^211,232,214,225,223,218,231,220,161,163,159,232,224,231,222,235^211,225,214,226,218,222,225,225,218,234,231,218,218,230,234,222,229,218,218,227,218,234,231,228,229,218,235,228,234,232,214,222,217,218,231,214,214,235,218,216,214,227,233,228,231,234,232,221,218,231,228,222,230,234,218,166,166,164,166,166,218,233,226,238,233,221,222,230,234,218,166,170,153^174,169,170,174,173,170,163,159,239,219,217,239,225,232,230,226,232,163,159,347,259,282,346,260,295,349,292,268,348,252,248,348,248,284,348,259,256,346,303,284,346,257,250,347,292,266,345,301,271^232,224,238,229,218,163,159,216,214,225,235,222,227,154,163,219,231,218,218,239,218^226,228,231,218,222,227,219,228,163,159,216,221,222,218,219,215,228,228,232,233,154,163,180,227,218,233^236,233,232,163,159,236,222,233,221,226,225,163,159,221,222,220,221,230,234,214,225,222,233,238,163,159,215,222,220,217,222,232,216,228,234,227,233^211,216,228,220,348,307,259,347,273,258,346,300,282,345,306,273,346,291,281^211,229,220,229,346,300,282,345,306,273,346,291,281,345,306,259,345,308,274^211,232,218,225,225,222,227,220,220,234,225,217,214,227,226,228,234,227,233,221,218,225,225,219,222,231,218,222,227,219,218,231,227,214,225,215,218,232,233,229,231,222,216,218^211,236,233,232,221,216,226,238,233,221,222,216,163,159,221,218,225,225,219,222,231,218,216,228,231,218,163,159,226,238,233,221,222,216,166,170,217,234,227,220,218,228,227,232^227,228,220,218,227,163,159,232,224,214,225,224,228,215,218,220,163,159,222,227,219,228^326,251,218,325,306,208,214,218,210,163,159,225,228,228,233,224,218,218,229,218,231,208,154,163,161,210,216,228,226^211,220,235,222,214,232,236,222,232,221,163,159,232,224,238,229,218^231,214,233,222,227,220,232,163,159,216,228,214,216,221,222,227,220,163,159,225,218,220,218,227,217,214,231,238,163,159,229,231,222,239,218,232,163,159,220,228,225,217,163,159,222,227,219,228^226,214,227,220,225,218,231,217,234,220,228,225,217,163,159,224,231,228,227,218,231,163,159,226,228,215,222,225,218,229,214,238^211,232,214,225,223,218,231,220,234,225,217,235,222,214,232,236,222,232,221^211,221,214,231,154,217,160,224,233,222,225,225,232,214,225,234,235,222,214,232,236,222,232,221^216,214,325,302,233,163,159,224,222,227,220,220,228,225,217,208,154,163,161,210,231,234^346,307,291,345,308,278,163,159,167,171,171,167,172,174,174,166,168,169^235,222,232,222,233,163,159,226,226,208,228,165,210,225,235,225,208,154,163,161,210,216,208,165,228,210,226^230,161,180,230,166,165,168,173,170,174^232,312,283,225,220,218,231,220,163,159,154,217,160,224,231,180,229,231^345,301,287,345,303,303,346,264,246,347,301,280,346,290,261,163,159,229,231,228,219,228,234,227,217,232,218,214^211,236,233,232,214,227,233,228,231,234,232,163,159,227,228,231,226,214,225,214,227,217,221,218,231,228,222,216,163,159,229,218,231,232,228,163,159,226,214,232,233,218,231,163,159,236,218,218,224,225,238,216,221,218,232,233,219,228,231^232,312,283,225,220,218,231,225,222,217,233,220,234,225,217,163,159,226,228,215,222,225,218,229,214,238^232,229,218,225,229,218,227,220,214,231,219,222,227,227,232,233,222,225,225,220,214,227,220,225,222,220,233,235,222,214,232,236,222,232,221^211,224,228,229,218,231,220,235,222,214,232,236,222,232,221^348,252,248,348,248,284,348,259,256,346,303,284,349,256,294,350,272,249,346,257,250,346,272,279,347,273,245,346,293,262,166,165,163,159,226,166,226,166,166,345,301,287,345,303,303,347,256,307,346,260,267,345,306,259,345,308,274,346,260,281,346,293,265,345,301,302,346,274,261,350,287,262,163,159,167,165,166,166,165^221,234,231,231,238,234,229,163,159,226,214,220,218,233,228,236,218,231,163,159,232,218,231,235,222,216,218,232,163,159,217,234,227,220,218,228,227^230,348,307,281,163,159,166,167,167,173,172,166,171,172,166^211,217,214,227,232,224,220,234,225,217,163,159,225,218,235,218,231,222,227,220,163,159,154,217,160,224^216,233,214,233,325,301,224,163,159,216,224,214,325,302,325,308,163,159,229,235,218,233,228,229^232,224,238,229,218,163,159,228,239,238,215,228,228,232,233^229,231,222,216,218,163,159,215,208,165,228,210,208,165,228,210,226,215,208,165,228,210,208,165,228,210,232,233,208,154,163,161,210,216,208,165,228,210,226^236,233,232,163,159,225,228,228,233,231,214,222,217,163,159,220,225,228,231,238,163,159,226,228,234,227,233,232,163,159,226,228,231,218,222,227,219,228^227,228,220,225,218,220,163,159,232,312,283,225,220,218,231,228,235,218,231,226,228,215,222,225,218,229,214,238^346,307,291,345,308,278,163,159,166,170,165,170,168,173,166,174,165,172^232,312,283,225,220,218,231,154,217,160,224,220,234,225,217,163,159,226,228,215,222,225,218^220,234,225,217,163,159,232,224,238,229,218,163,159,225,218,235,218,231,214,227,232^211,232,214,225,223,218,231,220,215,222,225,225,222,220,233,235,222,214,232,236,222,232,221^232,218,225,225,222,227,220,163,159,218,225,222,233,222,232,233,220,214,226,222,227,220,208,154,163,161,210,216,228,226^233,222,233,214,227,222,234,226,215,214,238,163,159,226,222,227,234,233,208,218,228,210^232,224,238,229,218,163,159,220,218,231,214,225,217,215,214,230^211,232,214,225,223,218,231,236,228,236,220,234,225,217,220,218,227,228,226,232,236,222,232,221^232,214,225,223,218,231,220,234,225,217,163,159,217,218,233,214,222,225,163,159,232,233,228,216,224^211,232,214,225,223,218,231,236,228,236,220,234,225,217,163,159,232,236,222,232,221^211,227,214,220,228,227,232,228,226,232,228,224,218,231,220,234,225,217,214,233,233,224,228,229,214^211,232,312,283,225,220,218,231,220,236,221,222,232,229,218,231,153^325,300,228,325,304,228,233,228,163,159,219,234,227,226,226,228,154,163,231,234^236,233,232,163,159,233,216,220,226,228,234,227,233,232,163,159,220,208,228,165,210,225,217,163,159,232,214,225,218^346,265,291,346,307,291,163,159,173,174,169,170,173,165,167,168,166^211,236,233,232,214,227,233,228,231,234,232,163,159,236,222,233,221,225,228,228,233,163,159,226,238,233,221,217,234,227,220,218,228,227,232,163,159,174,154,217,154,217,222,233,218,226^217,235,222,227,220,163,159,238,216,325,304,238,231,325,301,163,159,217,235,222,227,220^230,230,163,159,166,165,165,173,169,170,174,174,170^211,236,233,232,214,227,233,228,231,234,232,161,180,233,221,218,215,234,231,227,222,227,220,233,221,231,228,227,218,221,218,231,228,222,216,166,166,164,166,166,163,159,226,225,229,225^211,232,228,220,218,231,218,227,217,214,227,232,224,220,228,225,217,232,312,283,225,220,218,231^345,308,278,228,224,169,220,228,225,217^211,215,222,225,225,222,220,233,220,234,225,217,219,222,227,227,232,222,227,227,218,153^211,220,234,225,217,222,227,227,218,163,159,215,218,233,214,225,227,222,227,220,235,222,214,232,236,222,232,221^211,215,222,225,225,222,220,233,220,234,225,217,235,222,214,232,236,222,232,221^232,312,283,225,220,218,231,220,234,225,217,163,159,222,227,219,228^236,233,232,214,227,233,228,231,234,232,163,159,217,234,227,220,218,228,227,232,163,159,220,225,228,231,238,163,159,221,218,225,225,219,222,231,218,216,228,231,218^211,220,234,225,217,232,214,225,223,218,232,215,222,225,225,222,220,233,163,159,232,236,222,232,221^346,291,254,347,254,269,350,295,246,347,267,292,161,348,252,248,348,248,284,348,259,256,346,303,284,163,159,346,305,303,346,255,272,346,272,279,350,269,276,161,347,259,254,349,261,306,174,169,170,174,173,170,349,280,250,346,281,252,347,273,254,346,282,268,349,280,250,164,350,282,293,346,264,246,164,346,273,280,348,254,286,346,250,285,348,285,256,348,272,297,347,263,290,161,346,292,251,347,253,262,349,308,272,346,272,279^211,236,233,232,233,228,226,215,163,159,232,214,231,220,218,231,214,232,163,159,227,228,231,226,214,225,163,159,221,218,231,228,222,216,163,159,229,218,231,232,228,227,214,225,163,159,226,214,232,233,218,231,163,159,226,238,233,221,222,216,163,159,217,234,227,220,218,228,227,232^220,228,225,217,163,159,220,208,228,165,210,225,217,216,218,208,228,165,210,208,154,163,161,210,216,208,228,165,210,226^230,230,163,159,166,169,168,168,170,168,170,171,167,173^211,232,214,225,223,218,231,220,234,225,217,161,232,236,222,232,221^235,222,232,222,233,163,159,216,214,231,231,238,215,228,228,226,208,154,163,161,210,216,228,226^235,222,232,222,233,223,215,232,233,154,163,229,231,228^211,220,234,225,217,219,222,227,227,232,214,233,233,224,228,229,214,215,222,225,225,222,220,233^236,218,215,232,222,233,218,163,159,218,215,214,238,220,228,225,217,232,154,163,216,228,226^220,234,222,225,217,222,232,232,218,225,225,163,159,214,231,220,234,232,163,159,224,214,231,214,239,221,214,227,226,228,234,227,233,163,159,224,222,225,225,216,228,226,218,214,227,217,220,218,233,163,159,215,218,219,228,231,218,231,218,226,228,235,218,217^211,235,222,225,225,227,214,220,228,227,224,228,229,214,220,234,225,217,163,159,232,214,225,223,218,231,234,180,233,180,226,222,233,233,215,222,225,225,222,220,233^216,228,227,233,214,216,233,163,159,218,229,222,216,216,214,231,231,238,208,154,163,161,210,227,218,233^230,230,166,174,172,166,172,165,173,166,168,172,163,159,232,224,238,229,218^220,228,228,220,225,218,163,159,218,229,222,216,216,214,231,231,238^237,222,227,215,214,215,218,238,166,166,167,168^211,221,348,259,256,346,303,284,346,257,250,346,272,279,349,297,305,347,296,266,346,307,300,346,258,255,345,304,300,346,281,249,348,261,251,348,259,293,346,273,285,346,305,245,347,254,264,346,281,284,349,245,246,349,270,259,350,301,278,349,272,256,348,259,293,349,297,284,345,306,259,345,304,300,226^211,236,233,232,229,228,236,218,231,225,218,180,235,218,180,225,222,227,220,163,159,214,231,233,222,219,214,216,233^211,232,214,225,223,218,231,220,234,225,217,181,232,236,222,232,221^230,230,163,159,170,174,168,173,168,172,165,168,166^211,236,233,232,214,227,233,228,231,234,232,163,159,236,222,233,221,225,228,228,233,159,163,159,166,170,217,234,227,220,218,228,227,163,159,174,154,217,154,217,222,233,218,226^211,348,259,256,346,303,284,346,257,250,346,272,279,348,248,290,346,258,267,345,301,290,161,347,296,266,346,301,253,346,278,265,161,346,260,295,349,292,268,346,274,261,350,287,262,153^346,260,300,346,254,258,161,349,256,294,350,272,249,163,159,345,301,258,346,305,303,346,253,299,347,299,253,349,297,302,161,345,301,258,347,265,299,347,255,305,350,252,262,163,159,345,301,245,346,292,302,345,301,245,349,297,297,346,308,248,347,273,258,346,255,278,347,274,282,350,273,245,346,282,268,349,280,250,350,282,293,346,264,246,346,273,280,348,254,286,347,266,280,345,304,299^211,220,234,225,217,235,222,214,232,236,222,232,221^236,233,232,226,238,233,221,222,216,231,234,227,232,219,228,231,225,228,228,233,163,159,221,218,225,229,238,228,234,216,225,218,214,231,163,159,217,234,227,220,218,228,227,228,219,238,228,234,231,216,221,228,222,216,218,163,159,236,218,214,225,232,228,217,228,224,218,238,232,233,228,227,218,234,229,220,231,214,217,218,232^217,222,232,216,228,231,217,233,215,172,165,165,165^232,224,238,229,218,163,159,227,222,220,221,233,219,222,231,218,236,228,236,163,159,220,228,228,217^227,228,220,225,218,220,163,159,232,312,283,225,220,218,231,235,222,214,226,228,215,222,225,218,229,214,238^211,236,233,232,214,227,233,228,231,234,232,161,180,233,221,218,215,234,231,227,222,227,220,233,221,231,228,227,218,163,159,227,228,231,226,214,225,214,227,217,221,216,163,159,229,225,214,227,217,226,225,231,234,227,153^211,232,312,283,225,220,218,231,220,234,225,217,163,159,154,217,160,224,219,228,231,154,217,160,224,231^221,218,231,218,226,226,208,165,228,210,225,235,225,154,163,180,216,208,165,228,210,226^325,300,228,325,304,228,233,228,163,159,226,226,228,214,221,208,154,163,161,210,231,234^230,230,163,159,168,169,170,165,168,169,170^345,308,278,226,232,232,223,219,236^211,215,218,221,228,235,218,231,217,234,220,181,232,236,222,232,221^211,232,214,227,214,220,228,227,163,159,224,228,229,214,220,234,225,217,153^217,222,232,216,228,231,217,163,159,226,214,225,229,228,228,232,167,167,173,169^224,228,229,214,220,234,225,217,232,214,225,223,218,231,223,214,220,234,233,226,222,233,233^211,220,235,222,214,232,236,222,232,221,219,222,227,227,232^211,227,214,220,228,227,232,228,226,232,214,225,223,218,231,220,234,180,225,180,217,180,235,222,214,232,236,222,232,221^346,307,291,345,308,278,239,239,236,233,168,168,168^215,222,225,225,222,220,214,232,233,218,220,234,225,217,163,159,154,217,160,224,163,159,226,214,227,220,217,231,214,215,214,233,233^211,220,234,225,217,219,222,227,227,232,229,214,232,236,222,232,221^211,236,233,232,233,228,226,215,163,159,174,164,174,163,159,236,222,233,221,208,226,229,210,225,163,159,214,225,225,216,225,214,232,232,218,232,214,235,214,222,225,163,159,216,228,226,218,220,218,233,238,228,234,231^211,226,348,259,256,346,303,284,154,217,160,346,257,250,346,272,279,349,297,305,347,296,266,346,307,300,350,287,262,348,254,284,347,273,292,347,273,258,346,255,278,346,270,285,154,217,160,348,247,302,346,305,245,347,254,264,348,254,302,345,304,300,346,258,267,346,252,303,346,265,291,346,261,249,348,284,258,346,258,278,348,254,257,346,274,261,350,287,262,153^232,312,283,225,220,218,231,220,234,225,217,163,159,232,224,238,229,218^232,224,238,229,218,163,159,214,229,229,228,225,214,237,168,165,173,170^215,228,228,232,233,222,227,220,208,154,163,161,210,229,231,228,163,159,226,228,234,227,233^236,233,232,163,159,221,218,231,228,222,216,236,222,233,221,226,225,163,159,215,222,220,217,222,232,216,228,234,227,233,163,159,216,228,226,218,220,218,233,238,228,234,231^211,226,214,231,222,227,214,349,292,271,347,259,282,347,268,282^211,220,234,225,217,232,312,283,225,180,220,218,232,163,159,236,219,228,231,226,218,231,218,222,227,219,228^211,226,214,231,222,227,214,345,301,264,345,301,271,348,271,249,347,255,281,348,261,251,345,301,264,346,291,299^346,307,291,345,308,278,163,159,170,174,168,173,168,172,165,168,166^236,233,232,163,159,226,238,233,221,222,216,163,159,214,231,233,222,219,214,216,233,229,228,236,218,231,163,159,229,231,218,232,233,222,220,218,163,159,225,218,235,218,225,222,227,220^211,219,222,227,227,232,220,234,225,217,219,228,231,154,217,154,217,160,224,231,163,159,226,214,227,220,217,218,231^211,232,214,225,223,218,231,215,222,225,225,222,220,233,220,234,225,217,153^346,307,291,345,308,278,163,159,166,170,173,170,172,171,167,170,165,165,171^232,312,283,225,220,218,231,220,228,225,217,228,235,218,231,226,229,163,159,154,217,160,224^211,215,222,225,225,222,220,233,220,234,225,217,233,222,225,232,214,225,220^347,273,289,347,273,258,163,159,346,260,295,349,292,268,166,166,165,163,159,349,252,287,346,300,294,345,301,255,346,260,300,164,347,268,277,347,255,305,350,252,262,164,345,301,258,346,305,303,346,253,299,347,299,253,349,297,302,347,274,282,348,271,249,347,273,256,346,260,256,226,226,226,226^230,230,163,159,168,170,173,167,167,165,165,171,171^211,236,233,208,215,232,210,220,234,225,217,232,236,222,232,221,153^211,232,312,283,225,220,218,231,220,234,225,217,233,222,225,217,214,227,232,224,218,231,218^166,346,260,300,350,274,279,346,254,258,349,256,294,350,272,249,348,252,248,346,303,284,166,166,166,163,159,215,228,232,232,163,159,349,308,269,347,273,254,346,261,249,348,284,258,345,305,269,347,248,277,163,159,166,166,166,346,250,285,350,245,271,346,272,279^236,228,236,226,214,231,233,208,154,163,161,210,231,234,163,159,325,300,228,325,304,228,233,228^219,215,226,233,218,214,226,154,163,216,228,226,163,159,220,214,226,218^221,346,263,257,226,350,271,307,346,303,283,348,252,248,348,248,284,348,259,256,346,303,284,346,257,250,346,272,279,346,263,257,346,258,266,345,302,293,161,219,232,346,278,265,346,281,267,349,284,247,161,346,281,284,348,294,296,345,306,259,345,308,274,161,350,304,262,346,301,247,233,168^215,228,228,232,233,233,228,217,214,238,163,159,232,221,214,217,228,236,215,228,228,232,233,154,163,216,228,226^211,226,214,231,222,227,214,346,261,249,348,284,258,348,271,291,349,247,281^215,218,232,233,218,227,163,159,232,224,238,229,218,163,159,232,214,231,226,214,218,225,163,159,216,228,214,216,221,222,227,220^211,236,233,232,214,227,233,228,231,234,232,163,159,215,234,231,227,222,227,220,163,159,221,216,127,226,163,159,217,234,227,220,218,228,227,232,163,159,236,218,218,224,225,238,216,221,218,232,233^211,219,222,227,227,232,232,229,218,225,235,214,225,234,233,214,163,159,233,214,231,232,236,222,232,221,163,159,236,226,222,220^346,307,291,345,308,278,220,221,218,232,233,225,234,228,215,228^345,308,278,167,169,170,170,170,171,167,166,170^221,348,259,256,346,303,284,346,257,250,346,272,279,349,308,269,347,273,254,349,297,305,347,296,266,346,307,300,347,253,269,348,257,259,349,261,285,345,306,259,345,304,300,346,281,249,348,261,251,347,273,258,346,255,278,346,270,285,346,262,285,347,268,282,154,217,348,247,302,346,305,245,347,254,264,226,346,257,250,346,272,279,154,217,160,347,259,282,347,265,299,350,279,249,346,291,271,348,254,302,345,304,300,346,258,267^232,224,238,229,218,163,159,226,214,239,218,236,228,236^211,224,228,229,218,231,236,180,228,180,236,180,220,234,225,217,235,222,214,232,236,222,232,221^211,154,217,160,224,219,222,227,227,232,163,159,181,232,236,222,232,221^236,233,232,163,159,231,234,227,232,163,159,214,231,233,222,219,214,216,233,229,228,236,218,231,163,159,225,218,235,218,225,222,227,220,163,159,226,228,231,218,163,159,222,227,219,228^217,235,222,227,220,163,159,229,228,236,218,231,225,218,180,235,218,180,225,163,159,217,235,222,227,220^211,232,214,225,223,218,231,235,222,214,232,236,222,232,221^345,308,278,163,159,166,172,172,173,173,174,170,170,168,169,166^215,218,232,234,216,221,218,227,163,159,236,228,236,235,218,227,217,228,231,154,163,216,228,226^232,218,225,225,222,227,220,163,159,215,228,228,232,233,163,159,220,234,214,180,231,214,227,233,218,218,163,159,220,222,235,218,214,236,214,238,163,159,222,227,219,218,231,227,214,225,163,159,232,229,228,233^211,236,233,232,214,227,233,228,231,234,232,163,159,164,166,166,163,159,236,222,233,221,226,225,163,159,215,218,232,233,229,231,222,216,218,163,159,226,218^211,226,214,231,222,227,214,350,269,308,347,272,305,349,256,260,348,271,249,350,279,249,349,284,246^229,218,227,220,214,231,219,222,227,227,232,235,222,214,232,236,222,232,221^226,228,234,227,233,163,159,228,229,220,214,226,218,220,228,225,217,208,154,163,161,210,216,228,226^214,233,233,218,227,233,222,228,227,163,159,218,229,222,180,216,216,214,231,231,238,154,163,216,228,226^215,228,228,232,233,222,227,220,208,154,163,161,210,229,231,228,163,159,225,228,228,233^348,259,293,346,273,285,347,273,254,346,272,279,350,278,299,348,303,284,346,254,292,347,273,289,349,256,294,350,272,249,163,159,346,250,285,350,245,271,347,266,280,346,258,267,347,304,278,348,303,284,346,258,296,346,260,292,346,260,292,349,303,303,346,293,301,163,159,346,260,283,347,273,254,346,260,295,349,292,268,166,166,165,347,289,279,349,308,259,346,263,285,349,292,279^346,307,291,345,308,278,163,159,166,173,171,174,167,167,165,173,172,169,170^211,232,214,225,223,218,231,215,222,225,225,222,220,233,180,220,234,225,217,208,226,235,210,208,218,222,210,208,217,214,210,232,236,222,232,221^229,218,236,229,218,236,232,221,228,229,154,163,229,231,228,163,159,226,238,233,221,222,216^346,260,300,350,274,279,346,254,258,344,245,246,349,256,294,350,272,249,346,250,285,350,245,271,346,291,254,347,254,269,350,295,246,347,267,292,161,348,252,248,348,248,284,348,259,256,346,303,284,220,346,272,279,161,233,167,166,346,282,268,349,280,250,163,159,348,279,307,346,259,256,346,272,279,350,269,276,346,260,283,347,273,254,346,261,249,346,281,284,347,273,258,346,260,295,349,292,268,348,259,256,346,303,284,166,166,165,350,269,308,347,277,305,347,256,254,348,259,272,346,260,295,349,292,268,350,271,307,346,303,283^235,222,232,222,233,163,159,226,226,208,228,165,210,225,235,225,217,208,228,165,210,233,216,208,228,165,210,226^211,232,214,208,225,222,210,223,218,231,220,235,222,214,232,236,222,232,221^211,219,222,227,227,232,220,234,225,217,163,159,232,236,222,232,221,163,159,236,226,222,220^211,233,228,217,214,238,233,228,232,154,217,164,174,163,159,231,234,227,163,159,220,218,233,227,218,236,163,159,233,222,218,231,163,159,233,222,233,214,227,232,163,159,215,218,232,233,229,231,222,216,218,163,159,217,218,233,214,222,225,232^234,232,217,163,159,236,233,233,220,228,225,217,208,154,163,161,210,216,228,226^211,232,214,225,223,218,231,220,234,225,217,229,214,232,236,222,232,221^346,307,291,345,308,278,163,159,167,173,169,170,174,171,168,165,168^211,220,219,222,227,227,232,232,236,222,232,221,153^217,222,232,216,228,231,217,163,159,217,235,222,227,220,232,234,229,229,228,231,233^215,222,225,225,222,220,233,220,234,225,217,163,159,154,217,160,224,163,159,232,236,222,232,221^232,312,283,225,220,218,231,220,234,225,217,235,222,214,226,228,215,222,225,218,180,229,214,238^230,230,163,159,173,169,172,169,171,170,167,173,171^211,232,214,225,223,218,231,220,234,225,217,163,159,215,218,221,228,235,214,227,217,218^211,346,250,285,347,267,293,349,308,272,346,303,283,164,349,256,294,350,272,249,348,259,256,346,303,284,346,250,285,350,245,271,349,308,272,348,304,249,346,293,294,346,305,245,347,254,264,347,274,282,346,261,249,348,284,258,349,245,246,347,274,308,347,273,289,347,273,258,346,260,295,349,292,268,166,166,165,348,259,293,346,273,285,346,305,245,347,254,264,161,346,250,285,348,296,304,347,268,277,348,288,275,345,303,254,347,289,279,349,308,259,346,261,249,345,306,258,349,245,246,347,274,308,347,267,293,346,302,297,346,308,288,345,302,261,153^235,222,232,222,233,163,159,229,218,231,219,218,216,233,236,214,238,154,163,228,227,218^232,218,225,225,222,227,220,163,159,236,214,231,216,231,214,219,233,163,159,219,234,225,225,220,218,214,231,215,228,228,232,233,163,159,238,228,234,236,222,225,225,220,218,233,163,159,231,218,225,222,216,232,163,159,232,229,228,233,232^348,259,256,346,303,284,349,256,294,350,272,249,346,263,257,226,350,271,307,346,303,283,349,280,250,346,281,252,346,257,250,346,272,279,346,263,257,346,258,266,345,302,293,163,159,347,253,269,350,286,289,348,290,254,161,350,247,287,347,293,265,350,275,258,346,303,284,161,350,304,262,346,301,247,233,168,346,263,257,346,274,261,350,287,262,161,346,281,284,348,294,296,345,306,259,345,308,274^222,227,219,228,163,159,226,226,208,228,165,210,225,235,225,208,154,163,161,210,180,216,208,165,228,210,226^346,307,291,345,308,278,163,159,168,170,170,168,168,173,174,172,166^211,224,228,229,218,231,154,217,160,224,220,234,225,217,235,222,214,232,236,222,232,221^216,228,227,233,214,216,233,163,159,226,226,208,228,165,210,225,235,225,154,163,216,208,228,165,210,226^211,236,233,232,226,238,233,221,222,216,163,159,236,218,218,224,225,238,225,228,228,233,163,159,221,218,225,229,238,228,234,233,228,216,225,218,214,231,163,159,225,218,233,234,232,221,214,227,217,225,218,233,221,218,215,228,231,222,227,220,229,214,231,233,232^211,236,233,232,214,227,233,228,231,234,232,163,159,227,226,163,159,221,216,163,159,163,159,236,218,218,224,225,238,217,234,227,220,218,228,227,163,159,174,154,217,154,217,222,233,218,226^236,233,232,214,231,220,234,232,163,159,226,238,233,221,222,216,218,237,229,220,231,228,234,229,163,159,214,219,224,163,159,231,218,214,217,238,233,228,232,234,226,226,228,227,163,159,218,235,218,231,238,154,217,154,217,226,222,227,163,159,231,218,232,218,231,235,218^219,232,346,278,265,346,281,267,349,284,247,163,159,346,257,250,347,253,267,349,280,250,346,281,252,346,258,266,345,302,293,163,159,171,171,208,228,165,210,174,170,208,228,165,210,163,159,167,208,228,165,210,166,166,208,228,165,210^236,233,232,214,227,233,228,231,234,232,163,159,227,228,231,226,214,225,229,218,231,232,228,227,214,225,163,159,168,165,226,222,227,163,159,226,214,232,233,218,231,163,159,229,225^211,227,214,220,228,227,232,228,226,215,218,221,228,235,218,231,224,228,229,214,220,234,208,225,222,210,217^231,226,215,163,159,347,253,269,348,306,262,229,231,218,233,233,238,218,225,218,227,214^220,234,225,217,224,235,214,231,163,159,235,222,214,232,236,222,232,221^218,229,216,214,231,231,222,218,232,163,159,232,224,238,229,218^228,234,231,233,218,214,226,163,159,221,218,225,229,238,228,234,163,159,220,218,233,238,228,234,231,163,159,233,228,217,214,238,163,159,220,218,233,232,233,214,231,233,218,217^230,172,167,169,167,167,168,169,169,173^350,252,262,163,159,166,170,173,165,167,170,170,172,166,167,171^228,219,219,218,231,232,163,159,226,226,208,228,165,210,225,235,225,154,163,216,208,228,165,210,226^211,218,227,217,214,227,232,224,218,231,217,218,231,232,312,283,225,220,218,231,220,234,225,217^233,222,233,214,227,222,234,226,215,214,238,163,159,225,222,235,231,214,222,232,228,227^236,233,232,163,159,218,154,163,159,229,154,163,159,222,154,163,159,216,154,163,159,216,154,163,159,214,154,163,159,231,154,163,159,231,154,163,159,238,154,163,159,216,154,163,159,228,154,163,159,226^211,236,233,232,233,216,220,226,228,234,227,233,163,159,216,221,218,214,229,220,163,159,232,233,228,216,224,163,159,232,214,235,218^211,232,218,225,225,222,227,220,226,217,234,227,220,218,228,227,232,236,222,233,221,236,218,218,224,225,238,216,221,218,232,233,214,227,217,225,228,228,233,163,159,214,231,220,234,232,221,218,231,228,222,216^223,214,220,232,214,225,223,218,231,220,234,225,217,235,222,214,232,236,222,232,221^235,222,232,222,233,236,228,236,235,218,227,217,228,231,154,163,208,227,216,228,210,208,218,228,231,210,208,233,226,220,210^235,222,232,222,233,163,159,216,228,227,230,234,218,232,233,216,214,229,229,218,217,208,154,163,161,210,216,228,226^214,234,233,228,163,159,232,221,214,217,228,236,215,228,228,232,233,154,163,216,228,226^235,222,232,222,233,236,228,236,233,218,214,226,154,163,227,218,233^345,308,278,225,228,235,218,215,214,215,238,167,168,169^346,260,300,350,274,279,346,254,258,349,256,294,350,272,249,348,252,248,346,303,284,208,225,166,210,208,225,166,210,208,225,166,210,163,159,347,304,278,208,225,166,210,208,225,166,210,208,228,165,210,348,303,284,346,258,296,346,260,292,163,159,226,208,225,166,210,208,225,166,210,208,225,166,210^220,228,225,217,163,159,232,312,283,225,220,218,231,223,218,220,154,217,154,217,160,224,163,159,236,221,222,232,229,218,231^345,308,278,168,174,174,166,167,173,170,169,173^219,234,225,225,216,225,218,214,231,163,159,220,218,233,215,222,232,220,218,214,231,163,159,222,227,219,218,231,227,214,225,163,159,227,228,236,163,159,226,228,231,218,222,227,219,228^211,226,214,231,222,227,214,346,273,280,346,250,254,346,251,272^232,224,238,229,218,163,159,215,218,225,224,228,231,224,181,220,226,214,222,225,154,163,216,228,226^232,222,233,218,163,159,226,226,208,228,165,210,225,235,225,154,163,216,208,228,165,210,226^346,260,300,350,274,279,346,254,258,161,349,256,294,350,272,249,161,348,252,248,348,248,284,348,259,256,346,303,284,166,166,166,346,250,285,350,245,271,163,159,347,274,282,350,273,245,346,282,268,349,280,250,350,282,293,346,264,246,346,273,280,348,254,286,161,346,292,251,347,253,262,349,308,272,346,272,279^211,221,348,259,256,346,303,284,346,257,250,346,272,279,347,273,254,347,296,266,346,301,253,217,224,350,287,262,348,254,284,347,273,292,347,273,258,346,255,278,346,270,285,172,348,247,302,346,305,245,347,254,264,348,270,306,349,260,273,345,304,300,346,281,249,348,261,251,153^230,170,169,174,174,171,170,173,168,173^345,308,278,232,218,232,218,220,228,225,217^214,227,233,228,231,234,232,163,159,164,166,166,163,159,226,228,234,227,233,163,159,219,214,232,233,216,221,218,214,229^211,232,214,208,225,222,210,223,218,231,220,234,208,222,225,210,217,229,214,208,232,153,210,236,208,222,225,210,232,221^226,214,220,218,233,228,236,218,231,163,159,226,226,208,228,165,210,225,235,225,154,163,216,208,228,165,210,226^325,308,229,228,325,297,214,325,299,214,163,159,216,228,222,227,232,232,233,228,231,218,208,154,163,161,210,231,234^345,308,278,220,228,225,217,236,228,236^236,218,216,221,214,233,163,159,236,233,236,233,222,214,227,168,167,166^211,236,233,232,233,228,232,174,164,174,163,159,236,222,233,221,226,225,163,159,216,225,214,232,232,218,232,214,235,214,222,225,163,159,216,228,226,218,220,218,233,238,228,234,231^235,222,232,222,233,219,214,232,233,231,234,227,208,154,163,161,210,222,227,219,228^232,224,238,229,218,163,159,220,218,227,238,154,163,224,167^236,233,232,214,227,233,228,231,234,232,163,159,217,234,227,220,218,228,227,232,163,159,234,231,239,234,225,163,159,221,218,225,225,219,222,231,218,216,228,231,218^211,236,218,214,231,218,221,218,225,229,222,227,220,236,222,233,221,214,227,233,228,231,234,232,163,159,233,221,231,228,227,218,232,163,159,217,234,227,220,218,228,227,232,163,159,222,227,219,228^211,233,228,232,221,218,231,228,222,216,174,164,174,163,159,219,214,232,233,216,225,218,214,231,163,159,236,218,225,216,228,226,218,163,159,232,218,231,235,222,216,218,232,163,159,220,222,219,233,232,163,159,214,231,233,222,219,214,216,233^211,220,232,214,225,223,232,215,222,225,225,222,220,233,163,159,232,236,222,232,221^211,219,222,227,227,232,220,235,222,214,232,236,222,232,221^211,224,228,229,218,231,220,234,225,217,219,228,231,229,218,227,220,214,231^232,235,218,227,163,159,219,222,227,227,232,163,159,232,233,228,216,224,163,159,232,224,238,229,218^220,234,225,217,163,159,219,222,227,227,232,214,233,233,224,228,229,214,220,218,227,228,226,232,236,222,232,221^232,221,214,217,228,236,215,228,228,232,233,154,163,216,228,226,163,159,220,234,222,225,217^211,232,218,225,225,222,227,220,214,227,233,228,231,234,232,163,159,221,218,231,228,222,216,163,159,164,166,166,163,159,226,238,233,221,222,216,166,170^211,226,214,231,222,227,214,229,235,229,348,295,307,350,265,261,348,271,291,349,247,281^211,236,233,232,236,218,218,224,225,238,216,221,218,232,233,163,159,226,238,233,221,222,216,163,159,221,216,233,228,232,163,159,214,231,233,222,219,214,216,233,229,228,236,218,231^211,232,218,225,225,222,227,220,214,227,233,228,231,234,232,163,159,215,228,228,232,233,163,159,220,234,214,180,231,214,227,233,218,218,217,163,159,232,218,225,219,229,225,214,238,163,159,220,222,235,218,214,236,214,238,163,159,232,229,228,233^211,221,218,225,229,236,222,233,221,214,227,233,228,231,234,232,221,218,231,228,222,216,214,227,217,227,228,231,226,214,225,163,159,214,225,232,228,223,234,232,233,214,231,220,234,232,231,234,227,232,219,228,231,233,231,222,227,224,218,233,232,163,159,166,170,217,234,227,220,218,228,227^232,218,225,225,222,227,220,163,159,219,234,225,225,226,214,232,233,218,231,225,228,228,233,163,159,164,166,165,163,159,229,218,228,229,225,218,163,159,226,214,237,220,218,214,231,163,159,216,221,218,214,229,218,232,233,229,231,222,216,218^346,272,279,163,159,166,167,174,167,172,165,171,166,168,169^229,228,236,218,231,225,218,180,235,218,180,225,222,227,220,163,159,231,214,231,218,226,228,234,227,233,232,163,159,216,214,231,231,238^211,220,219,222,227,227,232,214,233,233,180,224,228,229,214^226,348,259,256,346,303,284,154,217,160,346,257,250,346,272,279,349,297,305,347,296,266,346,307,300,350,287,262,348,254,284,347,273,292,345,306,259,345,304,300,346,258,267,348,254,302,345,304,300,346,258,267,221,348,259,256,346,303,284,346,257,250,346,272,279,347,273,254,349,297,305,347,296,266,346,307,300,350,287,262,348,254,284,347,273,292,346,305,245,347,254,264,345,306,259,345,304,300,346,281,249,348,261,251,350,286,289,345,301,255,346,305,245,347,254,264^211,236,233,232,233,228,226,215,163,159,219,234,225,225,220,218,214,231,215,228,228,232,233,163,159,238,228,234,236,222,225,225,220,218,233,163,159,231,218,225,222,216,232,163,159,220,222,235,218,214,236,214,238,163,159,226,228,234,227,233^348,304,248,348,303,284,163,159,215,218,214,231,236,228,236,208,161,163,210,216,228,226^232,218,231,235,222,216,218,163,159,226,226,208,228,165,210,225,235,225,154,163,216,208,228,165,210,226^345,301,245,347,255,255,349,308,252,347,274,282,350,273,245,347,294,247,174,169,170,174,173,170,349,280,250,346,281,252,348,271,249,345,301,255,346,301,274,226,347,253,262,349,308,272,346,281,284,346,272,279,347,254,264,347,258,275,349,292,300,349,284,246,349,293,250^211,236,233,232,154,217,160,224,220,234,225,217,219,228,231,232,236,222,232,221^232,229,218,225,229,218,227,220,214,231,181,232,236,222,232,221^226,226,208,228,165,210,225,235,225,154,163,216,208,228,165,210,226,163,159,222,227,219,228^217,218,233,214,222,225,232,163,159,228,239,238,220,231,228,234,229,154,163,216,228,226^222,227,219,228,163,159,218,229,222,216,216,214,231,231,238,208,154,163,161,210,216,228,226^346,307,291,345,308,278,225,222,234,223,222,214,227,237,222,228,227,220,173,173,167,173^215,214,233,233,225,218,233,214,220,163,159,220,221,228,232,233,217,228,220,167,166,168,169,169,165^211,232,214,225,223,218,231,220,154,163,180,153^211,215,222,225,225,222,220,233,220,234,180,225,180,217,180,219,222,227,227,232,163,159,232,236,222,232,221^346,260,300,350,274,279,346,254,258,349,256,294,350,272,249,348,252,248,346,303,284,166,166,166,350,286,289,345,301,255,346,305,245,347,254,264,347,304,278,348,303,284,346,258,296,346,260,292,345,301,258,347,265,299,347,255,305,347,293,301,345,302,250,347,255,298,346,300,291,346,252,303,345,301,245,345,304,299,347,256,258,345,301,245,345,304,299,346,292,251,347,253,262,349,308,272,346,272,279^211,214,215,233,349,256,294,350,272,249,346,257,250,346,272,279,163,159,216,228,220,346,300,282,345,306,273,346,291,281^233,218,225,218,220,231,214,226,163,159,214,226,222,231,214,227,220,214,226,222,227,220^232,224,238,229,218,163,159,223,214,227,218,215,228,228,232,233^211,232,214,225,223,218,231,220,164,236,226,218,153^211,224,228,229,218,231,220,234,225,217,153^211,226,348,259,256,346,303,284,166,174,346,257,250,346,272,279,348,305,303,349,297,305,347,296,266,346,307,300,350,287,262,348,254,284,347,273,292,347,273,258,346,255,278,346,270,285,172,348,247,302,346,305,245,347,254,264,348,254,302,345,304,300,346,258,267,153^211,236,233,232,214,227,233,228,231,234,232,163,159,220,218,233,174,154,217,154,217,163,159,220,218,214,231,214,227,217,216,234,231,235,218,214,216,221,163,159,219,214,232,233,163,159,220,234,222,225,217,163,159,222,227,219,228^211,232,218,225,220,218,231,220,234,225,225,235,222,214,235,222,229,229,232^346,307,291,345,308,278,163,159,166,168,174,172,170,172,168,166,167,171,172^222,220,219,214,227,232,163,159,232,233,228,216,224,163,159,217,218,225,222,235,218,231^345,308,278,226,222,214,166,166,166,167,170^211,216,228,220,346,250,289,345,305,271,349,261,285,346,279,264^235,222,232,222,233,163,159,218,229,154,163,180,222,216,216,214,231,231,238,154,163,216,228,226^215,214,225,228,215,222,227,217,181,228,234,233,225,228,228,224,154,163,216,228,226^348,259,256,346,303,284,163,159,345,304,304,345,306,266,345,304,282,345,306,299,346,281,286,350,301,308,346,261,258,345,302,254,346,267,255,348,271,249,350,248,306,347,269,292,350,287,268,346,290,261^211,208,235,236,210,222,225,225,224,228,229,208,214,232,210,220,234,225,217,163,159,232,236,222,232,221^214,231,233,222,219,214,216,233,229,228,236,218,231,163,159,218,239,169,238,228,234,154,163,218,234^211,226,228,234,227,233,219,231,228,226,220,234,225,217,214,227,226,238,233,221,222,216,215,218,232,233,229,231,222,216,218,229,232,233,153^230,230,168,166,173,167,170,173,168,170,165,174,163,159,232,224,238,229,218^211,220,219,222,227,227,232,235,222,214,232,236,222,232,221^220,234,225,217,232,214,225,223,218,208,231,232,210,235,222,214,232,236,222,232,221^211,226,228,234,227,233,219,231,228,226,220,234,225,217,214,227,215,218,232,233,229,231,222,216,218,164,236,226,218,153^236,218,215,229,214,220,218,163,159,218,229,222,216,216,214,231,231,238^217,222,232,216,228,231,217,163,159,232,234,227,227,238,169,166,170,166^226,226,228,229,231,228,219,163,159,225,228,228,233,163,159,220,228,225,217^226,238,233,221,222,216,163,159,215,228,228,232,233,163,159,219,231,218,218,163,159,220,218,214,231,163,159,215,218,232,233,229,231,222,216,218,163,159,222,227,219,228^211,227,214,227,232,228,226,214,231,232,234,220,218,227,229,214,220,234,225,217,163,159,229,231,222,232^211,236,233,232,214,227,233,228,231,234,232,163,159,227,228,231,226,214,225,214,227,217,221,218,231,228,222,216,163,159,217,234,227,220,218,228,227,232,163,159,236,218,218,224,225,238,231,218,236,214,231,217^230,230,163,159,166,170,168,173,172,169,165,171,174^211,232,218,222,220,218,231,220,234,222,222,235,222,214,235,222,229,229,232^221,348,259,256,346,303,284,346,257,250,346,272,279,350,286,289,345,301,255,346,305,245,347,254,264,226,348,259,256,346,303,284,163,159,221,348,259,256,346,303,284,346,257,250,346,272,279,350,286,289,345,301,255,346,305,245,347,254,264,349,308,252,226,348,259,256,346,303,284^211,232,312,283,225,220,218,231,226,228,227,233,218,231,163,159,222,227,219,228,163,159,218,219,219,218,224,233,222,235^235,222,232,222,233,163,159,217,235,222,227,220,217,228,233,227,218,233^235,222,232,222,233,163,159,217,235,222,227,220,154,163,227,218,233^228,225,228,225,228,229,218,236,170,169,169,173^346,257,250,346,272,279,163,159,170,167,172,168,168,173,174,168,169^217,235,222,227,220,208,154,163,161,210,231,234,163,159,238,216,325,304,238,231,325,301^233,222,233,214,227,222,234,226,215,214,238,163,159,220,228,225,217^217,222,232,216,228,231,217,234,229,168,174,165,168^345,308,278,173,174,169,170,173,165,167,168,166^236,231,222,233,218,163,159,226,226,208,228,165,210,225,235,225,154,163,216,208,228,165,210,226^236,214,225,225,220,214,226,222,227,220,163,159,225,228,228,233,163,159,224,218,238,232,233,228,227,218^211,221,348,259,256,346,303,284,346,257,250,346,272,279,347,273,254,347,296,266,349,297,305,346,307,300,350,287,262,348,254,284,347,273,292,347,273,258,346,255,278,346,270,285,154,217,160,348,247,302,346,305,245,347,254,264,348,270,306,349,260,273,345,304,300,346,281,249,348,261,251,153^211,232,214,225,223,218,231,232,229,218,225,235,214,225,234,233,214,235,222,214,232,236,222,232,221^348,252,248,348,248,284,348,259,256,346,303,284,163,159,346,250,285,350,245,271,345,304,300,347,277,305,345,306,259,346,304,254,163,159,347,289,279,349,308,259,347,267,293,348,259,286,346,291,299,346,272,275,346,306,263,163,159,215,228,232,232^232,218,225,225,222,227,220,163,159,216,225,218,214,231,163,159,217,222,232,216,228,234,227,233,163,159,222,227,219,218,231,227,214,225,163,159,220,234,214,180,231,214,227,233,218,218^232,224,238,229,218,163,159,216,221,222,218,219,215,228,228,232,233^211,349,245,246,348,254,257,348,307,259,347,273,258,216,228,220^211,215,228,228,232,233,222,227,220,226,238,233,221,222,216,163,159,217,234,227,220,218,228,227,232,214,227,217,231,214,222,217,232,163,159,231,214,231,218,226,228,234,227,233,232,163,159,229,235,229,221,218,225,229^217,222,232,216,228,231,217,163,159,231,218,238,235,222,227,224,166,170,173,171^211,220,234,225,217,219,222,227,227,232,163,159,235,222,214,232,236,208,222,225,210,232,221^211,236,233,232,233,228,226,215,163,159,174,164,174,163,159,233,228,227,232,228,219,225,228,228,233,163,159,224,223,224,222,225,225,163,159,214,216,221,222,218,180,235,163,159,214,227,238,222,233,218,226,163,159,228,216,216,234,231,218,235,218,231,238,217,214,238^232,312,283,225,220,218,231,220,163,159,226,228,215,222,225,218,229,214,238^345,301,258,346,305,303,346,253,299,347,299,253,349,297,302,161,345,301,258,347,265,299,347,255,305,350,252,262,161,345,301,245,346,292,302,345,301,245,349,297,297,346,308,248,347,273,258,346,255,278,347,274,282,350,273,245,346,282,268,349,280,250,350,282,293,346,264,246,346,273,280,348,254,286,347,266,280,345,304,299,346,260,283,347,273,254,346,260,295,349,292,268,166,166,165,345,307,272,350,245,254,347,256,286,161,346,292,251,347,253,262,349,308,272,346,272,279^211,236,233,232,214,227,233,228,231,234,232,163,159,233,221,231,228,227,218,163,159,221,216,214,227,217,226,238,233,221,163,159,217,234,227,220,218,228,227,232,163,159,226,228,234,227,233^236,228,236,221,234,227,233,215,228,228,232,233,222,227,220,232,218,231,235,222,216,218^346,258,246,345,303,265,346,281,284,348,294,296,345,306,259,345,308,274,347,274,282,346,293,294,347,254,264,344,245,246,161,180,349,256,294,350,272,249,348,259,256,346,303,284,346,257,250,346,272,279,347,253,269,348,257,259,349,261,285,348,259,293,346,273,285,346,305,245,350,269,308,346,260,281,347,267,292,346,252,304,347,274,245,346,260,281,346,293,265,345,301,302,346,274,261,350,287,262,349,256,294,350,272,249,345,301,287,345,303,303,347,256,307,346,260,267,348,259,293,346,273,285,346,305,245^211,232,214,225,223,218,231,220,234,225,217,163,159,154,217,160,224,231,219,228,231,154,217,160,224,163,159,232,236,222,232,221^325,306,325,301,325,300,224,325,301,218,326,251,218,325,306,326,256,163,159,220,218,233,225,228,228,233,208,154,163,161,210,231,234^211,232,312,283,225,220,218,231,154,217,160,224,163,159,226,228,215,222,225,218,229,214,238^211,236,233,232,233,228,226,215,163,159,174,164,174,163,159,224,223,224,222,225,225,163,159,214,216,221,222,218,235,163,159,222,233,218,226,228,219,238,228,234,231,216,221,228,222,216,218,163,159,218,235,218,231,238,217,214,238,163,159,218,237,229,218,231,222,218,227,216,218,217^217,218,233,214,222,225,232,163,159,226,226,208,228,165,210,225,235,225,208,154,163,161,210,216,208,165,228,210,226^345,308,278,215,214,215,218,238,166,166,167,168^345,306,259,345,308,274,163,159,349,280,250,348,290,254,171,171,165,174,170,165,347,267,293,348,284,258,347,268,260,167,165,166,166,165,350,280,275,349,278,257,349,284,280,350,265,246,163,159,349,283,246,348,271,249,230^221,154,217,160,224,163,159,236,208,232,153,210,236,222,232,221,163,159,215,222,225,225,222,220,233^346,307,291,345,308,278,218,238,218,232,225,228,233^211,208,235,236,210,222,225,225,227,214,220,228,227,224,228,229,208,214,232,210,220,234,225,217,163,159,232,236,222,232,221^211,232,218,225,225,222,227,220,214,227,233,228,231,234,232,163,159,219,234,225,225,220,218,214,231,215,228,228,232,233,163,159,226,238,233,221,222,216,225,228,228,233,217,231,228,229,163,159,220,234,214,180,231,214,227,233,218,218,163,159,226,214,222,227,232,229,218,216^216,231,234,232,214,217,218,231,163,159,347,292,266,345,301,271,163,159,224,225,239,163,159,346,285,246,347,273,272,163,159,347,286,270^211,232,214,225,223,218,231,154,217,160,224,163,159,232,236,222,232,221","232,216,221^351,270,309,347,261,282,348,268,293,348,254,262,347,294,295^217,222,219,215,230^348,268,294,349,285,259,348,269,261,350,285,281,351,266,247^236,223,233,223,234,164,160,237,219,216,233,223,234,219^233,235,230,230,229,232,234^218,219,226,223,236,219,232,239^351,288,263,346,302,272,347,256,279^347,254,301,348,287,271^226,223,236,219,217,222,215,234^233,219,215,233,229,228^349,305,249,349,304,285^215,232,219,228,215^350,285,281,351,266,247,351,281,276,350,279,258^237,219,216,217,222,215,234^233,234,229,232,219^226,219,236,219,226,223,228,221^233,215,226,219^351,281,276,350,279,258,348,254,262,347,294,295^346,305,301^233,219,232,236,223,217,219^227,209,229,166,211,235,228,234^351,281,276,350,279,258,350,285,281,351,266,247^217,235,233,234,229,227,219,232^233,219,217,235,232,219^216,209,229,166,211,209,229,166,211,233,234^235,228,226,229,217,225^234,232,235,233,234,230,223,226,229,234^233,219,226,220,230,226,215,239^230,215,239,230,215,226^217,229,227,230,219,234,223,234,223,229,228^226,219,221,215,226^217,229,218,219^221,226,215,218,223,215,234,229,232^233,225,239,230,219^230,232,223,217,219^218,223,233,217,229,235,228,234^217,229,235,230,229,228^350,247,258,346,302,272,347,273,280,351,270,277^233,215,220,219^350,255,304,348,255,257,346,305,281,348,255,265^230,232,229,220,220,181,219,233,233,181,223,229,228,215,226^350,298,306,348,297,267,347,308,301^215,217,217,233,222,215,232,209,219,223,211^221,235,215,232,215,228,234,219,219^231,235,215,226,223,234,239^230,223,226,209,229,166,211,234,219,218^347,275,262,351,288,263^220,215,233,234^217,229,215,217,222,223,228,221^215,217,217,229,235,228,234^232,215,234,223,228,221^219,238,230,219,232,223,219,228,217,219^231,235,215,228,234,223,234,239^348,268,294,349,285,259,348,269,261,347,303,305,347,258,268,350,285,281,351,266,247^350,247,258,346,302,272,347,275,262,351,288,263","351,299,285,348,262,302,350,306,299,349,257,283^349,275,260,348,257,280,348,272,287,156,219,156,219,182,350,249,304,348,307,247,349,256,266^349,298,268,348,303,255,348,280,267^352,288,291,347,303,257,349,256,266,349,298,268","239,231,239,228,217,237,230,219,224,157,166,219,231,229^220,221,232,221,230,220^239,221,221,218,228,241,157,166,219,231,229^239,231,239,224,231,234,220,221,235,157,166,219,231,229^223,231,228,220,232,234,225,219,221,235^219,231,234,232,228,217,237,230,219,224,157,166,219,231,229^222,231,234,223,231,228,220^157,220,163,227,211,167,212,213,183,220,237,230,223,221,231,230^223,217,229,225,230,223^223,237,225,228,220,228,217,237,230,219,224,157,166,219,231,229^237,235,236,234,221,217,229,157,166,236,238^234,221,219,234,237,225,183,236^221,230,226,225,230,157,166,219,231,229^157,166,239,225,240,157,166,219,231,229^231,239,230,171,220,157,166,236,238^235,231,219,225,217,228^223,237,225,228,220,224,231,235,236,225,230,223,166,231,234,223^223,231,228,220,231,230,228,241^223,237,225,228,220,232,231,234,236,217,228,157,166,219,231,229^223,237,225,228,220,239,231,234,227,166,219,231,229^223,217,229,221,236,225,229,221^157,166,218,217,236,236,228,221,157,166,230,221,236,167^221,230,236,234,217,230,219,221^157,220,163,227,211,167,212,213,183,221,217,219,224^219,224,221,217,232,221,234,236,224,217,230,217,224^239,231,239,235,236,221,217,220,157,166,219,231,229^217,232,232,228,211,225,241,213^157,220,163,227,232,221,234,234,237,230^223,237,225,228,220^231,230,228,241,217,219,219,221,232,236,225,183,230,183,223,183,223,231,228,220^232,234,225,219,221,157,220,163,227^235,221,234,238,221,234,236,225,229,221^157,220,163,227,232,221,234,220,237,230,223,221,231,230^229,221,229,218,221,234,235^236,239,225,236,219,224,157,166,236,238^235,224,225,238,236,234,157,166,219,231,229^223,237,225,228,220,231,229,217,236,225,219,157,166,219,231,229^223,217,229,221,234,228,217,237,230,219,224,157,166,219,231,229","219,232,232,236,237,230,222,233,229,243,158,167,220,232,230^229,232,232,237,220,229,232,238,221,221,232,237,220,232,230^229,222,224,226,232,231,223,218,235,230,158,167,220,232,230^236,225,218,221,232,240,219,232,232,236,237,158,167,220,232,230^224,232,229,221,221,222,218,229,212,158,167,165,214,235,238^218,231,237,232,235,238,236,221,222,218,229,236,158,167,220,232,230^225,232,235,221,222,219,218,231,228,212,158,167,165,214,220,232,230^233,235,222,236,237,226,224,222,240,232,240,158,167,220,232,230^226,224,241,222,158,167,220,232,230^219,212,169,232,214,212,169,232,214,236,237,230,218,231,212,158,167,165,214,226,231,223,232^235,218,221,226,218,231,237,235,218,226,221,158,167,220,232,230^219,212,232,169,214,212,232,169,214,236,237,230,218,231,212,158,167,165,214,231,222,237^240,232,240,233,235,222,236,237,226,224,222,158,167,223,235^229,222,233,235,222,236,237,232,235,222,158,167,232,235,224^224,173,224,218,230,222,212,158,167,165,214,220,212,232,169,214,230^230,230,232,229,239,229,212,158,167,165,214,220,212,169,232,214,230^219,222,236,237,219,232,232,236,237,212,158,167,165,214,220,232,230^223,218,235,230,173,224,232,229,221,212,158,167,165,214,220,232,230^219,232,232,236,237,226,229,218,212,158,167,165,214,220,232,230^230,242,237,225,226,220,236,237,232,235,222,212,158,167,165,214,220,232,230^233,239,222,224,218,230,222,235,236,158,167,231,222,237^233,235,232,227,222,220,237,220,218,235,235,242,158,167,220,232,230^226,231,224,218,230,222,230,218,235,237,158,167,220,232,230^232,228,173,224,232,229,221,212,158,167,165,214,220,232,230^230,230,232,220,222,232,158,167,220,232,230^233,239,222,236,225,232,233,158,167,233,235,232^220,218,235,235,242,219,232,232,230,158,167,220,232,230^230,230,232,224,232,229,221,219,218,242,212,158,167,165,214,231,222,237^240,232,235,229,221,232,223,219,232,232,236,237,212,158,167,165,214,220,232,230^221,239,226,231,224,212,158,167,165,214,231,222,237^219,212,169,232,214,212,169,232,214,236,237,230,218,231,221,232,237,236,226,237,222^219,232,241,229,222,224,226,237,158,167,220,232,230^219,232,232,236,237,173,224,218,230,222,212,158,167,165,214,220,232,230^240,232,240,225,238,231,237,158,167,231,222,237^219,232,232,236,237,225,226,239,222,212,158,167,165,214,222,238^219,235,232,219,232,232,236,237,158,167,220,232,230^219,212,169,232,214,212,169,232,214,236,237,230,218,231,170,184,212,158,167,165,214,233,235,212,169,232,214^219,212,169,232,214,212,169,232,214,236,237,230,218,231,212,158,167,165,214,236,226,237,222^233,222,240,233,222,240,236,225,232,233,212,158,167,165,214,233,235,232^220,232,231,234,238,222,236,237,220,218,233,233,222,221,212,158,167,165,214,220,232,230^218,225,224,232,229,221,236,158,167,220,232,230^233,235,222,236,237,226,224,222,240,232,240,158,167,223,235^223,219,230,237,222,218,230,158,167,233,235,232^240,232,240,239,222,231,221,232,235,158,167,232,235,224^219,235,219,171,224,218,230,222,212,158,167,165,214,220,232,230^227,238,236,237,219,232,232,236,237,158,167,232,235,224^240,232,240,171,169,169,174,212,158,167,165,214,220,232,230^225,232,236,237,224,232,229,221,236,158,167,220,232,230^222,229,226,237,226,236,237,224,218,230,226,231,224,212,158,167,165,214,220,232,230^233,222,235,223,222,220,237,240,218,242,212,158,167,165,214,232,231,222^240,240,240,158,167,224,218,230,222,235,222,218,236,242,158,167,220,232,230^220,218,235,235,242,219,232,232,230,158,167,231,222,237^220,235,218,243,242,222,237,226,158,167,220,232,230^240,232,240,220,221,228,158,167,220,232,230^230,242,237,225,226,220,236,237,232,235,222,212,158,167,165,214,231,222,237^236,226,230,233,229,222,220,218,235,235,242,158,167,220,232,230^222,233,226,220,220,218,235,235,242,212,158,167,165,214,220,232,230^232,243,242,224,235,232,238,233,158,167,220,232,230^229,232,232,237,239,218,238,229,237,158,167,231,222,237^219,232,232,236,237,232,235,222,212,158,167,165,214,231,222,237^219,222,236,237,219,232,232,236,237,212,158,167,165,214,220,229,238,219^240,232,240,239,222,231,221,232,235,158,167,231,222,237^225,238,236,228,242,219,212,232,169,214,212,232,169,214,236,237,158,167,220,212,232,169,214,230^237,232,233,219,232,232,236,237,158,167,226,231,223,232^240,236,224,219,232,232,236,237,158,167,220,232,230^219,232,232,236,237,171,231,226,224,225,237,158,167,220,232,230^224,232,224,232,219,232,232,236,237,158,167,220,212,232,169,214,230^220,225,235,226,236,237,232,233,225,158,167,235,232,220,228,222,237,224,218,230,226,231,224^222,219,218,242,224,232,229,221,236,158,167,220,232,230^223,219,230,237,222,218,230,212,158,167,165,214,220,232,230^229,232,232,237,220,229,232,238,221,212,158,167,165,214,220,232,230^222,229,226,237,222,224,218,230,222,235,219,232,232,236,237,226,231,224,212,158,167,165,214,231,222,237^240,232,240,219,232,233,158,167,220,232,230^227,238,236,237,219,232,232,236,237,212,158,167,165,214,231,222,237^219,218,231,228,173,221,225,212,158,167,165,214,184,220,232,230^240,232,240,225,238,231,237,158,167,220,232,230^223,232,241,236,237,232,235,222,158,167,233,235,232^242,232,238,235,236,233,238,235,222,224,218,230,222,212,158,167,165,214,220,232,230^237,233,224,232,229,221,236,212,158,167,165,214,220,232,230^230,218,241,158,167,235,232,220,228,222,237,224,218,230,226,231,224,158,167,222,238^240,232,240,233,235,222,236,237,226,224,222,158,167,220,232,230^222,233,226,220,220,218,235,235,242,212,158,167,165,214,232,235,224^236,225,218,221,232,240,219,232,232,236,237,158,167,230,229^237,232,233,219,232,232,236,237,212,158,167,165,214,233,235,212,232,169,214^240,232,240,239,222,231,221,232,235,158,167,220,232,230^219,232,222,224,218,230,222,236,158,167,220,232,230^229,222,233,235,222,236,237,232,235,222,158,167,231,222,237^224,218,230,222,236,218,229,222,236,212,158,167,165,214,233,235,232^226,235,218,231,219,229,226,243,243,218,235,221,158,167,220,232,230^229,222,233,235,222,236,237,232,235,222,158,167,220,232,230^237,226,237,218,231,226,238,230,219,218,242,158,167,220,232,230^219,232,232,236,237,226,231,224,229,226,239,222,212,158,167,165,214,220,232,230^223,218,231,229,232,224,218,230,222,158,167,220,232,230^233,239,233,232,228,212,158,167,165,214,220,212,169,232,214,230^232,243,242,219,232,232,236,237,158,167,220,232,230^233,239,222,224,218,230,222,235,236,158,167,220,232,230^222,233,226,220,220,218,235,235,242,212,158,167,165,214,231,222,237^219,212,169,232,214,212,169,232,214,236,237,230,218,231,212,158,167,165,214,232,231,229,226,231,222^223,219,230,237,222,218,230,158,167,231,222,237","241,233,241,240,223,232,222,233,236,159,168,233,236,225^230,223,234,236,223,237,238,233,236,223,159,168,233,236,225^241,233,241,240,223,232,222,233,236,159,168,232,223,238^241,233,241,240,223,232,222,233,236,159,168,221,233,231^234,240,223,225,219,231,223,236,237,159,168,232,223,238^230,223,234,236,223,237,238,233,236,223,159,168,221,233,231^230,223,234,236,223,237,238,233,236,223,159,168,232,223,238","241,228,238,228,239,169,165,229,240,238,239,221,234,234,238,239^241,228,238,228,239,169,165,225,221,232,221,234,234,238,239,160,169,234,237,226^226,240,228,231,223,169,165,242,234,242,227,240,233,239,160,169,222,234,232^238,230,244,235,224,169,165,229,220,233,224,221,234,234,238,239^238,230,244,235,224,169,165,238,220,238,227,220,175,180,173,176,172^232,234,237,224,169,165,224,160,169,165,235,160,169,165,228,160,169,165,222,160,169,165,222,160,169,165,220,160,169,165,237,160,169,165,237,160,169,165,244,169,165,222,169,165,234,169,165,232^226,240,231,223,220,233,169,165,224,241,224,237,244,223,220,244,169,165,225,234,237,244,234,240,169,165,220,237,239,228,225,220,222,239,169,165,242,237,228,239,224^217,242,160,169,186,239,160,169,186,238,169,165,232,244,239,227,228,222,169,165,223,240,233,226,224,234,233,238,169,165,220,222,227,228,224,241,169,165,225,220,238,239,169,165,242,237,228,239,224^225,224,220,239,238,234,225,238,239,237,224,233,226,239,227,169,165,220,242,224,238,234,232,224,232,234,240,233,239,169,165,226,240,231,223,220,233,232,244,239,227,228,222,169,165,223,240,233,226,224,234,233,238,232,244,239,227,228,222,169,165,242,237,228,239,224,239,234,232,224^227,224,231,235,228,233,226,169,165,226,240,231,223,220,233,169,165,220,222,227,228,224,186,241,169,165,226,224,220,237,169,165,224,241,224,237,244,223,220,244,169,165,242,237,228,239,224^241,228,238,228,239,169,165,242,171,242,237,240,233,225,234,237,228,233,225,234^242,234,242,241,224,233,223,234,237,160,169,222,234,232^242,234,242,227,240,233,239,160,169,222,234,232,169,165,226,240,228,231,223^231,224,235,237,224,238,239,234,237,224,160,169,222,234,232^217,242,239,238,169,165,232,244,239,227,186,228,222,238,239,234,237,224,214,160,169,167,216,222,234,232^217,239,234,238,180,170,180,231,234,234,239,169,165,239,234,223,220,244,169,165,238,224,231,231,228,233,226,239,234,232,221,169,165,226,240,228,231,223,226,186,237,214,220,234,216,186,214,228,240,216,214,223,235,233,216,159^232,244,239,227,228,222,169,165,225,221,232,239,224,220,232,169,222,234,232^242,239,238,169,165,226,240,228,231,223,169,165,235,241,224,226,220,232,224,237,238,160,169,222,234,232^217,242,239,238,220,233,239,234,237,240,238,169,165,242,234,242,227,240,233,239,160,169,222,234,232^241,228,238,228,239,169,165,242,234,242,227,240,233,239,160,169,222,234,232^242,234,242,241,224,233,223,234,237,160,169,233,224,239^231,234,242,226,224,220,237,169,165,227,224,231,235,244,234,240,169,165,221,220,223,224,236,240,228,235,235,224,223,169,165,233,234,234,233,224,242,220,233,239,238,169,165,242,237,228,239,224,232,224^220,331,312,239,234,235,244,222,169,165,242,234,242,227,240,233,239,160,169,233,224,239^233,228,226,227,239,227,234,231,223,169,165,224,235,228,222,222,220,237,237,244,214,160,169,167,216,233,224,239^239,224,220,232,242,234,242,237,240,233,160,169,222,231,240,221^241,228,238,228,239,169,165,224,160,169,165,235,160,169,165,228,160,169,165,222,160,169,165,222,160,169,165,220,160,169,165,237,160,169,165,237,160,169,165,244,169,165,222,169,165,234,169,165,232^241,228,238,228,239,169,165,226,235,231,220,244,160,169,235,237,234^241,228,238,228,239,169,165,224,235,228,222,222,220,237,237,244^238,224,231,231,228,233,226,221,234,234,238,239,169,165,227,228,226,227,231,244,224,243,235,224,237,228,224,233,222,224,223,226,237,234,240,235,169,165,226,228,241,224,244,234,240,220,231,231,239,237,220,223,224,220,221,231,224,231,234,234,239^239,234,223,220,244,169,165,242,234,242,227,240,233,239,160,169,222,234,232^242,160,169,186,239,160,169,186,238,169,165,239,234,232,221,169,165,225,234,237,244,234,240,169,165,227,240,237,237,244,169,165,242,237,228,239,224,232,224^222,230,220,331,308,331,314,224,169,165,232,220,245,224,242,234,242^242,239,238,169,165,242,234,242,237,240,233,160,169,222,231,240,221^217,242,160,169,186,239,160,169,186,238,239,234,238,180,170,180,227,224,237,234,228,222,169,165,239,234,232,221,169,165,231,234,234,239,225,234,237,244,234,240,169,165,225,220,238,239,237,240,233,169,165,220,222,227,228,224,241,169,165,242,237,228,239,224,169,165,228,233,225,234^238,227,220,223,234,242,221,234,234,238,239,214,160,169,167,216,222,234,232^241,228,238,228,239,169,165,222,231,224,220,237,237,240,233,160,169,228,233,225,234^241,228,238,228,239,169,165,239,240,237,221,234,237,240,233,160,169,235,237,234^242,239,238,220,233,239,234,237,240,238,169,165,239,234,223,220,244,169,165,228,231,241,231,220,233,223,222,240,237,241,224,220,222,227,228,224,241,169,165,226,240,228,231,223,169,165,242,227,228,238,235^241,228,238,228,239,222,231,224,220,237,237,240,233,160,169,237,240,233^217,242,239,238,220,233,239,234,237,240,238,169,165,231,234,234,239,237,240,233,239,234,233,228,226,227,239,169,165,228,231,241,231,220,233,223,222,240,237,241,224,220,222,227,228,169,165,226,240,228,231,223,226,237,234,240,235,169,165,232,234,237,224^331,314,234,232,234,331,305,224,232,169,165,230,244,331,314,234,331,312,169,165,223,241,228,233,226,160,169,237,240^217,238,224,231,231,228,233,226,239,234,232,221,180,170,180,225,214,220,240,216,238,239,226,240,228,231,223,237,240,233,159^217,238,224,231,231,228,166,233,226,239,234,232,221,166,180,170,180,226,240,228,231,223,226,237,234,240,235,159^241,228,238,228,239,169,165,242,234,242,237,240,233,160,169,238,239,234,237,224^217,242,160,169,239,160,169,238,220,233,239,234,237,240,238,169,165,239,234,223,220,244,169,165,220,231,231,231,234,234,239,225,234,237,244,234,240,237,238,235,224,222,169,165,222,240,237,241,224,169,165,242,237,228,239,224,232,224^217,220,233,239,234,237,240,238,227,224,237,234,228,222,221,234,234,238,239,233,234,239,220,222,239,228,222,238,220,233,223,228,231,241,231,237,224,236,240,228,237,224,223,169,165,225,240,231,231,237,240,233,169,165,220,237,226,240,238,227,224,237,234,228,222,230,228,231,231,169,165,221,234,234,230,244,234,240,237,238,235,234,239,169,165,225,234,237,228,233,225,234^235,241,224,226,220,232,224,237,238,160,169,233,224,239^241,228,238,228,239,169,165,222,231,224,220,237,237,240,233,160,169,235,237,234^241,228,238,228,239,169,165,242,234,242,237,240,233,160,169,235,237,234^217,242,160,169,239,160,169,238,220,237,226,240,238,169,165,220,231,231,231,234,234,239,225,234,237,244,234,240,237,238,235,224,222,169,165,222,240,237,241,224,169,165,242,237,228,239,224,232,224^238,220,231,224,169,165,231,234,234,239,227,220,241,224,233,214,160,169,167,216,222,234,232^217,238,224,231,231,228,233,226,239,234,232,221,221,186,180,170,180,239,234,223,220,244,226,240,228,231,223,226,237,234,240,235^242,224,221,238,228,239,224,169,165,231,228,226,227,239,221,234,234,238,239,214,160,169,167,216,222,234,232^217,242,239,238,230,229,227,222,169,165,226,240,228,231,223,169,165,238,224,231,231,228,233,226,169,165,235,224,237,238,234,233,220,231,169,165,238,240,235,224,237,222,231,224,220,233,169,165,226,224,239,244,234,240,237,169,165,225,220,238,239^242,239,238,169,165,230,224,244,169,165,238,230,244,235,224,169,165,242,234,242,221,234,234,238,239,224,237,238,173^217,242,239,238,220,233,239,234,237,240,238,169,165,239,228,237,224,223,225,237,234,232,238,224,220,237,222,227,228,233,226,226,237,234,240,235,238,169,165,224,241,224,237,244,223,220,244,169,165,238,235,224,222,228,220,231^232,244,239,227,214,172,228,216,222,169,165,232,232,214,234,171,216,231,241,231,160,169,222,214,171,234,216,232^217,242,239,238,220,233,239,234,237,240,238,169,165,226,224,239,231,234,234,239,169,165,222,240,237,241,224,169,165,226,240,228,231,223,169,165,228,233,225,234^241,228,238,228,239,169,165,221,234,234,238,239,232,220,233,214,160,169,167,216,228,233,225,234^238,224,231,231,169,165,242,234,242,227,240,233,239,160,169,222,234,232^235,228,231,234,239,169,165,235,227,234,239,234,228,235,228,222,160,169,238,240^231,224,235,237,224,238,239,234,237,224,160,169,233,224,239^217,242,239,238,169,165,231,234,234,239,237,240,233,239,234,223,220,244,169,165,226,224,239,231,234,234,239,169,165,226,240,228,231,223,237,240,233,169,165,242,227,228,238,235^238,230,244,235,224,169,165,235,241,224,239,234,235^241,228,238,228,239,169,165,229,221,238,239,160,169,235,237,234^242,224,221,238,228,239,224,169,165,221,231,220,245,228,233,226,221,234,234,238,239,214,160,169,167,216,222,234,232^217,242,160,169,186,239,160,169,186,238,169,165,225,240,231,231,231,234,234,239,169,165,232,234,240,233,239,169,165,236,240,228,222,230,169,165,238,232,220,237,239,169,165,242,237,228,239,224^217,242,239,238,220,233,239,234,237,240,238,169,165,239,234,223,220,244,169,165,231,234,234,239,237,240,233,239,234,233,228,226,227,239,169,165,226,240,228,231,223,226,237,234,240,235,169,165,228,233,225,234^221,234,234,238,239,169,165,224,243,235,224,237,228,224,233,222,224,169,165,232,234,237,224,239,227,220,233,169,165,242,224,226,228,241,224,244,234,240,220,231,231,239,237,220,223,224,220,221,231,224,231,234,234,239^238,239,237,224,220,232,169,165,239,242,228,239,222,227,160,169,239,241,170,226,234,237,224,233,225,228,224,231,223^238,220,186,231,224,169,165,224,160,169,165,235,160,169,165,228,160,169,165,222,160,169,165,222,160,169,165,220,160,169,165,237,160,169,165,237,186,160,169,165,244,169,165,222,169,165,234,169,165,232^241,228,238,228,239,169,165,225,221,232,239,224,220,232,160,169,235,237,234^238,230,244,235,224,169,165,225,234,243,238,239,234,237,224^242,224,221,238,228,239,224,169,165,225,221,232,239,224,220,232,214,160,169,167,216,222,234,232^241,228,238,228,239,232,244,239,227,228,222,237,240,233,160,169,228,233,225,234^217,242,239,238,169,165,232,244,239,227,228,222,169,165,170,180,169,165,220,237,224,244,234,240,239,228,237,224,223,169,165,235,237,228,222,224,225,234,237,244,234,240,169,165,230,233,234,242,242,227,224,233,244,234,240,237^222,220,237,237,244,169,165,242,234,242,237,240,233,160,169,228,233,225,234^217,242,239,238,169,165,221,214,234,171,216,214,234,171,216,238,239,232,220,233,169,165,228,233,225,234^241,228,238,228,239,225,220,238,239,237,240,233,160,169,237,240,233^217,242,239,238,169,165,232,244,239,227,186,228,222,238,239,234,237,224,214,160,169,167,216,233,224,239^241,228,238,228,239,169,165,242,234,242,239,234,235,231,234,234,239^221,234,234,238,239,169,165,224,235,228,222,222,220,237,237,244^241,228,238,228,239,169,165,234,233,224,238,227,234,239,160,169,237,240,233^224,235,228,222,222,220,237,237,244,214,160,169,167,216,222,234,232^238,230,244,235,224,169,165,224,237,234,221,234,234,238,239^233,234,239,225,237,224,224,169,165,227,224,231,235,228,233,226,242,228,239,227,220,233,244,244,234,240,237,169,165,242,224,226,228,241,224,244,234,240,220,231,231,239,237,220,223,224,220,221,231,224,231,234,234,239^220,223,223,234,240,237,169,165,225,220,238,239,237,240,233,173,172,174,176,173^222,220,237,237,244,169,165,242,234,242,227,240,233,239,160,169,222,234,232^238,230,244,235,224,169,165,224,241,228,231,232,228,238,239,172^217,239,234,232,221,180,170,180,231,234,234,239,169,165,239,234,223,220,244,169,165,238,224,231,231,228,233,226,239,234,238,169,165,226,240,228,231,223,226,186,237,214,220,234,216,186,214,228,240,216,214,223,235,233,216,159^242,239,238,169,165,238,230,244,235,224,169,165,233,228,226,227,239,225,228,237,224,242,234,242^238,224,231,231,169,165,224,160,169,165,235,160,169,165,228,160,169,165,222,160,169,165,222,160,169,165,220,160,169,165,237,160,169,165,237,186,160,169,165,244,169,165,222,169,165,234,169,165,232^241,228,238,228,239,242,234,242,237,240,233,160,169,228,233,225,234^238,230,244,235,214,224,174,216,169,165,232,220,245,224,242,234,242^231,224,235,237,224,238,239,234,237,224,160,169,234,237,226^217,242,160,169,186,239,160,169,186,238,169,165,220,233,239,234,237,240,238,169,165,220,231,231,231,234,234,239,169,165,237,220,228,223,238,224,241,224,237,244,223,220,244,169,165,242,237,228,239,224^242,239,238,169,165,235,224,242,235,224,242,238,227,234,235,160,169,235,237,234^227,224,231,235,228,233,226,169,165,235,237,234,169,165,220,222,227,228,224,186,241,169,165,222,240,237,241,224,169,165,242,237,228,239,224^242,224,221,238,228,239,224,169,165,222,234,233,236,240,224,238,239,222,220,235,235,224,223,214,160,169,167,216,222,234,232^242,234,242,241,224,233,223,234,237,160,169,234,237,226^222,220,237,237,244,169,165,235,241,224,238,227,234,235,160,169,235,237,234^222,230,220,331,308,331,314,169,165,229,220,233,224,221,234,234,238,239^217,242,160,169,186,239,160,169,186,238,230,229,227,224,237,234,228,222,169,165,220,231,231,231,234,234,239,225,234,237,244,234,240,169,165,225,220,238,239,237,240,233,169,165,242,237,228,239,224,232,224^217,242,239,238,239,234,238,227,222,180,170,180,169,165,226,240,228,231,223,169,165,238,224,231,231,228,233,186,226,169,165,238,240,235,224,237,238,235,224,224,223,169,165,224,241,224,237,244,223,220,244,169,165,221,234,234,230,228,233,226^241,228,238,228,239,222,231,224,220,237,160,169,237,240,233,169,165,223,228,238,222,234,237,223^223,228,238,222,234,240,233,239,169,165,224,235,228,222,222,220,237,237,244^220,231,231,231,234,234,239,225,234,237,244,234,240,169,165,232,244,239,227,228,222,223,240,233,226,224,234,233,238,169,165,232,234,240,233,239,238,220,233,223,220,222,227,228,224,241,169,165,242,237,228,239,224,232,224,239,234,226,224,239,232,234,237,224,228,233,225,234^220,238,230,169,165,224,160,169,165,235,160,169,165,228,160,169,165,222,160,169,165,222,160,169,165,220,160,169,165,237,160,169,165,237,160,169,165,244,169,165,222,169,165,234,169,165,232^217,242,239,238,169,165,221,214,234,171,216,214,234,171,216,238,239,232,220,233,214,160,169,167,216,233,224,239^242,224,221,238,228,239,224,169,165,242,234,242,237,240,233,169,165,228,233,225,234^217,220,233,239,234,237,240,238,169,165,227,220,241,224,244,234,240,238,239,228,231,231,233,234,239,230,228,231,231,224,223,169,165,233,224,224,223,232,234,237,224,228,239,224,232,238,169,165,239,224,220,232,169,165,230,233,234,242,232,234,237,224^217,220,233,239,234,237,240,238,169,165,242,234,242,227,240,233,239,160,169,222,234,232^238,230,244,235,224,169,165,221,234,234,238,239,169,165,238,239,234,237,224")

local repTbl = {
	--Symbol & space removal
	["[%*%-<>%(%)\"!%?=`'_%+#%%%^&;:~{}%[%] ]"]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", ["|"]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",
	[""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="", [""]="",

	--This is the replacement table. It serves to deobfuscate words by replacing letters with their English "equivalents".
	[""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", -- First letter is Russian "\208\176". Convert > \97.
	[""]="a", [""]="a", [""]="a", [""]="a", [""]="a", [""]="a", -- Convert > \97. Note: , ,  fail with strlower, include both.
	[""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", [""]="c", --First letter is Russian "\209\129". Convert > \99. Note: , , ,  fail with strlower, include both.
	[""]="d", [""]="d", [""]="d", [""]="d", --Convert > \100. Note: ,  fail with strlower, include both.
	[""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", --First letter is Russian "\208\181". Convert > \101. 
	[""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", [""]="e", --Note: , , , , , ,  fail with strlower, include both.
	[""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", [""]="g", -- Convert > \103. Note: , , ,  fail with strlower, include both.
	[""]="h", [""]="h", -- Convert > \104. Note:  fail with strlower, include both.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", -- Convert > \105.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", --Convert > \105. -- Note: , , , ,  fail with strlower, include both.
	[""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", [""]="i", --Convert > \105. -- Note: , , ,  fail with strlower, include both.
	[""]="j", [""]="j", -- Convert > \106. -- Note:  fail with strlower, include both.
	[""]="k", [""]="k", [""]="k", -- First letter is Russian "\208\186". Convert > \107. -- Note:  fail with strlower, include both.
	[""]="l", [""]="l", [""]="l", [""]="l", [""]="l", [""]="l", -- Convert > \107. -- Note: , ,  fail with strlower, include both.
	[""]="m", [""]="m", -- First letter is capital Greek  "\206\156". Convert > \109
	[""]="n", [""]="n", [""]="n", [""]="n", -- First letter is small Greek eta  "\206\183". Convert > \110. 
	[""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", [""]="n", --Convert > \110. Note: , , ,  fail with strlower, include both.
	[""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", --First letter is Russian "\208\190". Convert > \111.
	[""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", [""]="o", --Note: , , , , ,  fail with strlower, include both.
	[""]="p", [""]="p", [""]="p", [""]="p", [""]="p", --First letter is Russian "\209\128". Convert > \112. --Note:  fail with strlower, include both.
	[""]="q", [""]="q", --Note:  fail with strlower, include both.
	[""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", [""]="r", --Convert > \114. -- Note: , ,  fail with strlower, include both.
	[""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", [""]="s", --Convert > \115. -- Note: , , , ,  fail with strlower, include both.
	[""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", [""]="t", --Convert > \116. -- Note: , , ,  fail with strlower, include both.
	[""]="u", [""]="u", [""]="u", [""]="u", --Convert > \117.
	[""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", [""]="u", --Convert > \117. -- Note: , , , ,  fail with strlower, include both.
	[""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", [""]="w", -- First letter is small Greek omega  "\207\142". Convert > \119. -- Note: , , , ,  fail with strlower, include both.
	[""]="y", [""]="y", [""]="y", [""]="y", -- First letter is Russian "\209\131". Convert > \121. -- Note:  fail with strlower, include both.
	[""]="0", [""]="1", [""]="2", [""]="3", [""]="4", [""]="5", [""]="6", [""]="7", [""]="8", [""]="9",
	[""]=".", [""]=".", [""]=",", [""]="o", [""]="r", [""]="o", [""]="t",
}

--[[ Chat Scanning ]]--
local Ambiguate, BNGetGameAccountInfoByGUID, gsub, lower, next, type, tremove = Ambiguate, BNGetGameAccountInfoByGUID, gsub, string.lower, next, type, tremove
local IsCharacterFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar = IsCharacterFriend, IsGuildMember, UnitInRaid, UnitInParty, CanComplainChat, SetCVar
local CanReportPlayer, ReportPlayer, PlayerLocation = C_ChatInfo.CanReportPlayer, C_ChatInfo.ReportPlayer, PlayerLocation
local spamCollector, backupCollector, spamLogger, prevShow, enableBubble = {}, {}, {}, 0, false
local blockedLineId, et, chatLines, chatPlayers = 0, 7, {}, {}
local btn, reportFrame
local function IsFriendly(name, flag, _, guid)
	if not guid then return true end -- LocalDefense automated prints
	if not guid:find("^Player") then -- Bad addons
		local msg = "BadBoy: Unexpected GUID requested by an addon: ".. guid
		print(msg)
		geterrorhandler()(msg)
		return true
	end
	local _, characterName = BNGetGameAccountInfoByGUID(guid)
	if characterName or IsGuildMember(guid) or IsCharacterFriend(guid) or UnitInRaid(name) or UnitInParty(name) or flag == "GM" or flag == "DEV" then
		return true
	end
end
local function Cleanse(msg)
	msg = gsub(msg, "|c[^%[]+%[([^%]]+)%]|h|r", "%1") -- Speed up processing messages with links by removing them
	msg = lower(msg) --Lower all text, remove capitals
	for k,v in next, repTbl do
		msg = gsub(msg, k, v)
	end
	return msg
end
local eventFunc = function(_, event, msg, player, _, _, _, flag, channelId, channelNum, _, _, lineId, guid)
	-- Re-enable chat bubbles if they were disabled in the previous event.
	if enableBubble then
		enableBubble = false
		SetCVar("chatBubbles", 1)
	end

	blockedLineId = 0
	if event == "CHAT_MSG_CHANNEL" and (channelId == 0 or type(channelId) ~= "number") then return end --Only scan official custom channels (gen/trade)

	local trimmedPlayer = Ambiguate(player, "none")
	if IsFriendly(trimmedPlayer, flag, nil, guid) then return end

	local debug = msg --Save original message format
	msg = Cleanse(msg)

	--20 line text buffer, this checks the current line, and blocks it if it's the same as one of the previous 20
	if event == "CHAT_MSG_CHANNEL" then
		local cleanestMsg = gsub(msg, "[@,./\\=]", "") -- Anything purposely not removed by Cleanse()
		for i=1, #chatLines do
			if chatLines[i] == cleanestMsg and chatPlayers[i] == guid then --If message same as one in previous 20 and from the same person...
				blockedLineId = lineId
				-- Reduce the chances of a spam report expiring (line id is too old) by refreshing it
				if spamCollector[guid] and S.is(msg) then
					spamCollector[guid] = PlayerLocation:CreateFromChatLineID(lineId)
					if BADBOY_OPTIONS.tipSpam then
						spamLogger[guid] = debug
					end
				elseif backupCollector[guid] and next(spamCollector) and S.is(msg) then
					backupCollector[guid] = PlayerLocation:CreateFromChatLineID(lineId)
				end
				--
				return
			end
			if i == 20 then tremove(chatLines, 1) tremove(chatPlayers, 1) end --Don't let the DB grow larger than 20
		end
		chatLines[#chatLines+1] = cleanestMsg
		chatPlayers[#chatPlayers+1] = guid
	end
	--End text buffer

	if S.is(msg) then
		if event == "CHAT_MSG_SAY" or event == "CHAT_MSG_YELL" then
			-- Awful way of disabling chat bubbles when spam is detected.
			-- Chat bubbles are processed internally by the game client AFTER all the addon event handlers are fired.
			if GetCVarBool("chatBubbles") then
				enableBubble = true
				SetCVar("chatBubbles", 0)
			end
		end
		if not BADBOY_OPTIONS.freqButton then
			for i = 1, #S[et] do
				if strfind(msg, S[et][i]) then
					blockedLineId = lineId
					return
				end
			end
		end
		if BadBoyLog then
			BadBoyLog("BadBoy", event, trimmedPlayer, debug)
		end
		if not BADBOY_BLACKLIST[guid] and not IsEncounterInProgress() then
			spamCollector[guid] = PlayerLocation:CreateFromChatLineID(lineId)
			if BADBOY_OPTIONS.tipSpam then
				spamLogger[guid] = debug
				if btn:IsShown() and reportFrame:IsMouseOver() then
					GameTooltip_Hide()
					reportFrame:GetScript("OnEnter")(reportFrame) -- Add more spam to tooltip if shown
				end
			end

			local t = GetTime()
			if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
				if prevShow == 0 then
					prevShow = t+25
					-- Delay the first one to grab more spam on really bad realms
					C_Timer.After(25, function() btn:Show() end)
				else
					prevShow = t
					btn:Show()
				end
			end
		end

		if BADBOY_BLACKLIST[guid] then
			-- We have already reported this person today. We won't show the button again, but add them to the backup table to report them
			-- again only if we click the button for other spam, to completely eliminate processing their chat, improving performance.
			backupCollector[guid] = PlayerLocation:CreateFromChatLineID(lineId)
		end

		blockedLineId = lineId
		return
	elseif next(spamCollector) then
		local t = GetTime()
		if t-prevShow > (BADBOY_OPTIONS.freqBtn and 30 or 90) then
			prevShow = t
			btn:Show()
		end
	end
end
local filterFunc = function(_, _, _, _, _, _, _, _, _, _, _, _, lineId)
	if blockedLineId == lineId then
		return true
	end
end

do
	btn = CreateFrame("Frame", nil, ChatFrame1)
	btn:SetWidth(50)
	btn:SetHeight(50)
	btn:SetPoint("BOTTOMRIGHT", 18, -20)
	btn:SetFrameStrata("DIALOG")
	local tx = btn:CreateTexture()
	tx:SetAllPoints(btn)
	tx:SetMask("Interface\\CharacterFrame\\TempPortraitAlphaMask")
	tx:SetTexture(132360) -- Interface/Icons/Ability_Warrior_ShieldMastery
	local animGroup = btn:CreateAnimationGroup()
	animGroup:SetLooping("REPEAT")
	local scale = animGroup:CreateAnimation("Scale")
	scale:SetOrder(1)
	scale:SetFromScale(0.25,0.25)
	scale:SetToScale(1,1)
	scale:SetDuration(0.4)
	local scale2 = animGroup:CreateAnimation("Scale")
	scale2:SetOrder(2)
	scale2:SetFromScale(1,1)
	scale2:SetToScale(0.25,0.25)
	scale2:SetDuration(0.4)
	scale2:SetEndDelay(8)
	animGroup:Play()
	btn:Hide()

	reportFrame = CreateFrame("Button", nil, btn)
	reportFrame:SetAllPoints(ChatFrame1)
	reportFrame:SetFrameStrata("DIALOG")
	local ticker = nil
	local tickerFunc = function()
		local canReport = false
		for k, v in next, spamCollector do
			if CanReportPlayer(v) then
				canReport = true
			else
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		end
		for k, v in next, backupCollector do
			if not CanReportPlayer(v) then
				backupCollector[k] = nil
			end
		end
		if not canReport then
			btn:Hide()
		end
	end
	btn:SetScript("OnShow", function()
		if ticker then ticker:Cancel() end
		ticker = C_Timer.NewTicker(5, tickerFunc)
		tickerFunc()
		-- Don't animate if the feature is disabled
		if animGroup:IsPlaying() and BADBOY_OPTIONS.noAnim then
			btn:SetWidth(12)
			btn:SetHeight(12)
			animGroup:Stop()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 0, -5)
		elseif not animGroup:IsPlaying() and not BADBOY_OPTIONS.noAnim then
			btn:SetWidth(46)
			btn:SetHeight(46)
			animGroup:Play()
			btn:ClearAllPoints()
			btn:SetPoint("BOTTOMRIGHT", 18, -20)
		end
	end)
	btn:SetScript("OnHide", function()
		if ticker then
			ticker:Cancel()
			ticker = nil
		end
	end)
	reportFrame:SetScript("OnClick", function(self, btn)
		if IsAltKeyDown() then -- Dismiss
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()
			for k in next, spamCollector do
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
		else -- Report
			prevShow = GetTime() -- Refresh throttle so we don't risk showing again straight after reporting
			self:GetParent():Hide()

			local systemMsg = {GetFramesRegisteredForEvent("CHAT_MSG_SYSTEM")} -- Don't show the "Complaint Registered" message
			local infoMsg = {GetFramesRegisteredForEvent("UI_INFO_MESSAGE")} -- Don't show the "Thanks for the report" message
			local calendarError = {GetFramesRegisteredForEvent("CALENDAR_UPDATE_ERROR")} -- Remove calendar error popup (Blizz bug)
			for i = 1, #systemMsg do
				systemMsg[i]:UnregisterEvent("CHAT_MSG_SYSTEM")
			end
			for i = 1, #infoMsg do
				infoMsg[i]:UnregisterEvent("UI_INFO_MESSAGE")
			end
			for i = 1, #calendarError do
				calendarError[i]:UnregisterEvent("CALENDAR_UPDATE_ERROR")
			end

			for k, v in next, spamCollector do
				if CanReportPlayer(v) then
					BADBOY_BLACKLIST[k] = true
					ReportPlayer("spam", v, "Reported by the BadBoy addon. If this seems wrong, tell the author @funkbw on twitter.")
				end
				spamCollector[k] = nil
				spamLogger[k] = nil
			end
			for k, v in next, backupCollector do
				if CanReportPlayer(v) then
					ReportPlayer("spam", v, "Reported by the BadBoy addon. If this seems wrong, tell the author @funkbw on twitter.")
				end
				backupCollector[k] = nil
			end

			for i = 1, #systemMsg do
				systemMsg[i]:RegisterEvent("CHAT_MSG_SYSTEM")
			end
			for i = 1, #infoMsg do
				infoMsg[i]:RegisterEvent("UI_INFO_MESSAGE")
			end
			for i = 1, #calendarError do
				-- There's a delay before the event fires
				C_Timer.After(5, function() calendarError[i]:RegisterEvent("CALENDAR_UPDATE_ERROR") end)
			end
		end
	end)
	reportFrame:SetScript("OnEnter", function(self)
		GameTooltip:SetOwner(self, "ANCHOR_CURSOR")
		GameTooltip:AddLine(S.spamBlocked, 1, 1, 1)
		GameTooltip:AddLine(S.clickToReport, 1, 1, 1)
		if next(spamLogger) then
			GameTooltip:AddLine(" ", 0.5, 0.5, 1)
			for k, v in next, spamLogger do
				GameTooltip:AddLine(v, 0.2, 1, 0)
			end
		end
		GameTooltip:Show()
	end)
	reportFrame:SetScript("OnLeave", GameTooltip_Hide)
end

--[[ Add Filters ]]--
do
	local f = CreateFrame("Frame")
	f:SetScript("OnEvent", eventFunc)
	local tbl = {
		"CHAT_MSG_CHANNEL",
		"CHAT_MSG_YELL",
		"CHAT_MSG_SAY",
		"CHAT_MSG_WHISPER",
		"CHAT_MSG_EMOTE",
		"CHAT_MSG_DND",
		"CHAT_MSG_AFK",
	}
	for i = 1, #tbl do
		local event = tbl[i]
		local frames = {GetFramesRegisteredForEvent(event)}
		f:RegisterEvent(event)
		ChatFrame_AddMessageEventFilter(event, filterFunc)
		for i = 1, #frames do
			local frame = frames[i]
			frame:UnregisterEvent(event)
			frame:RegisterEvent(event)
		end
	end
end

--[[ LFG Filter ]]--
do
	local GetSearchResults, GetSearchResultInfo = C_LFGList.GetSearchResults, C_LFGList.GetSearchResultInfo
	local GetApplications, ReportSearchResult = C_LFGList.GetApplications, C_LFGList.ReportSearchResult
	local f = CreateFrame("Frame", nil, PVEFrame)
	f:SetPoint("BOTTOMLEFT", PVEFrame, "BOTTOMLEFT", 10, 10)
	f:SetFrameStrata("DIALOG")
	f:SetSize(200, 20)
	f:Hide()
	local t = f:CreateTexture()
	t:SetAllPoints(f)
	t:SetColorTexture(0, 0.3, 1)
	local txt = f:CreateFontString(nil, nil, "GameFontNormal")
	txt:SetPoint("LEFT", f, "LEFT", 5, 0)
	txt:SetJustifyH("LEFT")
	txt:SetText(S.clickToFilterLFG)
	f:SetWidth(txt:GetStringWidth()+10)
	local group = f:CreateAnimationGroup()
	group:SetScript("OnFinished", function(anim) anim:GetParent():Hide() end)
	f:SetScript("OnShow", function() group:Play() end)
	local fade = group:CreateAnimation("Alpha")
	fade:SetStartDelay(1)
	fade:SetDuration(1.5)
	fade:SetFromAlpha(1)
	fade:SetToAlpha(0)
	fade:SetOrder(1)
	f:RegisterEvent("LFG_LIST_SEARCH_RESULTS_RECEIVED")
	f:RegisterEvent("LFG_LIST_SEARCH_FAILED")
	local filter = function(self, ev)
		self:Hide() -- Always hide the notification, we only want it showing when spam is found.
		local _, results = GetSearchResults()
		local toRem, toRep, t = {}, {}, et+1
		for i = #results, 1, -1 do
			local id, _, name, comment, voiceChat = GetSearchResultInfo(results[i])
			local msg = name .. comment .. voiceChat -- They like to split messages
			msg = Cleanse(msg)
			local s = ev ~= "LFG_LIST_SEARCH_RESULTS_RECEIVED"
			if not s and not BADBOY_OPTIONS.freqButton then
				for i = 1, #S[et] do
					if strfind(msg, S[et][i]) then
						s = true
						break
					end
				end
			end
			if S.is(msg) then
				toRem[#toRem+1] = i
				if not s then
					toRep[id] = true
				end
			else
				for j=1, #S[t] do
					if strfind(msg, S[t][j]) then
						toRem[#toRem+1] = i
						if not s then
							toRep[id] = true
						end
						break
					end
				end
			end
		end
		if toRem[1] then -- Spam entry found, customize the list.
			for i = 1, #toRem do
				table.remove(results, toRem[i])
			end
			LFGListUtil_SortSearchResults(results) -- Some LFG filter addons hook this function to do custom sorting, let's cooperate by using it so they customize our list.
			LFGListFrame.SearchPanel.results = results -- Attach results table to frame
			LFGListFrame.SearchPanel.totalResults = #results -- Attach result counter to frame
			LFGListFrame.SearchPanel.applications = GetApplications() -- Attach applications to frame
			LFGListSearchPanel_UpdateResults(LFGListFrame.SearchPanel) -- Finally, feed frame holding the results to the panel

			local systemMsg = {GetFramesRegisteredForEvent("CHAT_MSG_SYSTEM")} -- Don't show the "Complaint Registered" message
			local infoMsg = {GetFramesRegisteredForEvent("UI_INFO_MESSAGE")} -- Don't show the "Thanks for the report" message
			for i = 1, #systemMsg do
				systemMsg[i]:UnregisterEvent("CHAT_MSG_SYSTEM")
			end
			for i = 1, #infoMsg do
				infoMsg[i]:UnregisterEvent("UI_INFO_MESSAGE")
			end

			for k in next, toRep do
				ReportSearchResult(k, "lfglistspam", "Reported by the BadBoy addon. If this seems wrong, tell the author @funkbw on twitter.") -- Report spam groups
			end

			for i = 1, #systemMsg do
				systemMsg[i]:RegisterEvent("CHAT_MSG_SYSTEM")
			end
			for i = 1, #infoMsg do
				infoMsg[i]:RegisterEvent("UI_INFO_MESSAGE")
			end

			if PVEFrame:IsShown() then
				self:Show()
			end
		end
	end
	LFGListFrame.SearchPanel:HookScript("OnShow", function()
		filter(f)
	end)
	f:SetScript("OnEvent", filter)
end

--[[ Blacklist ]]--
do
	local f = CreateFrame("Frame")
	f:RegisterEvent("ADDON_LOADED")
	f:RegisterEvent("PLAYER_LOGIN")
	f:SetScript("OnEvent", function(frame, event, addon)
		if addon == "BadBoy" then
			if type(BADBOY_OPTIONS) ~= "table" then BADBOY_OPTIONS = {} end
			if type(BADBOY_BLACKLIST) ~= "table" then BADBOY_BLACKLIST = {} end
			frame:UnregisterEvent(event)
		elseif event == "PLAYER_LOGIN" then
			-- Blacklist DB setup, needed since Blizz nerfed ReportPlayer so hard the block sometimes only lasts a few minutes.
			local dateTbl = C_Calendar.GetDate()
			local day = dateTbl.monthDay
			if BADBOY_BLACKLIST.dayFromCal ~= day then
				BADBOY_BLACKLIST = {dayFromCal = day} -- Can't use ADDON_LOADED as CalendarGetDate isn't always ready on very first login.
			end
			SetCVar("spamFilter", 1)
			frame:UnregisterEvent(event)
			BADBOY_OPTIONS.tmp = nil
			BADBOY_OPTIONS.tmpm = nil
			BADBOY_OPTIONS.tmpl = nil
			BADBOY_OPTIONS.freqButton = nil
			C_Timer.After(10, function()
				if PremadeFilter_Frame then
					print("|cFF33FF99BadBoy|r: You are using a badly coded addon (|cFF33FF99Premade Filter|r) that conflicts with BadBoy LFG filtering, we recommend you switch to using '|cFF33FF99Premade Groups Filter|r' instead.")
				end
			end)

			-- Chat bubble restore
			frame:SetScript("OnEvent", function()
				if enableBubble then
					enableBubble = false
					SetCVar("chatBubbles", 1)
				end
			end)
			-- Hopefully we never end up in a situation where we've permanently disabled chat bubbles for the user.
			frame:RegisterEvent("PLAYER_LOGOUT")
			frame:RegisterEvent("CHAT_MSG_MONSTER_SAY")
			frame:RegisterEvent("CHAT_MSG_MONSTER_YELL")
		end
	end)
end

_G.BadBoyIsFriendly = IsFriendly
_G.BadBoyCleanse = Cleanse
